(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     90758,       1879]
NotebookOptionsPosition[     90479,       1865]
NotebookOutlinePosition[     90856,       1881]
CellTagsIndexPosition[     90813,       1878]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Assumptions", ":", "\[IndentingNewLine]", " ", 
    RowBox[{
    "shells", " ", "are", " ", "located", " ", "around", " ", "the", " ", 
     "origin", "\[IndentingNewLine]", "light", " ", "rays", " ", "never", " ",
      "bend", " ", "more", " ", "than", " ", "90", " ", "degrees"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "local", " ", "gravity", " ", "as", " ", "a", " ", "function", " ", "of", 
    " ", "r"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gravity", "[", "r_", "]"}], ":=", 
    RowBox[{"G", "*", 
     RowBox[{"MPluto", "/", 
      SuperscriptBox["r", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "pressure", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
    "height"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pressure", "[", 
     RowBox[{"p0_", ",", "M_", ",", "h_", ",", "T_"}], "]"}], ":=", 
    RowBox[{"p0", " ", 
     SuperscriptBox["E", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "M"}], " ", 
         RowBox[{"Gravity", "[", 
          RowBox[{"h", "+", "rSurf"}], "]"}], " ", "h"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"k", " ", "T"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Lorentz", "-", 
     RowBox[{
     "Lorenz", " ", "Equation", " ", "for", " ", "n", " ", "values", " ", 
      "close", " ", "to", " ", "1"}]}], ":", " ", 
    RowBox[{
    "returns", " ", "a", " ", "refractive", " ", "index", " ", "n", " ", 
     "given", " ", "a", " ", "temperature", " ", "and", " ", "pressure"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LorentzLorenz", "[", 
     RowBox[{"\[Alpha]_", ",", "p_", ",", "T_"}], "]"}], ":=", 
    RowBox[{"\[Sqrt]", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "\[Pi]", " ", "NAvagadro", " ", "\[Alpha]", " ", "p"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"R", " ", "T"}], ")"}]}]}], ")"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"shells", " ", "are", " ", "composed", " ", "of", " ", "the", " ", 
     RowBox[{"following", ":", " ", 
      RowBox[{"the", " ", "circle", " ", "graphic"}]}]}], ",", " ", 
    RowBox[{"the", " ", "circle", " ", "equation"}], ",", " ", 
    RowBox[{"the", " ", "circle", " ", "radius"}], ",", " ", 
    RowBox[{"the", " ", "n", " ", "value"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "more", " ", "will", " ", "be", " ", "added", " ", "to", " ", "shells", 
    " ", "as", " ", "we", " ", "get", " ", "into", " ", "physical", " ", 
    "properties"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Shell", "[", 
     RowBox[{"r_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "r"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], "==", 
       SuperscriptBox["r", "2"]}], ",", "r", ",", "n"}], "}"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{
     RowBox[{
     "calculate", " ", "the", " ", "normal", " ", "angle", " ", "of", " ", 
      "a", " ", "shell", " ", "based", " ", "on", " ", "location"}], ",", " ", 
     RowBox[{
     "assuming", " ", "shells", " ", "centered", " ", "at", " ", "0"}], ",", 
     "0"}], ")"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalAngle", "[", "point_", "]"}], ":=", 
    RowBox[{"ArcTan", "[", 
     RowBox[{
      RowBox[{"point", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"point", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "refraction", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
    "angles", " ", "and", " ", "rafractivity", " ", "indicies"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SnellsLaw", "[", 
     RowBox[{"\[Theta]in_", ",", "nin_", ",", "nout_"}], "]"}], ":=", 
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]in", "]"}], 
      RowBox[{"nin", "/", "nout"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "make", " ", "an", " ", "atmosphere", " ", "with", " ", "linearly"}], 
     "-", 
     RowBox[{
     "spaced", " ", "shells", " ", "specified", " ", "by", " ", "minimum"}]}],
     ",", " ", "maximum", ",", " ", 
    RowBox[{"and", " ", "step", " ", "size", " ", "of", " ", "radius"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphere", "[", 
    RowBox[{"min_", ",", "max_", ",", "step_", ",", "nTable_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "r", ",", "center", ",", "nMax", ",", "nStep", ",", "n", ",", "i"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"atmosphere", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"TODO", " ", "-", " ", 
          RowBox[{"this", " ", "which", " ", "statement", " ", 
           RowBox[{"doesn", "'"}], "t", " ", "quite", " ", "seem", " ", "to", 
           " ", "work", " ", "when", " ", "both", " ", "conditions", " ", 
           "are", " ", "in"}]}], "..."}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"if", " ", "nTable", " ", "is", " ", "null"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"use", " ", "a", " ", "linearly"}], "-", 
           RowBox[{"varying", " ", "n", " ", "with", " ", "nMax"}]}], " ", 
          "\[Equal]", " ", "1.01"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"nTable", "\[Equal]", "Null"}], ")"}], " ", "||", " ", 
          RowBox[{"(", 
           RowBox[{"NumberQ", "[", "nTable", "]"}], ")"}]}], ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<not given a table of n values\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nTable", "\[Equal]", "Null"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nMax", " ", "=", " ", "1.01"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "if", " ", "nTable", " ", "is", " ", "an", " ", "integer"}], ",", 
            " ", 
            RowBox[{
             RowBox[{
              RowBox[{"use", " ", "a", " ", "linearly"}], "-", 
              RowBox[{"varying", " ", "n", " ", "with", " ", "nMax"}]}], " ", 
             "\[Equal]", " ", "nTable"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumberQ", "[", "nTable", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nMax", " ", "=", " ", "nTable"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"nStep", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nMax", "-", "1."}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"max", "-", "min"}], ")"}], "/", "step"}], ")"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"n", " ", "=", " ", "nMax"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"atmosphere", " ", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"atmosphere", ",", 
                 RowBox[{"Shell", "[", 
                  RowBox[{"r", ",", "n"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "-=", "nStep"}], ";"}], "\[IndentingNewLine]", 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"r", ",", "min", ",", "max", ",", "step"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"we", "'"}], "re", " ", "actually", " ", "given", " ", "a", 
          " ", "table", " ", "of", " ", "n", " ", "values"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<given a table of n values\>\"", "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"i", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"n", "=", 
                RowBox[{"nTable", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"atmosphere", " ", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"atmosphere", ",", 
                  RowBox[{"Shell", "[", 
                   RowBox[{"r", ",", "n"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"i", "+=", "1"}], ";"}], "\[IndentingNewLine]", "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"r", ",", "min", ",", "max", ",", "step"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "the", " ", "graphics", " ", "objects"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAtmosphereGraphic", "[", "atm_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.5", "]"}], ",", 
         RowBox[{"atmosphere", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeIntersectionsPointsGraphic", "[", "intersections_", "]"}], ":=", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Red", ",", 
       RowBox[{"Point", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "/.", 
             RowBox[{"intersections", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"y", "/.", 
             RowBox[{"intersections", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "intersections", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindNextShellIntersection", "[", 
    RowBox[{"radius_", ",", "rayPosition_", ",", "rayAngle_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "y0", ",", "m", ",", "t1", ",", "t2", ",", "tList"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x0", " ", "=", " ", 
       RowBox[{"rayPosition", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y0", " ", "=", " ", 
       RowBox[{"rayPosition", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Tan", "[", "rayAngle", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "-", 
          RowBox[{"m", " ", "y0"}], " ", "+", " ", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["radius", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["m", "2"]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y0", "-", 
                RowBox[{"m", " ", "x0"}]}], ")"}], "2"]}], ")"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["m", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "-", 
          RowBox[{"m", " ", "y0"}], " ", "-", " ", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["radius", "2"], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["m", "2"]}], ")"}]}], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y0", "-", 
                RowBox[{"m", " ", "x0"}]}], ")"}], "2"]}], ")"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["m", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "return", " ", "only", " ", "real", " ", "positive", " ", "time", " ", 
        "values"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t1", ",", "t2"}], "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "\[Element]", "Reals"}], "&&", 
            RowBox[{"#", ">", "TOL"}]}], ")"}], "&"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "that", " ", "identifies", " ", "where", " ", "the", " ", 
    "light", " ", "currently", " ", "is", " ", "in", " ", "relation", " ", 
    "to", " ", "shells"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocateLightRay", "[", 
    RowBox[{"position_", ",", "atm_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shellRadii", ",", "posRadius"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"shellRadii", " ", "=", " ", 
         RowBox[{"atm", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"posRadius", " ", "=", " ", 
         RowBox[{"Norm", "[", "position", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"entirely", " ", "outside", " ", "of", " ", "shells"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"posRadius", " ", ">", " ", 
           RowBox[{"Last", "[", "shellRadii", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"rayLocation", " ", "=", " ", "\"\<outside\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "entirely", " ", "inside", " ", "the", " ", "inner", " ", 
            "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"posRadius", " ", "<", " ", 
           RowBox[{"First", "[", "shellRadii", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"rayLocation", " ", "=", " ", "\"\<inside\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"on", " ", "outer", " ", "shell"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"Last", "[", "shellRadii", "]"}], "-", " ", 
             "posRadius"}], "]"}], "<", "TOL"}], ",", "\[IndentingNewLine]", 
          RowBox[{"rayLocation", " ", "=", " ", "\"\<on outer shell\>\""}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"difference", " ", "=", " ", 
               RowBox[{"Abs", "[", 
                RowBox[{"posRadius", "-", 
                 RowBox[{"shellRadii", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"difference", "<", "TOL"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"shellNum", " ", "=", " ", "i"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"rayLocation", "=", "\"\<on\>\""}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"rayLocation", " ", "=", " ", "\"\<between\>\""}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ";", 
      "\[IndentingNewLine]", "rayLocation"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "updates", " ", "the", " ", "light", " ", "position", " ", "based", " ", 
     "on", " ", "current", " ", "position"}], ",", " ", "direction", ",", " ", 
    RowBox[{"and", " ", "shells"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoveLightRay", "[", 
    RowBox[{"rayPath_", ",", "rayAngle_", ",", "atm_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "location", ",", "tList", ",", "intersect", ",", "t", ",", "n2", ",", 
       "position", ",", "posRadius"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extincted", " ", "=", " ", "False"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"position", " ", "=", " ", 
       RowBox[{"Last", "[", "rayPath", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posRadius", " ", "=", " ", 
       RowBox[{"Norm", "[", "position", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"location", "  ", "=", " ", 
       RowBox[{"LocateLightRay", "[", 
        RowBox[{"position", ",", "atm"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
         "outermost", " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<outside\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", " ", "=", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"FindNextShellIntersection", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "atm", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "position", ",", 
              "rayAngle"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
          "innermost", " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<inside\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", " ", "=", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"FindNextShellIntersection", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "atm", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "position", ",", 
              "rayAngle"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
           "second"}], "-", 
          RowBox[{
          "outermost", " ", "and", " ", "itself", " ", "shell", " ", "unless",
            " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", "one"}], "-", 
          RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<on outer shell\>\""}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "atm", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", 
              RowBox[{"it", "'"}], "s", " ", "a", " ", "multi"}], "-", 
             RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"t", " ", "=", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"FindNextShellIntersection", "[", 
                  RowBox[{
                   RowBox[{"atm", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "3"}], "]"}], "]"}], ",", 
                   "position", ",", "rayAngle"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"FindNextShellIntersection", "[", 
                  RowBox[{
                   RowBox[{"atm", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], ",", 
                   "position", ",", "rayAngle"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
             ";"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"else", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "a", " ", "single"}], "-", 
             RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"t", " ", "=", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"FindNextShellIntersection", "[", 
                RowBox[{
                 RowBox[{"atm", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "position", 
                 ",", "rayAngle"}], "]"}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "need", " ", "to", " ", "check", " ", "the", " ", "previous"}], ",",
           " ", "current", ",", " ", 
          RowBox[{"and", " ", "next", " ", "shells"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<on\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"posRadius", "-", 
                  RowBox[{
                   RowBox[{"atm", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<", "TOL"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"shellNum", " ", "=", " ", "i"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}], ","}], 
              "\[IndentingNewLine]", "]"}], ";"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"shellNum", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"if", " ", "on", " ", "inner", " ", "shell"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extincted", " ", "=", " ", "True"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"t", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"Join", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"FindNextShellIntersection", "[", 
                  RowBox[{
                   RowBox[{"atm", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"shellNum", "+", "1"}], ",", "3"}], "]"}], "]"}], 
                   ",", "position", ",", "rayAngle"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"FindNextShellIntersection", "[", 
                  RowBox[{
                   RowBox[{"atm", "[", 
                    RowBox[{"[", 
                    RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], ",", 
                   "position", ",", "rayAngle"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], 
              "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "if", " ", "on", " ", "some", " ", "other", " ", "shell"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"shellNum", "+", "1"}], ",", "3"}], "]"}], "]"}], 
                  ",", "position", ",", "rayAngle"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], ",", 
                  "position", ",", "rayAngle"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"shellNum", "-", "1"}], ",", "3"}], "]"}], "]"}], 
                  ",", "position", ",", "rayAngle"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}],
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "}"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "need", " ", "to", " ", "check", " ", "the", " ", "shells", " ", 
           "that", " ", "it", " ", "is", " ", "between"}], "-", " ", 
          RowBox[{
          "now", " ", "use", " ", "currentShell", " ", "as", " ", "a", " ", 
           "counter"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<between\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<warning: between atmosphere layers - this shouldn't really \
happen\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"shellNum", " ", "=", 
           RowBox[{"Length", "[", "atm", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"atm", "[", 
              RowBox[{"[", 
               RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], " ", ">", " ", 
             "posRadius"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"shellNum", "-=", "1"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tList", " ", "=", " ", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], ",", 
               "position", ",", "rayAngle"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"shellNum", "+", "1"}], ",", "3"}], "]"}], "]"}], 
               ",", "position", ",", "rayAngle"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"t", "=", " ", 
           RowBox[{"Min", "[", "tList", "]"}]}], ";"}], "\[IndentingNewLine]",
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "stuff", " ", "to", " ", "be", " ", "done", " ", "regardless", " ", 
        "of", " ", "ray", " ", "location", " ", "case"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"non", "-", 
        RowBox[{"intersection", " ", "case"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "\[Equal]", "Infinity"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<t = infinity, location = \>\"", " ", "<>", " ", "location"}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", " ", "0.25"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "just", " ", "set", " ", "t", " ", "to", " ", "some", " ", "small", 
          " ", "value", " ", 
          RowBox[{"(", 
           RowBox[{
           "probably", " ", "adjust", " ", "to", " ", "fit", " ", "window", 
            " ", "size", " ", "later"}], " "}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"intersect", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "+", 
          RowBox[{"position", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Tan", "[", "rayAngle", " ", "]"}], " ", "t"}], " ", "+", 
          " ", 
          RowBox[{"position", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"position", " ", "=", " ", "intersect"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"figure", " ", "out", " ", "which", " ", 
        RowBox[{"we", "'"}], "re", " ", "now", " ", "interacting", " ", 
        "with"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"Norm", "[", "position", "]"}], "-", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<", "TOL"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "get", " ", "the", " ", "refractivity", " ", "of", " ", "the", 
             " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n2", " ", "=", " ", 
             RowBox[{"atm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", 
              RowBox[{"we", "'"}], "re", " ", "not", " ", "interacting", " ", 
              "with", " ", "a", " ", "shell"}], ",", " ", 
             RowBox[{
              RowBox[{"then", " ", 
               RowBox[{"we", "'"}], "re", " ", "back", " ", "in", " ", 
               "vacuum", " ", "with", " ", "n2"}], " ", "=", " ", "1.0"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"n2", " ", "=", " ", "1.0"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "extincted"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"intersectionPoints", ",", "position"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"angleList", ",", 
           RowBox[{"Refract", "[", 
            RowBox[{"intersectionPoints", ",", "angleList", ",", "n2"}], 
            "]"}]}], "]"}], ";", " ", "\[IndentingNewLine]", "position"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "refract", " ", "based", " ", "on", " ", "entry", " ", "and", " ", "shell",
     " ", "conditions", " ", "using", " ", 
    RowBox[{"Snell", "'"}], "s", " ", "Law"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Refract", "[", 
     RowBox[{"rayPath_", ",", "angles_", ",", "n2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newAngle", ",", "position", ",", "prevPosition", ",", "\[Theta]1", 
        ",", "angle"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"position", " ", "=", " ", 
        RowBox[{"Last", "[", "rayPath", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prevPosition", " ", "=", " ", 
        RowBox[{"rayPath", "[", 
         RowBox[{"[", 
          RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"angle", " ", "=", " ", 
        RowBox[{"Last", "[", "angles", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "just", " ", "grazed", " ", "the", " ", "top", " ", "or", " ", 
           "bottom", " ", "of", " ", "a", " ", "shell", " ", 
           RowBox[{"(", 
            RowBox[{"no", " ", "interaction"}], ")"}]}], ",", " ", 
          RowBox[{
          "keep", " ", "the", " ", "angle", " ", "the", " ", "same"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"position", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", "TOL"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"newAngle", " ", "=", " ", "angle"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<grazed shell with angle = \>\"", " ", "<>", " ", 
             RowBox[{"ToString", "[", "angle", "]"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "hitting", " ", "shell", " ", "from", " ", "outside", " ", "in", 
           " ", 
           RowBox[{"(", 
            RowBox[{"radius", " ", "decreasing"}], ")"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Norm", "[", "position", "]"}], "<", 
          RowBox[{"Norm", "[", "prevPosition", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<outside in\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"position", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"above", " ", "the", " ", "y"}], " ", "=", " ", 
               RowBox[{"0", " ", "line"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", " ", "=", " ", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"\[Pi]", "-", 
                  RowBox[{"NormalAngle", "[", "position", "]"}], "+", 
                  "angle"}], ",", 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newAngle", " ", "=", " ", 
               RowBox[{
                RowBox[{"NormalAngle", "[", "position", "]"}], "-", "\[Pi]", 
                "+", 
                RowBox[{"SnellsLaw", "[", 
                 RowBox[{"\[Theta]1", ",", "currentN", ",", "n2"}], "]"}]}]}],
               ";"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"on", " ", "or", " ", "below", " ", "the", " ", "y"}], 
               " ", "=", " ", 
               RowBox[{"0", " ", "line"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NormalAngle", "[", "position", "]"}], "-", "\[Pi]",
                   "-", "angle"}], ",", 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newAngle", " ", "=", " ", 
               RowBox[{
                RowBox[{"NormalAngle", "[", "position", "]"}], "-", "\[Pi]", 
                "-", 
                RowBox[{"SnellsLaw", "[", 
                 RowBox[{"\[Theta]1", ",", "currentN", ",", "n2"}], "]"}]}]}],
               ";"}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
           "]"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "hitting", " ", "shell", " ", "from", " ", "inside", " ", "out"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Norm", "[", "position", "]"}], ">", 
            RowBox[{"Norm", "[", "prevPosition", "]"}]}], ")"}], " ", "||", 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Norm", "[", "position", "]"}], "\[Equal]", " ", 
            RowBox[{"Norm", "[", "prevPosition", "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", " ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<inside out\>\"", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"position", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"above", " ", "the", " ", "y"}], " ", "=", " ", 
               RowBox[{"zero", " ", "line"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NormalAngle", "[", "position", "]"}], "-", 
                  "angle"}], ",", 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newAngle", " ", "=", " ", 
               RowBox[{
                RowBox[{"NormalAngle", "[", "position", "]"}], "-", 
                RowBox[{"SnellsLaw", "[", 
                 RowBox[{"\[Theta]1", ",", "currentN", ",", "n2"}], "]"}]}]}],
               ";"}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", " ", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"on", " ", "or", " ", "below", " ", "the", " ", "y"}], 
               " ", "=", " ", 
               RowBox[{"0", " ", "line"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", "=", 
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"angle", "-", 
                  RowBox[{"NormalAngle", "[", "position", "]"}]}], ",", 
                 RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newAngle", " ", "=", " ", 
               RowBox[{
                RowBox[{"NormalAngle", "[", "position", "]"}], "+", 
                RowBox[{"SnellsLaw", "[", 
                 RowBox[{"\[Theta]1", ",", "currentN", ",", "n2"}], "]"}]}]}],
               ";"}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
           "]"}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"currentN", "=", "n2"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"newAngle", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"newAngle", ",", 
          RowBox[{"2", "*", "\[Pi]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"TODO", " ", "-", " ", 
          RowBox[{
          "probably", " ", "more", " ", "elegent", " ", "way", " ", "to", " ",
            "do", " ", "the", " ", "angle", " ", "formatting"}]}], ",", " ", 
         RowBox[{
         "because", " ", "I", " ", "basically", " ", "want", " ", "all", " ", 
          "angles", " ", "to", " ", "be", " ", "near", " ", "zero", " ", 
          "for", " ", "readability"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"newAngle", ">", " ", 
          RowBox[{"3", "*", 
           RowBox[{"\[Pi]", "/", "4"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newAngle", " ", "=", " ", 
           RowBox[{"newAngle", "-", 
            RowBox[{"2", "*", "\[Pi]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "newAngle"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"run", " ", "the", " ", "program", " ", "starting", " ", "here"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"declare", " ", "variables"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TOL", " ", "=", " ", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plutoRadius", " ", "=", " ", "9000"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"physical", " ", "constants"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NAvagadro", "=", 
   RowBox[{"6.022", "*", 
    SuperscriptBox["10", "23"]}]}], ";", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Avagadro", "'"}], "s", " ", "number"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"R", "=", "8.3145"}], ";", " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"J", "/", "mol"}], " ", "K"}], ";", " ", 
    RowBox[{"universal", " ", "gas", " ", "constant"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"k", " ", "=", " ", "1.3806488"}], " ", ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox["m", "2"], 
     SuperscriptBox["kgs", 
      RowBox[{"-", "2"}]], 
     SuperscriptBox["K", 
      RowBox[{"-", "1"}]]}], ";", " ", 
    RowBox[{"Boltzmann", " ", "constant"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"G", " ", "=", " ", 
   RowBox[{"6.67", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "11"}]]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "universal", " ", "gravitational", " ", "constant", " ", "in", " ", "mks", 
    " ", "units"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"\[Alpha]N2", "=", 
   RowBox[{"1.71", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "30"}]]}]}], ";", "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    SuperscriptBox["m", "3"], ",", " ", 
    RowBox[{"mean", " ", "polarizability", " ", "of", " ", 
     SubscriptBox["N", "2"], " ", "gas"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[Mu]N2", "=", "0.028"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"kg", ";", " ", 
    RowBox[{"molar", " ", "mass", " ", "of", " ", 
     SubscriptBox["N", "2"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"assumed", " ", "properties", " ", "of", " ", "Pluto"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"p0", " ", "=", " ", "0.3"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"N", "/", 
     SuperscriptBox["m", "2"]}], ";", " ", 
    RowBox[{
    "assumed", " ", "surface", " ", "pressure", " ", "of", " ", "Pluto"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"T", " ", "=", " ", "50."}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"K", ";", " ", 
    RowBox[{
    "assumed", " ", "atmospheric", " ", "temperature", " ", "for", " ", 
     "isothermal", " ", "model"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MPluto", " ", "=", " ", 
   RowBox[{"1.29", "*", 
    SuperscriptBox["10", "22"]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"kg", ";", " ", 
    RowBox[{"mass", " ", "of", " ", "Pluto"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"rSurf", " ", "=", " ", "11950000."}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"m", ";", " ", 
    RowBox[{"surface", " ", "radius", " ", "of", " ", "Pluto"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "the", " ", "atmosphere"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"atmMin", " ", "=", " ", "1000."}], ";", "\[IndentingNewLine]", 
    RowBox[{"atmMax", " ", "=", " ", "100000."}], ";", "\[IndentingNewLine]", 
    RowBox[{"atmStep", " ", "=", " ", "1000."}], ";"}], "\[IndentingNewLine]",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"atmMin", " ", "=", " ", "10000."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"atmMax", " ", "=", " ", "100000."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"atmStep", " ", "=", " ", "1000."}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", 
    RowBox[{
    "should", " ", "probably", " ", "put", " ", "in", " ", "a", " ", "check", 
     " ", "somewhere", " ", "here", " ", "to", " ", "make", " ", "sure", " ", 
     "that", " ", "the", " ", "division", " ", "is", " ", "integer"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "TODO", " ", "putting", " ", "in", " ", "a", " ", "dummy", " ", "\[Alpha]",
     " ", "value", " ", "for", " ", "now", " ", "to", " ", "produce", " ", 
    "results", " ", "we", " ", "can", " ", "see"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nTable", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"LorentzLorenz", "[", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "23"}]], ",", 
       RowBox[{"Pressure", "[", 
        RowBox[{"p0", ",", 
         RowBox[{"\[Mu]N2", "*", "10"}], ",", "h", ",", "T"}], "]"}], ",", 
       "T"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "atmMin", ",", "atmMax", ",", "atmStep"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphere", "[", 
    RowBox[{"atmMin", ",", "atmMax", ",", "atmStep", ",", "Null"}], "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", 
    RowBox[{
    "using", " ", "a", " ", "linear", " ", "thing", " ", "for", " ", 
     "now"}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "lists", " ", "to", " ", "store", " ", "starting", " ", "y", " ", 
    "coordinates", " ", "and", " ", "refraction", " ", "angles"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"startingY", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalRefraction", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yVsRefraction", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Theta]Overdy", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"atmGraphics", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numIntersectionPoints", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"temp", " ", "=", " ", 
      RowBox[{"PrintTemporary", "[", 
       RowBox[{"\"\<y multiplicative factor \>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "yMultFact", "]"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"for", " ", "tracking", " ", "progress"}], " ", "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"make", " ", "a", " ", "light", " ", "ray"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"yStart", " ", "=", " ", 
      RowBox[{"atmMax", "*", "yMultFact"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"origin", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "atmMax"}], "*", "1.25"}], ",", "yStart"}], "}"}]}], 
     ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "origin", " ", "needs", " ", "to", " ", "be", " ", "specified", " ", 
       "by", " ", "doubles", " ", "rather", " ", "than", " ", "ints"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"angle", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"currentN", " ", "=", " ", "1.0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initialize", " ", "lists", " ", "of", " ", "data"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"intersectionPoints", " ", "=", " ", 
      RowBox[{"{", "origin", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"angleList", " ", "=", " ", 
      RowBox[{"{", "angle", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"MoveLightRay", "[", 
      RowBox[{"intersectionPoints", ",", 
       RowBox[{"Last", "[", "angleList", "]"}], ",", "atmosphere"}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"extincted", " ", "=", " ", "False"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", 
          RowBox[{"Last", "[", "intersectionPoints", "]"}], "]"}], "<=", " ", 
         "atmMax"}], " ", "&&", " ", 
        RowBox[{"!", "extincted"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MoveLightRay", "[", 
         RowBox[{"intersectionPoints", ",", 
          RowBox[{"Last", "[", "angleList", "]"}], ",", "atmosphere"}], "]"}],
         ";"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "TODO", " ", "need", " ", "to", " ", "extinguish", " ", "light", " ", 
        "if", " ", "it", " ", "hits", " ", "Pluto"}], " ", "*)"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "put", " ", "the", " ", "results", " ", "in", " ", "the", " ", 
       "appropriate", " ", "lists"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "extincted"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"startingY", ",", "yStart"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"totalRefraction", ",", 
          RowBox[{"Last", "[", "angleList", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"yVsRefraction", ",", 
          RowBox[{"{", 
           RowBox[{"yStart", ",", 
            RowBox[{"Last", "[", "angleList", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "startingY", "]"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"d\[Theta]Overdy", ",", 
             RowBox[{"{", 
              RowBox[{"yStart", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"totalRefraction", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"totalRefraction", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"startingY", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"startingY", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}]}], "}"}]}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"atmGraphics", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"PointSize", "[", "0.01", "]"}], ",", 
            RowBox[{"Point", "[", "intersectionPoints", "]"}]}], "}"}], "]"}],
          ",", 
         RowBox[{"ListLinePlot", "[", "intersectionPoints", "]"}]}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"numIntersectionPoints", ",", 
       RowBox[{"{", 
        RowBox[{"yStart", ",", 
         RowBox[{
          RowBox[{"Length", "[", "intersectionPoints", "]"}], "-", "2"}]}], 
        "}"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "minus", " ", "2", " ", "for", " ", "start", " ", "and", " ", "end", 
       " ", "points"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"NotebookDelete", "[", "temp", "]"}], ";"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"{", 
      RowBox[{"yMultFact", ",", "0.01", ",", "1.10", ",", "0.01"}], "}"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"yMultFact", ",", 
      RowBox[{"-", "1.01"}], ",", "1.01", ",", "0.001"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"graphics", " ", "stuff", " ", "starts", " ", "here"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlutoGraphic", " ", "=", " ", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "0.5"}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"MakeAtmosphereGraphic", "[", "atmosphere", "]"}], ",", 
    "atmGraphics"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"shell", " ", "graphic"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"yVsRefraction", ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<y\>\"", ",", "\"\<refraction angle\>\""}], "}"}]}], ",", 
   RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"numIntersectionPoints", ",", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "d\[Theta]Overdy", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.621465705136365*^9, 3.6214657249554434`*^9}, {
   3.6214658420566463`*^9, 3.6214658727964706`*^9}, 3.621466069260022*^9, {
   3.6214661323088217`*^9, 3.6214663392007747`*^9}, {3.6214664463178654`*^9, 
   3.621466558006203*^9}, {3.6214666206396947`*^9, 3.6214667916181498`*^9}, {
   3.6214668246686306`*^9, 3.621466830005435*^9}, {3.621466863193994*^9, 
   3.621466920441659*^9}, {3.6214669540295177`*^9, 3.621466955369484*^9}, {
   3.6214670358836927`*^9, 3.6214670361358433`*^9}, {3.621467075978162*^9, 
   3.6214671016924095`*^9}, {3.621467137331743*^9, 3.6214672657759686`*^9}, {
   3.621467305261015*^9, 3.6214674324003305`*^9}, {3.621467512588292*^9, 
   3.6214675536975007`*^9}, {3.6214681769302216`*^9, 
   3.6214681984084654`*^9}, {3.6214683059999075`*^9, 
   3.6214684127066927`*^9}, {3.621468454676038*^9, 3.6214685962065744`*^9}, {
   3.621468682682975*^9, 3.621468848962097*^9}, {3.6214689287817907`*^9, 
   3.62146898576727*^9}, {3.621469021246474*^9, 3.621469126657359*^9}, {
   3.6214691926579494`*^9, 3.6214693258665752`*^9}, {3.621469403655833*^9, 
   3.621469427557841*^9}, {3.621469466039147*^9, 3.621469575423877*^9}, {
   3.6214696763125143`*^9, 3.6214697981940994`*^9}, {3.621469898985692*^9, 
   3.621469951670144*^9}, {3.6214700175619354`*^9, 3.621470022682587*^9}, {
   3.6214700539947996`*^9, 3.6214700907048826`*^9}, {3.621470134880267*^9, 
   3.6214701816134586`*^9}, {3.6214702117969017`*^9, 3.621470226332221*^9}, {
   3.6214702944946704`*^9, 3.621470328389725*^9}, {3.621470367213301*^9, 
   3.6214704164432983`*^9}, {3.62147053047427*^9, 3.6214706103770347`*^9}, {
   3.621470656634917*^9, 3.62147100383595*^9}, {3.6214710994338455`*^9, 
   3.6214712377941422`*^9}, {3.621471307162419*^9, 3.6214714114124727`*^9}, {
   3.621471487771714*^9, 3.6214715497687535`*^9}, {3.6214716742382946`*^9, 
   3.621471709725532*^9}, {3.6214721903762665`*^9, 3.621472190775549*^9}, {
   3.6214722498755026`*^9, 3.6214723798894606`*^9}, {3.6214724103140793`*^9, 
   3.62147248931822*^9}, {3.621472529249559*^9, 3.6214726310318823`*^9}, {
   3.6214727099379053`*^9, 3.6214727287973304`*^9}, {3.6214727888103514`*^9, 
   3.6214727955241203`*^9}, {3.62147286557491*^9, 3.621473019753431*^9}, {
   3.6214730608235297`*^9, 3.6214730884031134`*^9}, {3.6214733646033416`*^9, 
   3.6214734005218277`*^9}, {3.621473448460881*^9, 3.62147361402652*^9}, {
   3.621473676724045*^9, 3.621473683588934*^9}, {3.6214748615771494`*^9, 
   3.62147495482039*^9}, {3.6214750736673117`*^9, 3.621475231421372*^9}, {
   3.6214752915590916`*^9, 3.621475362291336*^9}, {3.6214753923146634`*^9, 
   3.621475396409574*^9}, {3.6214754526154985`*^9, 3.6214754888022056`*^9}, 
   3.6214757561771336`*^9, {3.6214758089946537`*^9, 3.62147582652612*^9}, {
   3.6214758903294287`*^9, 3.6214759277910395`*^9}, {3.6214763393970995`*^9, 
   3.621476532143015*^9}, {3.6214765653812237`*^9, 3.6214766174992323`*^9}, {
   3.621476748803506*^9, 3.6214767849471807`*^9}, {3.621541899905279*^9, 
   3.621541921007269*^9}, 3.621541953271216*^9, 3.62154250845358*^9, {
   3.6215425503623333`*^9, 3.6215427319703503`*^9}, {3.621542843424508*^9, 
   3.6215428708259735`*^9}, {3.62154290960452*^9, 3.621542934847481*^9}, {
   3.621542978544493*^9, 3.6215430962791257`*^9}, {3.621543135295869*^9, 
   3.6215432335386324`*^9}, {3.621543328014738*^9, 3.6215435691340237`*^9}, {
   3.6215436401975036`*^9, 3.621543690349152*^9}, {3.621543722376874*^9, 
   3.6215437582493563`*^9}, {3.621543874235762*^9, 3.6215439125719795`*^9}, {
   3.621543983076062*^9, 3.6215440130023193`*^9}, {3.621544054546832*^9, 
   3.6215440585176573`*^9}, {3.621544144540759*^9, 3.6215441477490387`*^9}, 
   3.621544223294731*^9, 3.6215443593003144`*^9, {3.6215443999942493`*^9, 
   3.621544572723919*^9}, {3.62154460582246*^9, 3.6215449683301163`*^9}, {
   3.6215450363464375`*^9, 3.621545128124631*^9}, {3.6215451586473265`*^9, 
   3.6215452291834126`*^9}, {3.621545268947689*^9, 3.6215452870625567`*^9}, {
   3.6215453789087715`*^9, 3.6215455039055624`*^9}, {3.621545587804221*^9, 
   3.621545675969879*^9}, {3.621545786956696*^9, 3.6215457932201395`*^9}, {
   3.6215459899198656`*^9, 3.621546178441811*^9}, {3.621546216232656*^9, 
   3.621546286227353*^9}, {3.6215463801801047`*^9, 3.6215463974944153`*^9}, {
   3.621546495122737*^9, 3.6215465107698517`*^9}, {3.621546809301914*^9, 
   3.621546829599333*^9}, {3.6215469189878473`*^9, 3.621547018806509*^9}, {
   3.621547082732912*^9, 3.62154708325228*^9}, {3.621547233773693*^9, 
   3.621547257622633*^9}, {3.6215472957556934`*^9, 3.6215473938904023`*^9}, {
   3.621547438143838*^9, 3.6215474567080307`*^9}, {3.6215474903499517`*^9, 
   3.6215475192774863`*^9}, {3.6215475743776107`*^9, 3.621547608941164*^9}, {
   3.621547655846484*^9, 3.621547701563959*^9}, {3.6215479275665293`*^9, 
   3.621548006959897*^9}, {3.6215480945170937`*^9, 3.621548150131605*^9}, {
   3.6215481988702497`*^9, 3.62154847291689*^9}, {3.621548664323855*^9, 
   3.621548712268898*^9}, {3.6215487490280085`*^9, 3.6215488027832055`*^9}, {
   3.6215488605982637`*^9, 3.6215489827580404`*^9}, {3.6215490853409157`*^9, 
   3.6215491104421825`*^9}, {3.621549208870102*^9, 3.621549237522484*^9}, {
   3.6215492871807346`*^9, 3.6215494256030583`*^9}, {3.6215494561827807`*^9, 
   3.6215495189723883`*^9}, {3.621549550923078*^9, 3.621549565244258*^9}, {
   3.621549856370059*^9, 3.6215498566672935`*^9}, {3.621549982467811*^9, 
   3.6215500418259993`*^9}, {3.621550078057708*^9, 3.6215500995549784`*^9}, {
   3.621550135151268*^9, 3.6215502310854397`*^9}, {3.62155030448555*^9, 
   3.6215503154823627`*^9}, {3.6215515402523966`*^9, 3.6215515630876*^9}, {
   3.6215521058729753`*^9, 3.6215523345614424`*^9}, {3.6215524221046104`*^9, 
   3.621552493346224*^9}, {3.6215525294558697`*^9, 3.621552748083172*^9}, {
   3.621552909943162*^9, 3.62155309674086*^9}, {3.6215532621173153`*^9, 
   3.621553504078193*^9}, {3.621553554540062*^9, 3.6215536256575613`*^9}, {
   3.6215537168303223`*^9, 3.6215537479824567`*^9}, {3.621553826237039*^9, 
   3.621553826749404*^9}, {3.621553856773733*^9, 3.621553857171014*^9}, {
   3.6215539054302945`*^9, 3.6215539426157103`*^9}, {3.621553980917918*^9, 
   3.6215540475082207`*^9}, {3.6215541032197948`*^9, 3.621554125276491*^9}, {
   3.621554156377555*^9, 3.621554181031068*^9}, {3.6215542155495872`*^9, 
   3.6215542281605525`*^9}, {3.6215542665738335`*^9, 3.621554314217677*^9}, {
   3.6215543823510747`*^9, 3.6215545853533077`*^9}, {3.621554641734329*^9, 
   3.621554659447941*^9}, {3.6215547067335014`*^9, 3.6215548000187664`*^9}, {
   3.6215548364656563`*^9, 3.6215549218192883`*^9}, {3.6215550404705715`*^9, 
   3.621555134135106*^9}, {3.621555265205948*^9, 3.6215552655472193`*^9}, {
   3.62155531449396*^9, 3.6215554152105083`*^9}, {3.621555457010195*^9, 
   3.6215555031943827`*^9}, {3.62162187828401*^9, 3.621621939849612*^9}, {
   3.621621978975405*^9, 3.6216220413226924`*^9}, {3.6216221565295343`*^9, 
   3.6216222845294843`*^9}, {3.621622324973186*^9, 3.6216223591714764`*^9}, {
   3.6216224008000484`*^9, 3.6216224233050356`*^9}, {3.6216224712601285`*^9, 
   3.6216225003087344`*^9}, {3.621622544586195*^9, 3.6216225831445847`*^9}, {
   3.6216226524188147`*^9, 3.621622851636329*^9}, {3.6216229059979153`*^9, 
   3.621623129834939*^9}, {3.621623162895404*^9, 3.621623173360838*^9}, {
   3.6216232169988346`*^9, 3.6216232248294277`*^9}, {3.6216381624770813`*^9, 
   3.621638234560315*^9}, {3.6216382886837616`*^9, 3.6216383376645555`*^9}, {
   3.6216385106404295`*^9, 3.621638538394628*^9}, {3.621638720318829*^9, 
   3.6216388087396383`*^9}, {3.6216389370487823`*^9, 3.621639095798581*^9}, {
   3.6216391272398863`*^9, 3.6216392648360853`*^9}, {3.621639314306198*^9, 
   3.6216394881236687`*^9}, {3.621639586859808*^9, 3.6216396491390767`*^9}, {
   3.6216397276078005`*^9, 3.621639737494812*^9}, {3.6216397729730415`*^9, 
   3.621639774423072*^9}, 3.6216398213634157`*^9, {3.6216398547000723`*^9, 
   3.6216398639716825`*^9}, {3.6216402530217276`*^9, 3.621640293730631*^9}, {
   3.6216403279689455`*^9, 3.6216403906504774`*^9}, {3.6216404228563633`*^9, 
   3.6216404388246956`*^9}, {3.621640545276311*^9, 3.621640648243454*^9}, {
   3.6216406795416865`*^9, 3.6216407359247437`*^9}, {3.6216407699449043`*^9, 
   3.621640855574732*^9}, {3.621640888845368*^9, 3.6216409971693134`*^9}, {
   3.6216411064349327`*^9, 3.621641257300127*^9}, {3.6216412946966686`*^9, 
   3.621641340194981*^9}, {3.6216414404792185`*^9, 3.6216414567998185`*^9}, {
   3.6216415220431647`*^9, 3.621641556578691*^9}, {3.6216416057236176`*^9, 
   3.6216417030507374`*^9}, {3.6216418367157154`*^9, 3.621642025085498*^9}, {
   3.6216420884585133`*^9, 3.6216421481319294`*^9}, {3.621642194893118*^9, 
   3.621642386839469*^9}, {3.621642474233554*^9, 3.6216425221625967`*^9}, {
   3.6216425626243362`*^9, 3.6216425852183867`*^9}, {3.6216428596575584`*^9, 
   3.6216429238531585`*^9}, {3.6216429588390126`*^9, 
   3.6216430249439697`*^9}, {3.6216430894858227`*^9, 
   3.6216434100425234`*^9}, {3.6216436275980663`*^9, 3.621643919926721*^9}, {
   3.621644145885231*^9, 3.6216441484120255`*^9}, {3.621644187611873*^9, 
   3.621644232801978*^9}, {3.6216442875348663`*^9, 3.6216443979643126`*^9}, {
   3.6216444320025043`*^9, 3.6216445648858986`*^9}, {3.6216446436328225`*^9, 
   3.621644660918084*^9}, {3.6216448677650185`*^9, 3.6216449876021748`*^9}, {
   3.6216451662430463`*^9, 3.6216452484144335`*^9}, {3.621645280729377*^9, 
   3.6216453429876013`*^9}, {3.621645526858206*^9, 3.621645743549139*^9}, {
   3.621645831935919*^9, 3.621645935859748*^9}, {3.621645982905175*^9, 
   3.621646048345646*^9}, {3.62164617616144*^9, 3.6216462637136526`*^9}, {
   3.6216463110372643`*^9, 3.6216463923770294`*^9}, {3.621646454323062*^9, 
   3.621646514894059*^9}, {3.621646561086879*^9, 3.6216466284617386`*^9}, {
   3.621646671605381*^9, 3.621646854658411*^9}, {3.6216468847197657`*^9, 
   3.6216469112286015`*^9}, {3.621646947240176*^9, 3.6216469526810627`*^9}, {
   3.621646989886489*^9, 3.6216470788166623`*^9}, {3.6216471268027472`*^9, 
   3.6216472557243385`*^9}, {3.621647375809615*^9, 3.621647386923524*^9}, {
   3.621647563394863*^9, 3.6216475669824123`*^9}, {3.62164762009416*^9, 
   3.6216476993534603`*^9}, {3.6216477336658306`*^9, 3.621647757093481*^9}, {
   3.621647813670656*^9, 3.6216478623322196`*^9}, {3.6216807446545887`*^9, 
   3.62168075545426*^9}, {3.6216807994315286`*^9, 3.62168081838196*^9}, {
   3.621680895065447*^9, 3.621681005463854*^9}, {3.6216814120848627`*^9, 
   3.6216815083702297`*^9}, {3.6216892252074256`*^9, 3.62168925311625*^9}, {
   3.6217012665969367`*^9, 3.621701280333716*^9}, {3.6217016055681124`*^9, 
   3.621701626354901*^9}, 3.6217026209615545`*^9, {3.6217030119847646`*^9, 
   3.621703109815372*^9}, {3.6217032301679983`*^9, 3.6217034959901495`*^9}, {
   3.6217035716399593`*^9, 3.6217036076455765`*^9}, {3.6217036571127667`*^9, 
   3.6217041471864557`*^9}, {3.6217042345446043`*^9, 
   3.6217042633500986`*^9}, {3.6217043519061227`*^9, 
   3.6217045178621817`*^9}, {3.621704550272241*^9, 3.6217045813823814`*^9}, {
   3.6217046607498446`*^9, 3.621704693691283*^9}, {3.6217047555473104`*^9, 
   3.6217047927940884`*^9}, {3.6217048647242665`*^9, 
   3.6217049956013837`*^9}, {3.621705033032029*^9, 3.6217050377784233`*^9}, {
   3.6217050864510527`*^9, 3.621705089829427*^9}, {3.6217051304032936`*^9, 
   3.621705135749127*^9}, {3.6217053352980757`*^9, 3.6217053754516497`*^9}, {
   3.621705454607993*^9, 3.62170570399743*^9}, {3.621705735127557*^9, 
   3.621705790579032*^9}, {3.621705821510738*^9, 3.6217058221532*^9}, {
   3.621706759131115*^9, 3.6217067785909557`*^9}, {3.6217074211844735`*^9, 
   3.6217075537432175`*^9}, {3.6217076716090727`*^9, 3.621707711488475*^9}, {
   3.6217077670480056`*^9, 3.621707792027749*^9}, {3.621708490014925*^9, 
   3.621708553910386*^9}, {3.621708605722274*^9, 3.6217086070231752`*^9}, {
   3.6217086406751423`*^9, 3.6217087875596256`*^9}, {3.6217088677887087`*^9, 
   3.6217089591406994`*^9}, {3.621709020758559*^9, 3.6217090396139603`*^9}, {
   3.6217090923595123`*^9, 3.6217091295219297`*^9}, {3.6217091605359893`*^9, 
   3.621709218182004*^9}, {3.621709258996043*^9, 3.621709264402889*^9}, {
   3.6217093126161995`*^9, 3.621709318399313*^9}, {3.6217093578113585`*^9, 
   3.6217095243328333`*^9}, {3.6217095751860156`*^9, 
   3.6217096325318155`*^9}, {3.6217097021833677`*^9, 
   3.6217097178945503`*^9}, {3.621709835433202*^9, 3.6217098355002193`*^9}, {
   3.6217099318807955`*^9, 3.6217100359808903`*^9}, {3.6217100669398937`*^9, 
   3.621710070771613*^9}, {3.621710103765089*^9, 3.6217101655650587`*^9}, {
   3.621710201704772*^9, 3.6217102751660676`*^9}, {3.621710305783823*^9, 
   3.621710368022112*^9}, {3.6217103993343887`*^9, 3.6217104514074326`*^9}, {
   3.621764962592225*^9, 3.621765042457078*^9}, {3.6217707870759816`*^9, 
   3.621770809403872*^9}, {3.621770843627199*^9, 3.621770846271103*^9}, {
   3.6217711624710484`*^9, 3.621771164140237*^9}, {3.6217711995194387`*^9, 
   3.6217712108724923`*^9}, {3.621771274428713*^9, 3.621771274678914*^9}, 
   3.621771617377702*^9, 3.6217777645450735`*^9, {3.621777873959615*^9, 
   3.621777957572092*^9}, {3.621778012727337*^9, 3.6217780842972383`*^9}, {
   3.6217781844846992`*^9, 3.6217781915007195`*^9}, {3.6217784156911993`*^9, 
   3.6217784475298576`*^9}, {3.6217784934645357`*^9, 
   3.6217785027131443`*^9}, {3.6217785856811457`*^9, 3.621778623678186*^9}, {
   3.621778807875264*^9, 3.6217788881133533`*^9}, {3.6217789200470743`*^9, 
   3.6217789889550714`*^9}, {3.621779025119832*^9, 3.621779025674197*^9}, 
   3.6217791026179714`*^9, {3.6217792186565313`*^9, 3.621779243023869*^9}, {
   3.621779309740337*^9, 3.6217793425966854`*^9}, {3.621779386471931*^9, 
   3.621779441256886*^9}, {3.6217794714844165`*^9, 3.6217794722289457`*^9}, {
   3.6217795135993814`*^9, 3.6217795943138084`*^9}, {3.6217796286512394`*^9, 
   3.6217796711884747`*^9}, {3.6217797307308674`*^9, 
   3.6217797691381645`*^9}, {3.621779801273029*^9, 3.621779882691987*^9}, {
   3.6217803243799458`*^9, 3.6217803634914074`*^9}, {3.6217804133398695`*^9, 
   3.621780418725704*^9}, {3.621788911264947*^9, 3.621789001482136*^9}, {
   3.621789501762088*^9, 3.6217896537832236`*^9}, {3.6217898540657234`*^9, 
   3.621789870564461*^9}, {3.6217899015915313`*^9, 3.621789922031102*^9}, {
   3.6217900195854335`*^9, 3.621790124341954*^9}, {3.621790222584849*^9, 
   3.621790226791847*^9}, {3.6217902840385733`*^9, 3.621790284228725*^9}, {
   3.6217903178386264`*^9, 3.6217904195449915`*^9}, {3.6217904663572974`*^9, 
   3.6217904786030087`*^9}, {3.6217905744411974`*^9, 3.621790667975746*^9}, {
   3.6217907329649963`*^9, 3.6217908499032097`*^9}, {3.621791816633003*^9, 
   3.6217920142373962`*^9}, {3.621792107985099*^9, 3.621792125640684*^9}, 
   3.6217943195130343`*^9, {3.6217945051551332`*^9, 3.621794572149782*^9}, {
   3.621794615452591*^9, 3.621794833350623*^9}, {3.621795287495743*^9, 
   3.621795398898006*^9}, {3.6217976145616584`*^9, 3.621797659843875*^9}, {
   3.6217979248814487`*^9, 3.621797986238132*^9}, {3.6217981246536016`*^9, 
   3.6217981277267704`*^9}, {3.621798191980486*^9, 3.621798208882512*^9}, {
   3.621798263152151*^9, 3.6217983252753243`*^9}, {3.6217984337424965`*^9, 
   3.6217984545343103`*^9}, {3.6217986063012714`*^9, 3.621798627649468*^9}, {
   3.621799122338979*^9, 3.6217991461629295`*^9}, {3.6217993241435604`*^9, 
   3.6217993540878687`*^9}, {3.6217993961260557`*^9, 3.621799409969906*^9}, {
   3.6218087907663383`*^9, 3.621808855959752*^9}, {3.6218091063516207`*^9, 
   3.62180912258317*^9}, {3.621809169808087*^9, 3.621809169965195*^9}, {
   3.6218092144598675`*^9, 3.621809220191961*^9}, {3.6218093630395665`*^9, 
   3.621809440804308*^9}, {3.621809487987884*^9, 3.6218097089653945`*^9}, {
   3.6218097429335327`*^9, 3.6218097841698713`*^9}, {3.6218098487178283`*^9, 
   3.6218098972433233`*^9}, {3.621810456562273*^9, 3.6218105314405775`*^9}, {
   3.621810581276036*^9, 3.6218105863075857`*^9}, {3.621810619787407*^9, 
   3.6218107139123755`*^9}, {3.621810800980324*^9, 3.621810812746724*^9}, {
   3.621810964746501*^9, 3.62181099222305*^9}, {3.6218116154056835`*^9, 
   3.6218116464047675`*^9}, {3.621811762357237*^9, 3.6218117628105593`*^9}, {
   3.6218118000570602`*^9, 3.6218119070832076`*^9}, {3.621811945219341*^9, 
   3.6218119943192763`*^9}, {3.6218120359121995`*^9, 
   3.6218120846228867`*^9}, {3.621812212459813*^9, 3.6218122184230547`*^9}, {
   3.6218122957040424`*^9, 3.6218123022127*^9}, {3.621812389184551*^9, 
   3.621812605122495*^9}, {3.6218126732780166`*^9, 3.6218126737383456`*^9}, {
   3.621813040910555*^9, 3.6218130525748825`*^9}, 3.621813360068966*^9, {
   3.6218134016905775`*^9, 3.621813545179698*^9}, {3.6218136085557604`*^9, 
   3.621813616096126*^9}, {3.621813708216668*^9, 3.6218138311051197`*^9}, {
   3.6218138979816847`*^9, 3.621813975256665*^9}, {3.621814058270727*^9, 
   3.6218141017666745`*^9}, {3.621814142192444*^9, 3.6218141932877913`*^9}, {
   3.6218142392755127`*^9, 3.6218143515523996`*^9}, 3.621814384801051*^9, {
   3.6218144321927695`*^9, 3.6218144424250517`*^9}, {3.6218146044653416`*^9, 
   3.621814615051873*^9}, {3.621814655107402*^9, 3.6218148166446204`*^9}, {
   3.621814846999218*^9, 3.621814891328787*^9}, {3.621814955880684*^9, 
   3.6218149837064857`*^9}, {3.621815016591881*^9, 3.6218150683737216`*^9}, {
   3.6218151490431185`*^9, 3.621815217325981*^9}, {3.621815263432771*^9, 
   3.621815263897095*^9}, {3.621815358286252*^9, 3.621815358599476*^9}, {
   3.621853160834913*^9, 3.6218531609660187`*^9}, {3.6218617351584673`*^9, 
   3.621861752055785*^9}, 3.621861805282653*^9, {3.621861986717807*^9, 
   3.621862015027977*^9}, {3.621862239509666*^9, 3.6218622707699127`*^9}, {
   3.621862326648664*^9, 3.621862332101545*^9}, {3.6218623828876786`*^9, 
   3.6218624400283637`*^9}, {3.621862498076664*^9, 3.6218624994055843`*^9}, {
   3.6218627807147293`*^9, 3.6218628200407343`*^9}, {3.621872071036574*^9, 
   3.621872081655134*^9}, {3.6218721172224507`*^9, 3.621872128929793*^9}, {
   3.6218721822497*^9, 3.621872188644251*^9}, {3.6218723394925766`*^9, 
   3.621872341458005*^9}, {3.6218723898174124`*^9, 3.6218724337997007`*^9}, {
   3.621872623277519*^9, 3.6218726328163033`*^9}, {3.621872734675745*^9, 
   3.6218727416507273`*^9}, {3.621872787939664*^9, 3.621872789333641*^9}, 
   3.6218729187167196`*^9, {3.621872962402771*^9, 3.6218730050200934`*^9}, {
   3.621873192910777*^9, 3.6218732423977118`*^9}, {3.6218733889239364`*^9, 
   3.6218733894673386`*^9}, {3.6218734244602475`*^9, 
   3.6218734586815953`*^9}, {3.6218735944061317`*^9, 
   3.6218735995978527`*^9}, {3.6218736878026085`*^9, 
   3.6218737148388195`*^9}, {3.621873837477076*^9, 3.621873844961404*^9}, {
   3.6218739003933477`*^9, 3.621873917364444*^9}, {3.621873951884004*^9, 
   3.621874038751029*^9}, {3.6218740854012327`*^9, 3.6218741347343197`*^9}, {
   3.621874282295312*^9, 3.6218743325339622`*^9}, {3.621874418108848*^9, 
   3.6218744863293858`*^9}, {3.621875399042223*^9, 3.6218753991853323`*^9}, {
   3.6218755205076513`*^9, 3.6218755547900424`*^9}, {3.621875612285974*^9, 
   3.621875729169106*^9}, 3.6218760843880367`*^9, 3.621876130158575*^9, {
   3.6218762012681684`*^9, 3.6218763462423167`*^9}, {3.6218763788865414`*^9, 
   3.621876417393245*^9}, {3.6218801333879075`*^9, 3.6218802109471207`*^9}, {
   3.621880309627303*^9, 3.6218803099705753`*^9}, {3.621880538826996*^9, 
   3.621880637797256*^9}, {3.6218806730873938`*^9, 3.621880684107206*^9}, {
   3.6218807786384635`*^9, 3.621880781513509*^9}, {3.621880811549908*^9, 
   3.621880817646217*^9}, {3.6218808684543657`*^9, 3.6218808749680004`*^9}, {
   3.6218809468471413`*^9, 3.621881019247654*^9}, 3.621881255437702*^9, {
   3.621881452361906*^9, 3.621881586981713*^9}, {3.62188164003346*^9, 
   3.621881793061632*^9}, {3.6218819124325676`*^9, 3.621881938633234*^9}, {
   3.6218819855308456`*^9, 3.621882067539193*^9}, 3.62188213616702*^9, {
   3.621882188247076*^9, 3.6218821950499163`*^9}, {3.6218822260039406`*^9, 
   3.6218823085977135`*^9}, {3.6218823647086573`*^9, 3.621882403611335*^9}, {
   3.6218824530314674`*^9, 3.621882547488702*^9}, {3.6218826321599445`*^9, 
   3.6218826372695513`*^9}, {3.621882679722757*^9, 3.621882701998612*^9}, {
   3.621882747259808*^9, 3.6218827617421412`*^9}, {3.621882867299927*^9, 
   3.6218828757839546`*^9}, {3.621882981623238*^9, 3.6218830218748765`*^9}, {
   3.6218831562815113`*^9, 3.6218832080913973`*^9}, {3.6218832941926265`*^9, 
   3.6218833616166005`*^9}, {3.6218833957472825`*^9, 3.621883660417592*^9}, {
   3.6218837179185047`*^9, 3.6218841030627065`*^9}, 3.621884148124752*^9, {
   3.62188428336199*^9, 3.621884398878178*^9}, {3.6218844408100257`*^9, 
   3.6218847876384783`*^9}, {3.621884817859975*^9, 3.621884844662044*^9}, {
   3.621884904857874*^9, 3.621884907085464*^9}, {3.621884972602666*^9, 
   3.6218849776182375`*^9}, {3.621885162135516*^9, 3.62188521598081*^9}, {
   3.6218852715993834`*^9, 3.6218852813913784`*^9}, {3.6218853159819593`*^9, 
   3.6218853162931805`*^9}, {3.621885397215678*^9, 3.6218854121332865`*^9}, {
   3.621885839620762*^9, 3.6218858900766897`*^9}, {3.6218859709754705`*^9, 
   3.621885977871352*^9}, {3.621886073524268*^9, 3.6218860881106462`*^9}, 
   3.6219402610703773`*^9, {3.621940555967552*^9, 3.621940572331194*^9}, {
   3.622501342234991*^9, 3.6225013880077443`*^9}, {3.6225017155066805`*^9, 
   3.622501716485361*^9}, {3.622501751488221*^9, 3.622501783142687*^9}, {
   3.6225018586092653`*^9, 3.6225018994362535`*^9}, {3.622501947593371*^9, 
   3.622501953922865*^9}, {3.622501992938589*^9, 3.6225020697009335`*^9}, {
   3.6225023318460884`*^9, 3.6225023789734564`*^9}, {3.622502435657799*^9, 
   3.6225024380568843`*^9}, {3.622502496490435*^9, 3.622502537225041*^9}, {
   3.622502609052881*^9, 3.6225026581388702`*^9}, {3.622502787579761*^9, 
   3.622502927276821*^9}, {3.6225030524302697`*^9, 3.6225031262803936`*^9}, {
   3.622503341979293*^9, 3.6225033425418*^9}, {3.622503618332043*^9, 
   3.6225036313053474`*^9}, {3.6225038537698393`*^9, 3.622503854010993*^9}, 
   3.622503904935166*^9, {3.6225039485631227`*^9, 3.6225039489764175`*^9}, {
   3.622504023613406*^9, 3.6225040802706537`*^9}, {3.6225041408076115`*^9, 
   3.622504160997959*^9}, {3.622504369383589*^9, 3.6225043755629773`*^9}, {
   3.6225044263570194`*^9, 3.6225044266782494`*^9}, 3.622504751563908*^9, {
   3.6225048373608356`*^9, 3.622504838732795*^9}, {3.622505092066656*^9, 
   3.622505133072768*^9}, {3.6225052276929646`*^9, 3.6225052355104976`*^9}, {
   3.622505266112245*^9, 3.6225052723917*^9}, {3.622505349009076*^9, 
   3.622505352690692*^9}, 3.6225055279741545`*^9, {3.6225058056703115`*^9, 
   3.622505813950186*^9}, {3.6225457824296765`*^9, 3.6225457968302336`*^9}, 
   3.6225467628160205`*^9, {3.62254679381013*^9, 3.6225468081153126`*^9}, {
   3.622548619872162*^9, 3.6225486434662933`*^9}, {3.622648785374501*^9, 
   3.622648863773217*^9}, {3.622648895875321*^9, 3.6226489409462395`*^9}, {
   3.6226493096438866`*^9, 3.6226493833126287`*^9}, {3.6226499551954165`*^9, 
   3.622650141426086*^9}, {3.6226502572535653`*^9, 3.622650282883869*^9}, {
   3.622650354652051*^9, 3.622650374095359*^9}, {3.622650448572137*^9, 
   3.6226504661153693`*^9}, {3.6226506412222333`*^9, 
   3.6226506635971127`*^9}, {3.622650703526408*^9, 3.6226507039382963`*^9}, {
   3.622650753242163*^9, 3.6226507569749146`*^9}, {3.6226508267160344`*^9, 
   3.6226508270285206`*^9}, {3.622650878312103*^9, 3.6226508886384172`*^9}, {
   3.6226509380404143`*^9, 3.622650952993504*^9}, {3.622650987782486*^9, 
   3.6226510310514135`*^9}, {3.62265115133795*^9, 3.622651205379515*^9}, {
   3.6226513215830984`*^9, 3.622651353052235*^9}, {3.6226514396580257`*^9, 
   3.622651611546926*^9}, {3.6226518096580105`*^9, 3.6226518132332315`*^9}, {
   3.6226523161928964`*^9, 3.6226523192457333`*^9}, {3.622652540592303*^9, 
   3.6226526046711082`*^9}, {3.6226526578578506`*^9, 
   3.6226527740663147`*^9}, {3.6226528136389217`*^9, 
   3.6226528862577567`*^9}, {3.622653117717933*^9, 3.6226532457531595`*^9}, {
   3.622653281201498*^9, 3.6226533434353*^9}, {3.6226535022196836`*^9, 
   3.622653502266574*^9}, {3.622653556544228*^9, 3.62265356209206*^9}, {
   3.62265359966576*^9, 3.6226536024822125`*^9}, 3.622653708493844*^9, {
   3.622653880813573*^9, 3.622654008581313*^9}, {3.6226540681144104`*^9, 
   3.6226540686565857`*^9}, {3.6226541314577975`*^9, 3.622654153857133*^9}, {
   3.622654225589188*^9, 3.6226542274976754`*^9}, 3.622654333579066*^9, {
   3.622654448705947*^9, 3.622654521816012*^9}, {3.622654741342024*^9, 
   3.6226547641639566`*^9}, {3.6226548586143804`*^9, 3.622654881611663*^9}, {
   3.622654922927817*^9, 3.622654937901675*^9}, {3.6226550076376867`*^9, 
   3.6226550348301105`*^9}, 3.6226551975952473`*^9, {3.6226555751646404`*^9, 
   3.6226555759505796`*^9}, {3.622656801118592*^9, 3.622656806578698*^9}, {
   3.6226568539168124`*^9, 3.6226568779705596`*^9}, {3.6226569098880644`*^9, 
   3.6226569119662127`*^9}, {3.6226570396292834`*^9, 3.622657065842127*^9}, {
   3.622657123611044*^9, 3.622657123882435*^9}, {3.622657186379265*^9, 
   3.62265721531118*^9}, {3.622658090532839*^9, 3.6226581205713387`*^9}, {
   3.622658159528721*^9, 3.622658187190304*^9}, {3.622658229058871*^9, 
   3.6226582454953413`*^9}, 3.622658346251437*^9, {3.6226583934875393`*^9, 
   3.6226584094290123`*^9}, {3.6226585294786463`*^9, 3.62265853838081*^9}, {
   3.622658709649451*^9, 3.622658733120612*^9}, {3.6226587991949077`*^9, 
   3.6226590325453696`*^9}, {3.6226590785292387`*^9, 3.622659080757081*^9}, {
   3.622659114245533*^9, 3.6226591439719124`*^9}, {3.6226592983266726`*^9, 
   3.622659309704338*^9}, {3.622659382686309*^9, 3.622659383010953*^9}, {
   3.6226594780252943`*^9, 3.6226594781346936`*^9}, 3.622659511795841*^9, {
   3.6226596217824492`*^9, 3.622659627109716*^9}, {3.6226597835568733`*^9, 
   3.6226598127348027`*^9}, {3.6226599342181234`*^9, 
   3.6226599344681273`*^9}, {3.622660016295748*^9, 3.6226600323260417`*^9}, {
   3.6226601080019035`*^9, 3.6226601237420583`*^9}, {3.6226607409544067`*^9, 
   3.622660743569689*^9}, {3.622660787457856*^9, 3.622660891054842*^9}, {
   3.6226609785481253`*^9, 3.6226609832772875`*^9}, {3.6226610651842785`*^9, 
   3.6226610657649565`*^9}, {3.622661096482655*^9, 3.6226611087002363`*^9}, {
   3.622661140152177*^9, 3.6226611700834236`*^9}, {3.622661231060557*^9, 
   3.622661262902399*^9}, 3.622661311680157*^9, {3.6226616112209334`*^9, 
   3.622661611377207*^9}, {3.62266169192529*^9, 3.6226617007427745`*^9}, {
   3.622661844949051*^9, 3.6226618455271854`*^9}, {3.6226621061908636`*^9, 
   3.6226621221346226`*^9}, {3.622665356085969*^9, 3.6226653618710527`*^9}, {
   3.622669833816182*^9, 3.622669837330652*^9}, {3.622669872797893*^9, 
   3.622669880336527*^9}, {3.6227491647213793`*^9, 3.6227491718717294`*^9}, {
   3.622749836147938*^9, 3.622749851912128*^9}, {3.622749901914646*^9, 
   3.6227499298904915`*^9}, {3.6227499613258324`*^9, 
   3.6227500239740515`*^9}, {3.6227500682194605`*^9, 3.622750080810402*^9}, {
   3.6227501234306602`*^9, 3.6227501559377384`*^9}, 3.622750287250986*^9, {
   3.6227503537992144`*^9, 3.622750377854294*^9}, {3.622750410096185*^9, 
   3.622750417980782*^9}, 3.622750758988906*^9, 3.6227509150826073`*^9, {
   3.622751055461337*^9, 3.6227511682854385`*^9}, {3.622751204215948*^9, 
   3.6227512168519382`*^9}, {3.6227513633189354`*^9, 3.622751363870297*^9}, {
   3.6227514786718025`*^9, 3.6227514898247223`*^9}, {3.622751593437873*^9, 
   3.622751737613233*^9}, {3.6227518454612813`*^9, 3.622751902924075*^9}, {
   3.6227519597033887`*^9, 3.622751987852374*^9}, {3.6227592407682376`*^9, 
   3.6227592409203453`*^9}, {3.6227602241391754`*^9, 3.622760273707875*^9}, {
   3.622760462580982*^9, 3.6227604716944385`*^9}, {3.622760973583784*^9, 
   3.6227610328398542`*^9}, {3.6227612275420876`*^9, 3.622761277308402*^9}, {
   3.6227613224314566`*^9, 3.6227613264933224`*^9}, {3.622761365377929*^9, 
   3.6227614365024247`*^9}, {3.622761482457053*^9, 3.622761553299349*^9}, {
   3.622761583662923*^9, 3.622761593917185*^9}, {3.6227616496207337`*^9, 
   3.622761649697789*^9}, {3.6227616813642697`*^9, 3.622761681680497*^9}, {
   3.6227618693952503`*^9, 3.6227619692741566`*^9}, {3.6227621038698244`*^9, 
   3.6227621334528275`*^9}, {3.6227623000491047`*^9, 
   3.6227623017943583`*^9}, {3.622762338335288*^9, 3.6227623388046207`*^9}, {
   3.622762383043046*^9, 3.6227624282321124`*^9}, {3.622762815168825*^9, 
   3.6227629184271355`*^9}, {3.6227635074393272`*^9, 3.622763562945739*^9}, {
   3.622763596883847*^9, 3.6227636355783043`*^9}, {3.6227638238920193`*^9, 
   3.622763825322016*^9}, {3.622763999549732*^9, 3.6227641119104843`*^9}, {
   3.6227641772969065`*^9, 3.6227641805632443`*^9}, {3.6227642227491765`*^9, 
   3.6227642392148676`*^9}, 3.622764362685546*^9, 3.6227645266809783`*^9, 
   3.6227666519864388`*^9, {3.6227666882231627`*^9, 3.6227667264513216`*^9}, {
   3.6227667596118484`*^9, 3.622766784036188*^9}, {3.622766831571937*^9, 
   3.6227669097070684`*^9}, {3.622767240927536*^9, 3.6227672557260246`*^9}, {
   3.6227677697219477`*^9, 3.6227677951880493`*^9}, {3.6227678830073757`*^9, 
   3.622767958321847*^9}, {3.6227680842622614`*^9, 3.6227681246549387`*^9}, {
   3.6227681587431593`*^9, 3.6227681593105617`*^9}, {3.622768209659308*^9, 
   3.6227682902416787`*^9}, {3.622768355000634*^9, 3.622768371448312*^9}, 
   3.622768465042775*^9, 3.6227686700243764`*^9, {3.622769847341157*^9, 
   3.6227698906268873`*^9}}]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.2 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 89917, 1843, 9212, "Input"]
}
]
*)

(* End of internal cache information *)
