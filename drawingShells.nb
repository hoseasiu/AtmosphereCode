(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66789,       1431]
NotebookOptionsPosition[     65520,       1390]
NotebookOutlinePosition[     65897,       1406]
CellTagsIndexPosition[     65854,       1403]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Assumptions", ":", "\[IndentingNewLine]", " ", 
    RowBox[{
    "shells", " ", "are", " ", "located", " ", "around", " ", "the", " ", 
     "origin", "\[IndentingNewLine]", "light", " ", "rays", " ", "never", " ",
      "bend", " ", "more", " ", "than", " ", "90", " ", "degrees"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"shells", " ", "are", " ", "composed", " ", "of", " ", "the", " ", 
     RowBox[{"following", ":", " ", 
      RowBox[{"the", " ", "circle", " ", "graphic"}]}]}], ",", " ", 
    RowBox[{"the", " ", "circle", " ", "equation"}], ",", " ", 
    RowBox[{"the", " ", "circle", " ", "radius"}], ",", " ", 
    RowBox[{"the", " ", "n", " ", "value"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "more", " ", "will", " ", "be", " ", "added", " ", "to", " ", "shells", 
    " ", "as", " ", "we", " ", "get", " ", "into", " ", "physical", " ", 
    "properties"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Shell", "[", 
     RowBox[{"r_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "r"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], "==", 
       SuperscriptBox["r", "2"]}], ",", "r", ",", "n"}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ray", "[", 
    RowBox[{"point_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"y", "-", 
     RowBox[{"point", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"x", "-", 
       RowBox[{"point", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalAngle", "[", "point_", "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"point", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"point", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsPointReal", "[", "point_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "/.", "point"}], ")"}], "\[Element]", "Reals"}], "&&", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"y", "/.", "point"}], ")"}], "\[Element]", "Reals"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SnellsLaw", "[", 
     RowBox[{"\[Theta]in_", ",", "nin_", ",", "nout_"}], "]"}], ":=", 
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]in", "]"}], 
      RowBox[{"nin", "/", "nout"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "make", " ", "an", " ", "atmosphere", " ", "with", " ", "linearly"}], 
     "-", 
     RowBox[{
     "spaced", " ", "shells", " ", "specified", " ", "by", " ", "minimum"}]}],
     ",", " ", "maximum", ",", " ", 
    RowBox[{"and", " ", "step", " ", "size", " ", "of", " ", "radius"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphere", "[", 
    RowBox[{"min_", ",", "max_", ",", "step_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "center", ",", "nMax", ",", "nStep", ",", "n"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"atmosphere", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"TODO", " ", "-", " ", 
        RowBox[{
        "filling", " ", "in", " ", "dummy", " ", "n", " ", "values", " ", 
         "for", " ", "now"}], "-", " ", 
        RowBox[{
        "probably", " ", "make", " ", "a", " ", "function", " ", "to", " ", 
         "pull", " ", "from", " ", "actually", " ", "state", " ", "variables",
          " ", "to", " ", "calculate", " ", "n", " ", "values", " ", 
         "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nMax", " ", "=", " ", "1."}], ";", "\[IndentingNewLine]", 
      RowBox[{"nStep", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"nMax", "-", "1."}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"max", "-", "min"}], ")"}], "/", "step"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", "nMax"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atmosphere", " ", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"atmosphere", ",", 
             RowBox[{"Shell", "[", 
              RowBox[{"r", ",", "n"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"n", "-=", "nStep"}], ";"}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"r", ",", "min", ",", "max", ",", "step"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "the", " ", "graphics", " ", "objects"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphereGraphic", "[", "atm_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"atmosphere", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeIntersectionsPointsGraphic", "[", "intersections_", "]"}], ":=", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Red", ",", 
       RowBox[{"Point", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "/.", 
             RowBox[{"intersections", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"y", "/.", 
             RowBox[{"intersections", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "intersections", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindNextShellIntersection", "[", 
    RowBox[{"radius_", ",", "rayPosition_", ",", "rayAngle_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "y0", ",", "m", ",", "t1", ",", "t2", ",", "tList"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x0", " ", "=", " ", 
       RowBox[{"rayPosition", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y0", " ", "=", " ", 
       RowBox[{"rayPosition", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Tan", "[", "rayAngle", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "-", 
          RowBox[{"m", " ", "y0"}], " ", "+", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["radius", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["m", "2"]}], ")"}]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", 
               RowBox[{"m", " ", "x0"}]}], ")"}], "2"]}]]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["m", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "-", 
          RowBox[{"m", " ", "y0"}], " ", "-", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["radius", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["m", "2"]}], ")"}]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", 
               RowBox[{"m", " ", "x0"}]}], ")"}], "2"]}]]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["m", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "return", " ", "only", " ", "real", " ", "positive", " ", "time", " ", 
        "values"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t1", ",", "t2"}], "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "\[Element]", "Reals"}], "&&", 
            RowBox[{"#", ">", "0"}]}], ")"}], "&"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "that", " ", "identifies", " ", "where", " ", "the", " ", 
    "light", " ", "currently", " ", "is", " ", "in", " ", "relation", " ", 
    "to", " ", "shells"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocateLightRay", "[", 
    RowBox[{"position_", ",", "atm_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shellRadii", ",", "posRadius"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"shellRadii", " ", "=", " ", 
         RowBox[{"atm", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"posRadius", " ", "=", " ", 
         RowBox[{"Norm", "[", "position", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"entirely", " ", "outside", " ", "of", " ", "shells"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"posRadius", " ", ">", " ", 
           RowBox[{"Last", "[", "shellRadii", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"rayLocation", " ", "=", " ", "\"\<outside\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "entirely", " ", "inside", " ", "the", " ", "inner", " ", 
            "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"posRadius", " ", "<", " ", 
           RowBox[{"First", "[", "shellRadii", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"rayLocation", " ", "=", " ", "\"\<inside\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"on", " ", "outer", " ", "shell"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"Last", "[", "shellRadii", "]"}], "-", " ", 
             "posRadius"}], "]"}], "<", "TOL"}], ",", "\[IndentingNewLine]", 
          RowBox[{"rayLocation", " ", "=", " ", "\"\<on outer shell\>\""}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"posRadius", "-", 
                   RowBox[{"shellRadii", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<", "TOL"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"shellNum", " ", "=", " ", "i"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"rayLocation", "=", "\"\<on\>\""}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}], ";"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"rayLocation", " ", "=", " ", "\"\<between\>\""}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ";", 
      "\[IndentingNewLine]", "rayLocation"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "updates", " ", "the", " ", "light", " ", "position", " ", "based", " ", 
     "on", " ", "current", " ", "position"}], ",", " ", "direction", ",", " ", 
    RowBox[{"and", " ", "shells"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", 
    RowBox[{
    "need", " ", "to", " ", "handle", " ", "the", " ", "case", " ", "where", 
     " ", 
     RowBox[{"it", "'"}], "s", " ", "at", " ", "the", " ", "end", " ", "of", 
     " ", "the", " ", "last", " ", "atmosphere", " ", "layer"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoveLightRay", "[", 
    RowBox[{"rayPath_", ",", "rayAngle_", ",", "atm_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "direction", ",", "checkShellNum", ",", "closestIntersect", ",", "sol", 
       ",", "location", ",", "tList", ",", "intersect", ",", "t", ",", "n2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"position", " ", "=", " ", 
       RowBox[{"Last", "[", "rayPath", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"posRadius", " ", "=", " ", 
       RowBox[{"Norm", "[", "position", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"location", "  ", "=", " ", 
       RowBox[{"LocateLightRay", "[", 
        RowBox[{"position", ",", "atm"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
         "outermost", " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<outside\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", " ", "=", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"FindNextShellIntersection", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Last", "[", "atm", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "position", ",", 
              "rayAngle"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"shell", " ", "=", " ", 
           RowBox[{"Last", "[", "atm", "]"}]}], ";"}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
          "innermost", " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<inside\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", " ", "=", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"FindNextShellIntersection", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "atm", "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "position", ",", 
              "rayAngle"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
         "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
           "second"}], "-", 
          RowBox[{"outermost", " ", "shell", " ", "unless", " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", "one"}], "-", 
          RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<on outer shell\>\""}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "atm", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", 
              RowBox[{"it", "'"}], "s", " ", "a", " ", "multi"}], "-", 
             RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"t", " ", "=", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"FindNextShellIntersection", "[", 
                RowBox[{
                 RowBox[{"atm", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"-", "2"}], ",", "3"}], "]"}], "]"}], ",", 
                 "position", ",", "rayAngle"}], "]"}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"else", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "a", " ", "single"}], "-", 
             RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"t", " ", "=", " ", 
              RowBox[{"Min", "[", 
               RowBox[{"FindNextShellIntersection", "[", 
                RowBox[{
                 RowBox[{"atm", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "position", 
                 ",", "rayAngle"}], "]"}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "need", " ", "to", " ", "check", " ", "the", " ", "previous"}], ",",
           " ", "current", ",", " ", 
          RowBox[{"and", " ", "next", " ", "shells"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<on\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"posRadius", "-", 
                  RowBox[{
                   RowBox[{"atm", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", "3"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<", "TOL"}], ",",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"shellNum", " ", "=", " ", "i"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}], ","}], 
              "\[IndentingNewLine]", "]"}], ";"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"shellNum", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"if", " ", "on", " ", "inner", " ", "shell"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"shellNum", "+", "1"}], ",", "3"}], "]"}], "]"}], 
                  ",", "position", ",", "rayAngle"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], ",", 
                  "position", ",", "rayAngle"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "if", " ", "on", " ", "some", " ", "other", " ", "shell"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"t", " ", "=", " ", 
             RowBox[{"Min", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"shellNum", "+", "1"}], ",", "3"}], "]"}], "]"}], 
                  ",", "position", ",", "rayAngle"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], ",", 
                  "position", ",", "rayAngle"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"FindNextShellIntersection", "[", 
                 RowBox[{
                  RowBox[{"atm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"shellNum", "-", "1"}], ",", "3"}], "]"}], "]"}], 
                  ",", "position", ",", "rayAngle"}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}],
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "}"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "need", " ", "to", " ", "check", " ", "the", " ", "shells", " ", 
           "that", " ", "it", " ", "is", " ", "between"}], "-", " ", 
          RowBox[{
          "now", " ", "use", " ", "currentShell", " ", "as", " ", "a", " ", 
           "counter"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", "\"\<between\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<warning: between atmosphere layers - this shouldn't really \
happen\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"shellNum", " ", "=", 
           RowBox[{"Length", "[", "atm", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"atm", "[", 
              RowBox[{"[", 
               RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], " ", ">", " ", 
             "posRadius"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"shellNum", "-=", "1"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"tList", " ", "=", " ", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{"shellNum", ",", "3"}], "]"}], "]"}], ",", 
               "position", ",", "rayAngle"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"shellNum", "+", "1"}], ",", "3"}], "]"}], "]"}], 
               ",", "position", ",", "rayAngle"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"t", "=", " ", 
           RowBox[{"Min", "[", "tList", "]"}]}], ";"}], "\[IndentingNewLine]",
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "stuff", " ", "to", " ", "be", " ", "done", " ", "regardless", " ", 
        "of", " ", "ray", " ", "location", " ", "case"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"non", "-", 
        RowBox[{"intersection", " ", "case"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "\[Equal]", "Infinity"}], ",", "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "just", " ", "set", " ", "t", " ", "to", " ", "some", " ", "small", 
          " ", "value", " ", 
          RowBox[{"(", 
           RowBox[{
           "probably", " ", "adjust", " ", "to", " ", "fit", " ", "window", 
            " ", "size", " ", "later"}], " "}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"intersect", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "+", 
          RowBox[{"position", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Tan", "[", "rayAngle", " ", "]"}], " ", "t"}], " ", "+", 
          " ", 
          RowBox[{"position", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"position", " ", "=", " ", "intersect"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"figure", " ", "out", " ", "which", " ", 
        RowBox[{"we", "'"}], "re", " ", "now", " ", "interacting", " ", 
        "with"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"Norm", "[", "position", "]"}], "-", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "3"}], "]"}], "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<", "TOL"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "get", " ", "the", " ", "refractivity", " ", "of", " ", "the", 
             " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"n2", " ", "=", " ", 
             RowBox[{"atm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}], ";"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", 
              RowBox[{"we", "'"}], "re", " ", "not", " ", "interacting", " ", 
              "with", " ", "a", " ", "shell"}], ",", " ", 
             RowBox[{
              RowBox[{"then", " ", 
               RowBox[{"we", "'"}], "re", " ", "back", " ", "in", " ", 
               "vacuum", " ", "with", " ", "n2"}], " ", "=", " ", "1.0"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"n2", " ", "=", " ", "1.0"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"intersectionPoints", ",", "position"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"angleList", ",", 
        RowBox[{"Refract", "[", 
         RowBox[{"intersectionPoints", ",", "angleList", ",", "n2"}], "]"}]}],
        "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "position"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "refract", " ", "based", " ", "on", " ", "entry", " ", "and", " ", "shell",
     " ", "conditions", " ", "using", " ", 
    RowBox[{"Snell", "'"}], "s", " ", "Law"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Refract", "[", 
    RowBox[{"rayPath_", ",", "angles_", ",", "n2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newAngle", ",", "position", ",", "prevPosition"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"position", " ", "=", " ", 
       RowBox[{"Last", "[", "rayPath", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"prevPosition", " ", "=", " ", 
       RowBox[{"rayPath", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"angle", " ", "=", " ", 
       RowBox[{"Last", "[", "angles", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "need", " ", "to", " ", "handle", " ", "grazing", " ", "case", " ", 
         "earlier"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "hitting", " ", "shell", " ", "from", " ", "outside", " ", "in", " ", 
         RowBox[{"(", 
          RowBox[{"radius", " ", "decreasing"}], ")"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", "position", "]"}], "<", 
         RowBox[{"Norm", "[", "prevPosition", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"TODO", " ", "-", " ", 
          RowBox[{"this", " ", "should", " ", "be", " ", "okay", " ", "now"}],
           "-", " ", 
          RowBox[{
          "though", " ", "the", " ", "other", " ", "conditions", " ", "still",
            " ", "need", " ", "to", " ", "be", " ", "tested"}]}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"TODO", " ", "-", " ", 
          RowBox[{
           RowBox[{"Snell", "'"}], "s", " ", "Law", " ", "needs", " ", "to", 
           " ", "be", " ", "applied", " ", "according", " ", "to", " ", 
           "which", " ", "shell", " ", 
           RowBox[{"we", "'"}], "re", " ", "interacting", " ", "with"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newAngle", " ", "=", " ", 
         RowBox[{
          RowBox[{"NormalAngle", "[", "position", "]"}], "-", "\[Pi]", "+", 
          RowBox[{"SnellsLaw", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", 
              RowBox[{"NormalAngle", "[", "position", "]"}], "+", "angle"}], 
             ")"}], ",", "currentN", ",", "n2"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "hitting", " ", "shell", " ", "from", " ", "inside", " ", "out"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"TODO", " ", "-", " ", 
          RowBox[{"check", " ", "this", " ", "condition"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Norm", "[", "position", "]"}], ">", 
           RowBox[{"Norm", "[", "prevPosition", "]"}]}], ")"}], " ", "||", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Norm", "[", "position", "]"}], "\[Equal]", " ", 
           RowBox[{"Norm", "[", "prevPosition", "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"position", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newAngle", " ", "=", " ", 
         RowBox[{
          RowBox[{"NormalAngle", "[", "position", "]"}], "-", 
          RowBox[{"SnellsLaw", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Pi]", "-", 
              RowBox[{"NormalAngle", "[", "position", "]"}], "-", "angle"}], 
             ")"}], ",", "currentN", ",", "n2"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "hitting", " ", "the", " ", "top", " ", "or", " ", "bottom", " ", 
           "of", " ", "a", " ", "shell"}], "-", " ", 
          RowBox[{"could", " ", "be", " ", "either", " ", "outside"}], "-", 
          RowBox[{"in", " ", "or", " ", "inside"}], "-", "out"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "TODO", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"position", " ", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", " ", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"angle", "\[NotEqual]", " ", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", "\"\<hit top of shell\>\"", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"newAngle", " ", "=", " ", 
                RowBox[{"Return", "[", 
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], "-", 
                  RowBox[{"Abs", "[", "angle", "]"}]}], "]"}]}], ","}], 
              "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "angle"}], 
            " ", "\[Equal]", " ", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "\"\<non-intersection case\>\"", "]"}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"TODO", " ", "non"}], "-", 
            RowBox[{"intersecting", " ", "grazing", " ", "case"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentN", "=", "n2"}], ";", "\[IndentingNewLine]", 
      "newAngle"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"run", " ", "the", " ", "program", " ", "starting", " ", "here"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TOL", " ", "=", " ", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"origin", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.1"}], ",", "1.15"}], "}"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "origin", " ", "needs", " ", "to", " ", "be", " ", "specified", " ", "by", 
    " ", "doubles", " ", "rather", " ", "than", " ", "ints"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"angle", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"currentN", " ", "=", " ", "1.0"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "TODO", " ", "can", " ", "i", " ", "just", " ", "get", " ", "rid", " ", 
    "of", " ", 
    RowBox[{"this", "?"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lightRay", " ", "=", " ", 
    RowBox[{"Ray", "[", 
     RowBox[{"origin", ",", "angle"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", 
    RowBox[{"standardize", " ", "these", " ", "names"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intersectionPoints", " ", "=", " ", 
   RowBox[{"{", "origin", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleList", " ", "=", " ", 
   RowBox[{"{", "angle", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"atmMin", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"atmMax", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphere", "[", 
    RowBox[{"atmMin", ",", "atmMax", ",", "0.1"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"main", " ", "loop", " ", "starts", " ", "here"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"While", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Last", "[", "intersectionPoints", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "<", " ", "atmMax"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MoveLightRay", "[", 
       RowBox[{"intersectionPoints", ",", 
        RowBox[{"Last", "[", "angleList", "]"}], ",", "atmosphere"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"intersectionPoints", ",", 
         RowBox[{"MoveLightRay", "[", 
          RowBox[{"intersectionPoints", ",", 
           RowBox[{"Last", "[", "angleList", "]"}], ",", "atmosphere"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"angleList", ",", 
         RowBox[{"Refract", "[", 
          RowBox[{"intersectionPoints", ",", "angleList"}], "]"}]}], "]"}], 
       ";"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "12"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"graphics", " ", "stuff", " ", "starts", " ", "here"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlutoGraphic", " ", "=", " ", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "0.5"}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"PlutoGraphic", ",", 
   RowBox[{"MakeAtmosphereGraphic", "[", "atmosphere", "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
      RowBox[{"Point", "[", "intersectionPoints", "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", "intersectionPoints", "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", " ", "True"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.621465705136365*^9, 3.6214657249554434`*^9}, {
   3.6214658420566463`*^9, 3.6214658727964706`*^9}, 3.621466069260022*^9, {
   3.6214661323088217`*^9, 3.6214663392007747`*^9}, {3.6214664463178654`*^9, 
   3.621466558006203*^9}, {3.6214666206396947`*^9, 3.6214667916181498`*^9}, {
   3.6214668246686306`*^9, 3.621466830005435*^9}, {3.621466863193994*^9, 
   3.621466920441659*^9}, {3.6214669540295177`*^9, 3.621466955369484*^9}, {
   3.6214670358836927`*^9, 3.6214670361358433`*^9}, {3.621467075978162*^9, 
   3.6214671016924095`*^9}, {3.621467137331743*^9, 3.6214672657759686`*^9}, {
   3.621467305261015*^9, 3.6214674324003305`*^9}, {3.621467512588292*^9, 
   3.6214675536975007`*^9}, {3.6214681769302216`*^9, 
   3.6214681984084654`*^9}, {3.6214683059999075`*^9, 
   3.6214684127066927`*^9}, {3.621468454676038*^9, 3.6214685962065744`*^9}, {
   3.621468682682975*^9, 3.621468848962097*^9}, {3.6214689287817907`*^9, 
   3.62146898576727*^9}, {3.621469021246474*^9, 3.621469126657359*^9}, {
   3.6214691926579494`*^9, 3.6214693258665752`*^9}, {3.621469403655833*^9, 
   3.621469427557841*^9}, {3.621469466039147*^9, 3.621469575423877*^9}, {
   3.6214696763125143`*^9, 3.6214697981940994`*^9}, {3.621469898985692*^9, 
   3.621469951670144*^9}, {3.6214700175619354`*^9, 3.621470022682587*^9}, {
   3.6214700539947996`*^9, 3.6214700907048826`*^9}, {3.621470134880267*^9, 
   3.6214701816134586`*^9}, {3.6214702117969017`*^9, 3.621470226332221*^9}, {
   3.6214702944946704`*^9, 3.621470328389725*^9}, {3.621470367213301*^9, 
   3.6214704164432983`*^9}, {3.62147053047427*^9, 3.6214706103770347`*^9}, {
   3.621470656634917*^9, 3.62147100383595*^9}, {3.6214710994338455`*^9, 
   3.6214712377941422`*^9}, {3.621471307162419*^9, 3.6214714114124727`*^9}, {
   3.621471487771714*^9, 3.6214715497687535`*^9}, {3.6214716742382946`*^9, 
   3.621471709725532*^9}, {3.6214721903762665`*^9, 3.621472190775549*^9}, {
   3.6214722498755026`*^9, 3.6214723798894606`*^9}, {3.6214724103140793`*^9, 
   3.62147248931822*^9}, {3.621472529249559*^9, 3.6214726310318823`*^9}, {
   3.6214727099379053`*^9, 3.6214727287973304`*^9}, {3.6214727888103514`*^9, 
   3.6214727955241203`*^9}, {3.62147286557491*^9, 3.621473019753431*^9}, {
   3.6214730608235297`*^9, 3.6214730884031134`*^9}, {3.6214733646033416`*^9, 
   3.6214734005218277`*^9}, {3.621473448460881*^9, 3.62147361402652*^9}, {
   3.621473676724045*^9, 3.621473683588934*^9}, {3.6214748615771494`*^9, 
   3.62147495482039*^9}, {3.6214750736673117`*^9, 3.621475231421372*^9}, {
   3.6214752915590916`*^9, 3.621475362291336*^9}, {3.6214753923146634`*^9, 
   3.621475396409574*^9}, {3.6214754526154985`*^9, 3.6214754888022056`*^9}, 
   3.6214757561771336`*^9, {3.6214758089946537`*^9, 3.62147582652612*^9}, {
   3.6214758903294287`*^9, 3.6214759277910395`*^9}, {3.6214763393970995`*^9, 
   3.621476532143015*^9}, {3.6214765653812237`*^9, 3.6214766174992323`*^9}, {
   3.621476748803506*^9, 3.6214767849471807`*^9}, {3.621541899905279*^9, 
   3.621541921007269*^9}, 3.621541953271216*^9, 3.62154250845358*^9, {
   3.6215425503623333`*^9, 3.6215427319703503`*^9}, {3.621542843424508*^9, 
   3.6215428708259735`*^9}, {3.62154290960452*^9, 3.621542934847481*^9}, {
   3.621542978544493*^9, 3.6215430962791257`*^9}, {3.621543135295869*^9, 
   3.6215432335386324`*^9}, {3.621543328014738*^9, 3.6215435691340237`*^9}, {
   3.6215436401975036`*^9, 3.621543690349152*^9}, {3.621543722376874*^9, 
   3.6215437582493563`*^9}, {3.621543874235762*^9, 3.6215439125719795`*^9}, {
   3.621543983076062*^9, 3.6215440130023193`*^9}, {3.621544054546832*^9, 
   3.6215440585176573`*^9}, {3.621544144540759*^9, 3.6215441477490387`*^9}, 
   3.621544223294731*^9, 3.6215443593003144`*^9, {3.6215443999942493`*^9, 
   3.621544572723919*^9}, {3.62154460582246*^9, 3.6215449683301163`*^9}, {
   3.6215450363464375`*^9, 3.621545128124631*^9}, {3.6215451586473265`*^9, 
   3.6215452291834126`*^9}, {3.621545268947689*^9, 3.6215452870625567`*^9}, {
   3.6215453789087715`*^9, 3.6215455039055624`*^9}, {3.621545587804221*^9, 
   3.621545675969879*^9}, {3.621545786956696*^9, 3.6215457932201395`*^9}, {
   3.6215459899198656`*^9, 3.621546178441811*^9}, {3.621546216232656*^9, 
   3.621546286227353*^9}, {3.6215463801801047`*^9, 3.6215463974944153`*^9}, {
   3.621546495122737*^9, 3.6215465107698517`*^9}, {3.621546809301914*^9, 
   3.621546829599333*^9}, {3.6215469189878473`*^9, 3.621547018806509*^9}, {
   3.621547082732912*^9, 3.62154708325228*^9}, {3.621547233773693*^9, 
   3.621547257622633*^9}, {3.6215472957556934`*^9, 3.6215473938904023`*^9}, {
   3.621547438143838*^9, 3.6215474567080307`*^9}, {3.6215474903499517`*^9, 
   3.6215475192774863`*^9}, {3.6215475743776107`*^9, 3.621547608941164*^9}, {
   3.621547655846484*^9, 3.621547701563959*^9}, {3.6215479275665293`*^9, 
   3.621548006959897*^9}, {3.6215480945170937`*^9, 3.621548150131605*^9}, {
   3.6215481988702497`*^9, 3.62154847291689*^9}, {3.621548664323855*^9, 
   3.621548712268898*^9}, {3.6215487490280085`*^9, 3.6215488027832055`*^9}, {
   3.6215488605982637`*^9, 3.6215489827580404`*^9}, {3.6215490853409157`*^9, 
   3.6215491104421825`*^9}, {3.621549208870102*^9, 3.621549237522484*^9}, {
   3.6215492871807346`*^9, 3.6215494256030583`*^9}, {3.6215494561827807`*^9, 
   3.6215495189723883`*^9}, {3.621549550923078*^9, 3.621549565244258*^9}, {
   3.621549856370059*^9, 3.6215498566672935`*^9}, {3.621549982467811*^9, 
   3.6215500418259993`*^9}, {3.621550078057708*^9, 3.6215500995549784`*^9}, {
   3.621550135151268*^9, 3.6215502310854397`*^9}, {3.62155030448555*^9, 
   3.6215503154823627`*^9}, {3.6215515402523966`*^9, 3.6215515630876*^9}, {
   3.6215521058729753`*^9, 3.6215523345614424`*^9}, {3.6215524221046104`*^9, 
   3.621552493346224*^9}, {3.6215525294558697`*^9, 3.621552748083172*^9}, {
   3.621552909943162*^9, 3.62155309674086*^9}, {3.6215532621173153`*^9, 
   3.621553504078193*^9}, {3.621553554540062*^9, 3.6215536256575613`*^9}, {
   3.6215537168303223`*^9, 3.6215537479824567`*^9}, {3.621553826237039*^9, 
   3.621553826749404*^9}, {3.621553856773733*^9, 3.621553857171014*^9}, {
   3.6215539054302945`*^9, 3.6215539426157103`*^9}, {3.621553980917918*^9, 
   3.6215540475082207`*^9}, {3.6215541032197948`*^9, 3.621554125276491*^9}, {
   3.621554156377555*^9, 3.621554181031068*^9}, {3.6215542155495872`*^9, 
   3.6215542281605525`*^9}, {3.6215542665738335`*^9, 3.621554314217677*^9}, {
   3.6215543823510747`*^9, 3.6215545853533077`*^9}, {3.621554641734329*^9, 
   3.621554659447941*^9}, {3.6215547067335014`*^9, 3.6215548000187664`*^9}, {
   3.6215548364656563`*^9, 3.6215549218192883`*^9}, {3.6215550404705715`*^9, 
   3.621555134135106*^9}, {3.621555265205948*^9, 3.6215552655472193`*^9}, {
   3.62155531449396*^9, 3.6215554152105083`*^9}, {3.621555457010195*^9, 
   3.6215555031943827`*^9}, {3.62162187828401*^9, 3.621621939849612*^9}, {
   3.621621978975405*^9, 3.6216220413226924`*^9}, {3.6216221565295343`*^9, 
   3.6216222845294843`*^9}, {3.621622324973186*^9, 3.6216223591714764`*^9}, {
   3.6216224008000484`*^9, 3.6216224233050356`*^9}, {3.6216224712601285`*^9, 
   3.6216225003087344`*^9}, {3.621622544586195*^9, 3.6216225831445847`*^9}, {
   3.6216226524188147`*^9, 3.621622851636329*^9}, {3.6216229059979153`*^9, 
   3.621623129834939*^9}, {3.621623162895404*^9, 3.621623173360838*^9}, {
   3.6216232169988346`*^9, 3.6216232248294277`*^9}, {3.6216381624770813`*^9, 
   3.621638234560315*^9}, {3.6216382886837616`*^9, 3.6216383376645555`*^9}, {
   3.6216385106404295`*^9, 3.621638538394628*^9}, {3.621638720318829*^9, 
   3.6216388087396383`*^9}, {3.6216389370487823`*^9, 3.621639095798581*^9}, {
   3.6216391272398863`*^9, 3.6216392648360853`*^9}, {3.621639314306198*^9, 
   3.6216394881236687`*^9}, {3.621639586859808*^9, 3.6216396491390767`*^9}, {
   3.6216397276078005`*^9, 3.621639737494812*^9}, {3.6216397729730415`*^9, 
   3.621639774423072*^9}, 3.6216398213634157`*^9, {3.6216398547000723`*^9, 
   3.6216398639716825`*^9}, {3.6216402530217276`*^9, 3.621640293730631*^9}, {
   3.6216403279689455`*^9, 3.6216403906504774`*^9}, {3.6216404228563633`*^9, 
   3.6216404388246956`*^9}, {3.621640545276311*^9, 3.621640648243454*^9}, {
   3.6216406795416865`*^9, 3.6216407359247437`*^9}, {3.6216407699449043`*^9, 
   3.621640855574732*^9}, {3.621640888845368*^9, 3.6216409971693134`*^9}, {
   3.6216411064349327`*^9, 3.621641257300127*^9}, {3.6216412946966686`*^9, 
   3.621641340194981*^9}, {3.6216414404792185`*^9, 3.6216414567998185`*^9}, {
   3.6216415220431647`*^9, 3.621641556578691*^9}, {3.6216416057236176`*^9, 
   3.6216417030507374`*^9}, {3.6216418367157154`*^9, 3.621642025085498*^9}, {
   3.6216420884585133`*^9, 3.6216421481319294`*^9}, {3.621642194893118*^9, 
   3.621642386839469*^9}, {3.621642474233554*^9, 3.6216425221625967`*^9}, {
   3.6216425626243362`*^9, 3.6216425852183867`*^9}, {3.6216428596575584`*^9, 
   3.6216429238531585`*^9}, {3.6216429588390126`*^9, 
   3.6216430249439697`*^9}, {3.6216430894858227`*^9, 
   3.6216434100425234`*^9}, {3.6216436275980663`*^9, 3.621643919926721*^9}, {
   3.621644145885231*^9, 3.6216441484120255`*^9}, {3.621644187611873*^9, 
   3.621644232801978*^9}, {3.6216442875348663`*^9, 3.6216443979643126`*^9}, {
   3.6216444320025043`*^9, 3.6216445648858986`*^9}, {3.6216446436328225`*^9, 
   3.621644660918084*^9}, {3.6216448677650185`*^9, 3.6216449876021748`*^9}, {
   3.6216451662430463`*^9, 3.6216452484144335`*^9}, {3.621645280729377*^9, 
   3.6216453429876013`*^9}, {3.621645526858206*^9, 3.621645743549139*^9}, {
   3.621645831935919*^9, 3.621645935859748*^9}, {3.621645982905175*^9, 
   3.621646048345646*^9}, {3.62164617616144*^9, 3.6216462637136526`*^9}, {
   3.6216463110372643`*^9, 3.6216463923770294`*^9}, {3.621646454323062*^9, 
   3.621646514894059*^9}, {3.621646561086879*^9, 3.6216466284617386`*^9}, {
   3.621646671605381*^9, 3.621646854658411*^9}, {3.6216468847197657`*^9, 
   3.6216469112286015`*^9}, {3.621646947240176*^9, 3.6216469526810627`*^9}, {
   3.621646989886489*^9, 3.6216470788166623`*^9}, {3.6216471268027472`*^9, 
   3.6216472557243385`*^9}, {3.621647375809615*^9, 3.621647386923524*^9}, {
   3.621647563394863*^9, 3.6216475669824123`*^9}, {3.62164762009416*^9, 
   3.6216476993534603`*^9}, {3.6216477336658306`*^9, 3.621647757093481*^9}, {
   3.621647813670656*^9, 3.6216478623322196`*^9}, {3.6216807446545887`*^9, 
   3.62168075545426*^9}, {3.6216807994315286`*^9, 3.62168081838196*^9}, {
   3.621680895065447*^9, 3.621681005463854*^9}, {3.6216814120848627`*^9, 
   3.6216815083702297`*^9}, {3.6216892252074256`*^9, 3.62168925311625*^9}, {
   3.6217012665969367`*^9, 3.621701280333716*^9}, {3.6217016055681124`*^9, 
   3.621701626354901*^9}, 3.6217026209615545`*^9, {3.6217030119847646`*^9, 
   3.621703109815372*^9}, {3.6217032301679983`*^9, 3.6217034959901495`*^9}, {
   3.6217035716399593`*^9, 3.6217036076455765`*^9}, {3.6217036571127667`*^9, 
   3.6217041471864557`*^9}, {3.6217042345446043`*^9, 
   3.6217042633500986`*^9}, {3.6217043519061227`*^9, 
   3.6217045178621817`*^9}, {3.621704550272241*^9, 3.6217045813823814`*^9}, {
   3.6217046607498446`*^9, 3.621704693691283*^9}, {3.6217047555473104`*^9, 
   3.6217047927940884`*^9}, {3.6217048647242665`*^9, 
   3.6217049956013837`*^9}, {3.621705033032029*^9, 3.6217050377784233`*^9}, {
   3.6217050864510527`*^9, 3.621705089829427*^9}, {3.6217051304032936`*^9, 
   3.621705135749127*^9}, {3.6217053352980757`*^9, 3.6217053754516497`*^9}, {
   3.621705454607993*^9, 3.62170570399743*^9}, {3.621705735127557*^9, 
   3.621705790579032*^9}, {3.621705821510738*^9, 3.6217058221532*^9}, {
   3.621706759131115*^9, 3.6217067785909557`*^9}, {3.6217074211844735`*^9, 
   3.6217075537432175`*^9}, {3.6217076716090727`*^9, 3.621707711488475*^9}, {
   3.6217077670480056`*^9, 3.621707792027749*^9}, {3.621708490014925*^9, 
   3.621708553910386*^9}, {3.621708605722274*^9, 3.6217086070231752`*^9}, {
   3.6217086406751423`*^9, 3.6217087875596256`*^9}, {3.6217088677887087`*^9, 
   3.6217089591406994`*^9}, {3.621709020758559*^9, 3.6217090396139603`*^9}, {
   3.6217090923595123`*^9, 3.6217091295219297`*^9}, {3.6217091605359893`*^9, 
   3.621709218182004*^9}, {3.621709258996043*^9, 3.621709264402889*^9}, {
   3.6217093126161995`*^9, 3.621709318399313*^9}, {3.6217093578113585`*^9, 
   3.6217095243328333`*^9}, {3.6217095751860156`*^9, 
   3.6217096325318155`*^9}, {3.6217097021833677`*^9, 
   3.6217097178945503`*^9}, {3.621709835433202*^9, 3.6217098355002193`*^9}, {
   3.6217099318807955`*^9, 3.6217100359808903`*^9}, {3.6217100669398937`*^9, 
   3.621710070771613*^9}, {3.621710103765089*^9, 3.6217101655650587`*^9}, {
   3.621710201704772*^9, 3.6217102751660676`*^9}, {3.621710305783823*^9, 
   3.621710368022112*^9}, {3.6217103993343887`*^9, 3.6217104514074326`*^9}, {
   3.621764962592225*^9, 3.621765042457078*^9}, {3.6217707870759816`*^9, 
   3.621770809403872*^9}, {3.621770843627199*^9, 3.621770846271103*^9}, {
   3.6217711624710484`*^9, 3.621771164140237*^9}, {3.6217711995194387`*^9, 
   3.6217712108724923`*^9}, {3.621771274428713*^9, 3.621771274678914*^9}, 
   3.621771617377702*^9, 3.6217777645450735`*^9, {3.621777873959615*^9, 
   3.621777957572092*^9}, {3.621778012727337*^9, 3.6217780842972383`*^9}, {
   3.6217781844846992`*^9, 3.6217781915007195`*^9}, {3.6217784156911993`*^9, 
   3.6217784475298576`*^9}, {3.6217784934645357`*^9, 
   3.6217785027131443`*^9}, {3.6217785856811457`*^9, 3.621778623678186*^9}, {
   3.621778807875264*^9, 3.6217788881133533`*^9}, {3.6217789200470743`*^9, 
   3.6217789889550714`*^9}, {3.621779025119832*^9, 3.621779025674197*^9}, 
   3.6217791026179714`*^9, {3.6217792186565313`*^9, 3.621779243023869*^9}, {
   3.621779309740337*^9, 3.6217793425966854`*^9}, {3.621779386471931*^9, 
   3.621779441256886*^9}, {3.6217794714844165`*^9, 3.6217794722289457`*^9}, {
   3.6217795135993814`*^9, 3.6217795943138084`*^9}, {3.6217796286512394`*^9, 
   3.6217796711884747`*^9}, {3.6217797307308674`*^9, 
   3.6217797691381645`*^9}, {3.621779801273029*^9, 3.621779882691987*^9}, {
   3.6217803243799458`*^9, 3.6217803634914074`*^9}, {3.6217804133398695`*^9, 
   3.621780418725704*^9}, {3.621788911264947*^9, 3.621789001482136*^9}, {
   3.621789501762088*^9, 3.6217896537832236`*^9}, {3.6217898540657234`*^9, 
   3.621789870564461*^9}, {3.6217899015915313`*^9, 3.621789922031102*^9}, {
   3.6217900195854335`*^9, 3.621790124341954*^9}, {3.621790222584849*^9, 
   3.621790226791847*^9}, {3.6217902840385733`*^9, 3.621790284228725*^9}, {
   3.6217903178386264`*^9, 3.6217904195449915`*^9}, {3.6217904663572974`*^9, 
   3.6217904786030087`*^9}, {3.6217905744411974`*^9, 3.621790667975746*^9}, {
   3.6217907329649963`*^9, 3.6217908499032097`*^9}, {3.621791816633003*^9, 
   3.6217920142373962`*^9}, {3.621792107985099*^9, 3.621792125640684*^9}, 
   3.6217943195130343`*^9, {3.6217945051551332`*^9, 3.621794572149782*^9}, {
   3.621794615452591*^9, 3.621794833350623*^9}, {3.621795287495743*^9, 
   3.621795398898006*^9}, {3.6217976145616584`*^9, 3.621797659843875*^9}, {
   3.6217979248814487`*^9, 3.621797986238132*^9}, {3.6217981246536016`*^9, 
   3.6217981277267704`*^9}, {3.621798191980486*^9, 3.621798208882512*^9}, {
   3.621798263152151*^9, 3.6217983252753243`*^9}, {3.6217984337424965`*^9, 
   3.6217984545343103`*^9}, {3.6217986063012714`*^9, 3.621798627649468*^9}, {
   3.621799122338979*^9, 3.6217991461629295`*^9}, {3.6217993241435604`*^9, 
   3.6217993540878687`*^9}, {3.6217993961260557`*^9, 3.621799409969906*^9}, {
   3.6218087907663383`*^9, 3.621808855959752*^9}, {3.6218091063516207`*^9, 
   3.62180912258317*^9}, {3.621809169808087*^9, 3.621809169965195*^9}, {
   3.6218092144598675`*^9, 3.621809220191961*^9}, {3.6218093630395665`*^9, 
   3.621809440804308*^9}, {3.621809487987884*^9, 3.6218097089653945`*^9}, {
   3.6218097429335327`*^9, 3.6218097841698713`*^9}, {3.6218098487178283`*^9, 
   3.6218098972433233`*^9}, {3.621810456562273*^9, 3.6218105314405775`*^9}, {
   3.621810581276036*^9, 3.6218105863075857`*^9}, {3.621810619787407*^9, 
   3.6218107139123755`*^9}, {3.621810800980324*^9, 3.621810812746724*^9}, {
   3.621810964746501*^9, 3.62181099222305*^9}, {3.6218116154056835`*^9, 
   3.6218116464047675`*^9}, {3.621811762357237*^9, 3.6218117628105593`*^9}, {
   3.6218118000570602`*^9, 3.6218119070832076`*^9}, {3.621811945219341*^9, 
   3.6218119943192763`*^9}, {3.6218120359121995`*^9, 
   3.6218120846228867`*^9}, {3.621812212459813*^9, 3.6218122184230547`*^9}, {
   3.6218122957040424`*^9, 3.6218123022127*^9}, {3.621812389184551*^9, 
   3.621812605122495*^9}, {3.6218126732780166`*^9, 3.6218126737383456`*^9}, {
   3.621813040910555*^9, 3.6218130525748825`*^9}, 3.621813360068966*^9, {
   3.6218134016905775`*^9, 3.621813545179698*^9}, {3.6218136085557604`*^9, 
   3.621813616096126*^9}, {3.621813708216668*^9, 3.6218138311051197`*^9}, {
   3.6218138979816847`*^9, 3.621813975256665*^9}, {3.621814058270727*^9, 
   3.6218141017666745`*^9}, {3.621814142192444*^9, 3.6218141932877913`*^9}, {
   3.6218142392755127`*^9, 3.6218143515523996`*^9}, 3.621814384801051*^9, {
   3.6218144321927695`*^9, 3.6218144424250517`*^9}, {3.6218146044653416`*^9, 
   3.621814615051873*^9}, {3.621814655107402*^9, 3.6218148166446204`*^9}, {
   3.621814846999218*^9, 3.621814891328787*^9}, {3.621814955880684*^9, 
   3.6218149837064857`*^9}, {3.621815016591881*^9, 3.6218150683737216`*^9}, {
   3.6218151490431185`*^9, 3.621815217325981*^9}, {3.621815263432771*^9, 
   3.621815263897095*^9}}],

Cell[CellGroupData[{

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.621815217724265*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177252436`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.621815217726245*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177282467`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177292466`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177292466`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177302475`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.621815217731248*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.621815217732249*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177332497`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.62181521773425*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.62181521773425*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177352505`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177362514`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.621815217737252*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.621815217738253*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177392535`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177392535`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177402544`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177402544`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177412553`*^9}}],

Cell[BoxData["1.`"], "Print",
 CellChangeTimes->{{3.6218149627535753`*^9, 3.621814984302907*^9}, {
  3.6218150586227856`*^9, 3.621815068828045*^9}, {3.621815176188691*^9, 
  3.6218152177412553`*^9}}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0.4], DiskBox[{0, 0}, 0.5]}, CircleBox[{0, 0}], 
   CircleBox[{0, 0}, 1.1], CircleBox[{0, 0}, 1.2], CircleBox[{0, 0}, 1.3], 
   CircleBox[{0, 0}, 1.4], CircleBox[{0, 0}, 1.5], CircleBox[{0, 0}, 1.6], 
   CircleBox[{0, 0}, 1.7000000000000002`], CircleBox[{0, 0}, 1.8], 
   CircleBox[{0, 0}, 1.9], CircleBox[{0, 0}, 2.], 
   {RGBColor[1, 0, 0], PointSize[0.015], PointBox[CompressedData["
1:eJxTTMoPSmViYGAQB2IQffYMCDAcSAODT/ZvzRbyBej92g/j37xWx/nX6Aec
X/umy/Ox+jc43/uhZJU+xxc4v7k9TbP5zEc4f+5xaeaSi+/gfJ///6af7HkJ
5z/MuH5VKe0xnB9WduSn2oer6Hx7NPX2aObB+XMg9sH589D4TRD3wfnNaHyo
f+D8Goh/4fxaNP4tSPjA+e8g4Qfnl88OYNcQZ3VIgfIB06O5qw==
     "]]}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.019444444444444445`], AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxTTMoPSmViYGAQB2IQffYMCDAcSAODT/ZvzRbyBej92g/j37xWx/nX6Aec
X/umy/Ox+jc43/uhZJU+xxc4v7k9TbP5zEc4f+5xaeaSi+/gfJ///6af7HkJ
5z/MuH5VKe0xnB9WduSn2oer6Hx7NPX2aObB+XMg9sH589D4TRD3wfnNaHyo
f+D8Goh/4fxaNP4tSPjA+e8g4Qfnl88OYNcQZ3VIgfIB06O5qw==
       "]]}}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.019444444444444445`], AbsoluteThickness[1.6], 
      LineBox[{{0., 2.}, {0., -2.}}]}}, {}}},
  Frame->True]], "Output",
 CellChangeTimes->{{3.6218125805957384`*^9, 3.6218125952972193`*^9}, 
   3.6218126273613167`*^9, 3.6218137795294065`*^9, 3.621813975907143*^9, 
   3.6218141429639883`*^9, 3.6218141783361683`*^9, 3.6218142458702173`*^9, {
   3.6218143325158663`*^9, 3.6218143522108803`*^9}, 3.621814695050807*^9, {
   3.621814744112713*^9, 3.6218147614970818`*^9}, {3.6218148707411256`*^9, 
   3.6218148924215627`*^9}, {3.621814942579236*^9, 3.6218149843559456`*^9}, {
   3.6218150586808405`*^9, 3.621815068889104*^9}, {3.6218151762547393`*^9, 
   3.6218152177793007`*^9}}]
}, Open  ]]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.2 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 58619, 1219, 6367, "Input"],
Cell[CellGroupData[{
Cell[59224, 1245, 197, 3, 26, "Print"],
Cell[59424, 1250, 199, 3, 26, "Print"],
Cell[59626, 1255, 197, 3, 26, "Print"],
Cell[59826, 1260, 199, 3, 26, "Print"],
Cell[60028, 1265, 199, 3, 26, "Print"],
Cell[60230, 1270, 199, 3, 26, "Print"],
Cell[60432, 1275, 199, 3, 26, "Print"],
Cell[60634, 1280, 197, 3, 26, "Print"],
Cell[60834, 1285, 197, 3, 26, "Print"],
Cell[61034, 1290, 199, 3, 26, "Print"],
Cell[61236, 1295, 196, 3, 26, "Print"],
Cell[61435, 1300, 196, 3, 26, "Print"],
Cell[61634, 1305, 199, 3, 26, "Print"],
Cell[61836, 1310, 199, 3, 26, "Print"],
Cell[62038, 1315, 197, 3, 26, "Print"],
Cell[62238, 1320, 197, 3, 26, "Print"],
Cell[62438, 1325, 199, 3, 26, "Print"],
Cell[62640, 1330, 199, 3, 26, "Print"],
Cell[62842, 1335, 199, 3, 26, "Print"],
Cell[63044, 1340, 199, 3, 26, "Print"],
Cell[63246, 1345, 199, 3, 26, "Print"],
Cell[63448, 1350, 199, 3, 26, "Print"]
}, Open  ]],
Cell[63662, 1356, 1842, 31, 405, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
