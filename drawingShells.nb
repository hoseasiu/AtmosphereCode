(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     57519,       1219]
NotebookOptionsPosition[     57052,       1198]
NotebookOutlinePosition[     57429,       1214]
CellTagsIndexPosition[     57386,       1211]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Assumptions", ":", "\[IndentingNewLine]", " ", 
    RowBox[{
    "shells", " ", "are", " ", "located", " ", "around", " ", "the", " ", 
     "origin", "\[IndentingNewLine]", "light", " ", "rays", " ", "never", " ",
      "bend", " ", "more", " ", "than", " ", "90", " ", "degrees"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"shells", " ", "are", " ", "composed", " ", "of", " ", "the", " ", 
     RowBox[{"following", ":", " ", 
      RowBox[{"the", " ", "circle", " ", "graphic"}]}]}], ",", " ", 
    RowBox[{"the", " ", "circle", " ", "equation"}], ",", " ", 
    RowBox[{"the", " ", "circle", " ", "radius"}], ",", " ", 
    RowBox[{"the", " ", "n", " ", "value"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "more", " ", "will", " ", "be", " ", "added", " ", "to", " ", "shells", 
    " ", "as", " ", "we", " ", "get", " ", "into", " ", "physical", " ", 
    "properties"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Shell", "[", 
     RowBox[{"r_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "r"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], "==", 
       SuperscriptBox["r", "2"]}], ",", "r", ",", "n"}], "}"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ray", "[", 
    RowBox[{"point_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"y", "-", 
     RowBox[{"point", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"x", "-", 
       RowBox[{"point", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalAngle", "[", "point_", "]"}], ":=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{
     RowBox[{"point", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"point", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsPointReal", "[", "point_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "/.", "point"}], ")"}], "\[Element]", "Reals"}], "&&", 
     RowBox[{
      RowBox[{"(", " ", 
       RowBox[{"y", "/.", "point"}], ")"}], "\[Element]", "Reals"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SnellsLaw", "[", 
     RowBox[{"\[Theta]in_", ",", "nin_", ",", "nout_"}], "]"}], ":=", 
    RowBox[{"ArcSin", "[", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]in", "]"}], 
      RowBox[{"nin", "/", "nout"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "make", " ", "an", " ", "atmosphere", " ", "with", " ", "linearly"}], 
     "-", 
     RowBox[{
     "spaced", " ", "shells", " ", "specified", " ", "by", " ", "minimum"}]}],
     ",", " ", "maximum", ",", " ", 
    RowBox[{"and", " ", "step", " ", "size", " ", "of", " ", "radius"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphere", "[", 
    RowBox[{"min_", ",", "max_", ",", "step_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "center", ",", "nMax", ",", "nStep", ",", "n"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"atmosphere", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"TODO", " ", "-", " ", 
        RowBox[{
        "filling", " ", "in", " ", "dummy", " ", "n", " ", "values", " ", 
         "for", " ", "now"}], "-", " ", 
        RowBox[{
        "probably", " ", "make", " ", "a", " ", "function", " ", "to", " ", 
         "pull", " ", "from", " ", "actually", " ", "state", " ", "variables",
          " ", "to", " ", "calculate", " ", "n", " ", "values", " ", 
         "later"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"nMax", " ", "=", " ", "1.0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nStep", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"nMax", "-", "1."}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"max", "-", "min"}], ")"}], "/", "step"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", "=", " ", "1."}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"n", "+=", "nStep"}], ",", "\[IndentingNewLine]", 
          RowBox[{"atmosphere", " ", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"atmosphere", ",", 
             RowBox[{"Shell", "[", 
              RowBox[{"r", ",", "n"}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"r", ",", "min", ",", "max", ",", "step"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "the", " ", "graphics", " ", "objects"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphereGraphic", "[", "atm_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"atmosphere", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "atm", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeIntersectionsPointsGraphic", "[", "intersections_", "]"}], ":=", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Red", ",", 
       RowBox[{"Point", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "/.", 
             RowBox[{"intersections", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"y", "/.", 
             RowBox[{"intersections", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "intersections", "]"}]}], "}"}]}], "]"}], 
        "]"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindNextShellIntersection", "[", 
    RowBox[{"radius_", ",", "rayPosition_", ",", "rayAngle_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x0", ",", "y0", ",", "m", ",", "t1", ",", "t2", ",", "tList"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x0", " ", "=", " ", 
       RowBox[{"rayPosition", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y0", " ", "=", " ", 
       RowBox[{"rayPosition", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Tan", "[", "rayAngle", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "-", 
          RowBox[{"m", " ", "y0"}], " ", "+", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["radius", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["m", "2"]}], ")"}]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", 
               RowBox[{"m", " ", "x0"}]}], ")"}], "2"]}]]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["m", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "x0"}], "-", 
          RowBox[{"m", " ", "y0"}], " ", "-", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{
             SuperscriptBox["radius", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox["m", "2"]}], ")"}]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"y0", "-", 
               RowBox[{"m", " ", "x0"}]}], ")"}], "2"]}]]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["m", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "return", " ", "only", " ", "real", " ", "positive", " ", "time", " ", 
        "values"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tList", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"t1", ",", "t2"}], "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "\[Element]", "Reals"}], "&&", 
            RowBox[{"#", ">", "0"}]}], ")"}], "&"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "that", " ", "identifies", " ", "where", " ", "the", " ", 
    "light", " ", "currently", " ", "is", " ", "in", " ", "relation", " ", 
    "to", " ", "shells"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LocateLightRay", "[", 
    RowBox[{"position_", ",", "atm_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shellRadii", ",", "posRadius"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"shellRadii", " ", "=", " ", 
        RowBox[{"atm", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"posRadius", " ", "=", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"position", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"position", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "2"]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"entirely", " ", "outside", " ", "of", " ", "shells"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"posRadius", " ", ">", " ", 
          RowBox[{"Last", "[", "shellRadii", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rayLocation", " ", "=", " ", "\"\<outside\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "entirely", " ", "inside", " ", "the", " ", "inner", " ", "shell"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"posRadius", " ", "<", " ", 
          RowBox[{"First", "[", "shellRadii", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rayLocation", " ", "=", " ", "\"\<inside\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"on", " ", "outer", " ", "shell"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Last", "[", "shellRadii", "]"}], "\[Equal]", " ", 
          "posRadius"}], ",", "\[IndentingNewLine]", 
         RowBox[{"rayLocation", " ", "=", " ", "\"\<on outer shell\>\""}], 
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"on", " ", "some", " ", "non"}], "-", 
           RowBox[{"outer", " ", "shell"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"shellRadii", ",", "posRadius"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rayLocation", " ", "=", " ", "\"\<on\>\""}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"between", " ", "shells", " ", 
           RowBox[{"(", 
            RowBox[{"only", " ", "possible", " ", "remaining", " ", "case"}], 
            ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"shellRadii", ",", "posRadius"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rayLocation", " ", "=", " ", "\"\<between\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "updates", " ", "the", " ", "light", " ", "position", " ", "based", " ", 
     "on", " ", "current", " ", "position"}], ",", " ", "direction", ",", " ", 
    RowBox[{"and", " ", "shells"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", 
    RowBox[{
    "need", " ", "to", " ", "handle", " ", "the", " ", "case", " ", "where", 
     " ", 
     RowBox[{"it", "'"}], "s", " ", "at", " ", "the", " ", "end", " ", "of", 
     " ", "the", " ", "last", " ", "atmosphere", " ", "layer"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MoveLightRay", "[", 
    RowBox[{"ray_", ",", "rayOrigin_", ",", "rayAngle_", ",", "atm_"}], "]"}],
    ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "direction", ",", "checkShellNum", ",", "closestIntersect", ",", "sol", 
       ",", "location", ",", "currentShell", ",", "tList", ",", "intersect", 
       ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"position", " ", "=", " ", "rayOrigin"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"posRadius", " ", "=", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"position", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"position", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "2"]}]]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"location", "  ", "=", " ", 
       RowBox[{"LocateLightRay", "[", 
        RowBox[{"position", ",", "atm"}], "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
         "outermost", " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"location", " ", "\[Equal]", " ", 
         RowBox[{"{", "\"\<outside\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"FindNextShellIntersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "atm", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "position", ",", 
            "rayAngle"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
          "innermost", " ", "shell"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", 
         RowBox[{"{", "\"\<inside\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"FindNextShellIntersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "atm", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "position", ",", 
            "rayAngle"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "only", " ", "need", " ", "to", " ", "check", " ", "the", " ", 
           "second"}], "-", 
          RowBox[{"outermost", " ", "shell", " ", "unless", " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", "one"}], "-", 
          RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", 
         RowBox[{"{", "\"\<on outer shell\>\"", "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "atm", "]"}], ">", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", 
              RowBox[{"it", "'"}], "s", " ", "a", " ", "multi"}], "-", 
             RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"t", " ", "=", " ", 
            RowBox[{"Min", "[", 
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"-", "2"}], ",", "3"}], "]"}], "]"}], ",", 
               "position", ",", "rayAngle"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"else", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "a", " ", "single"}], "-", 
             RowBox[{"shell", " ", "atmosphere"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"t", " ", "=", " ", 
            RowBox[{"Min", "[", 
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", "position", ",", 
               "rayAngle"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "need", " ", "to", " ", "check", " ", "the", " ", "previous"}], ",",
           " ", "current", ",", " ", 
          RowBox[{"and", " ", "next", " ", "shells"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", 
         RowBox[{"{", "\"\<on\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"currentShell", " ", "=", " ", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"atm", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", "posRadius"}], 
            "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"t", " ", "=", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FindNextShellIntersection", "[", 
               RowBox[{
                RowBox[{"atm", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"currentShell", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
                   "3"}], "]"}], "]"}], ",", "position", ",", "rayAngle"}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FindNextShellIntersection", "[", 
               RowBox[{
                RowBox[{"atm", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"currentShell", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], 
                 "]"}], ",", "position", ",", "rayAngle"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"FindNextShellIntersection", "[", 
               RowBox[{
                RowBox[{"atm", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"currentShell", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}], ",", 
                   "3"}], "]"}], "]"}], ",", "position", ",", "rayAngle"}], 
               "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
            "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "need", " ", "to", " ", "check", " ", "the", " ", "shells", " ", 
           "that", " ", "it", " ", "is", " ", "between"}], "-", " ", 
          RowBox[{
          "now", " ", "use", " ", "currentShell", " ", "as", " ", "a", " ", 
           "counter"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"location", " ", "\[Equal]", " ", 
         RowBox[{"{", "\"\<between\>\"", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<atm between\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"currentShell", " ", "=", 
           RowBox[{"Length", "[", "atm", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"atm", "[", 
              RowBox[{"[", 
               RowBox[{"currentShell", ",", "3"}], "]"}], "]"}], " ", ">", 
             " ", "posRadius"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"currentShell", "-=", "1"}], ";"}]}], " ", 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"tList", " ", "=", " ", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{"currentShell", ",", "3"}], "]"}], "]"}], ",", 
               "position", ",", "rayAngle"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FindNextShellIntersection", "[", 
              RowBox[{
               RowBox[{"atm", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"currentShell", "+", "1"}], ",", "3"}], "]"}], 
                "]"}], ",", "position", ",", "rayAngle"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"t", "=", " ", 
           RowBox[{"Min", "[", "tList", "]"}]}]}], "\[IndentingNewLine]", 
         "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "stuff", " ", "to", " ", "be", " ", "done", " ", "regardless", " ", 
        "of", " ", "ray", " ", "location", " ", "case"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"non", "-", 
        RowBox[{"intersection", " ", "case"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", "\[Equal]", "Infinity"}], ",", "\[IndentingNewLine]", 
        RowBox[{"t", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "just", " ", "set", " ", "t", " ", "to", " ", "some", " ", "small", 
          " ", "value", " ", 
          RowBox[{"(", 
           RowBox[{
           "probably", " ", "adjust", " ", "to", " ", "fit", " ", "window", 
            " ", "size", " ", "later"}], " "}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"intersect", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"t", "+", 
          RowBox[{"position", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Tan", "[", "rayAngle", " ", "]"}], " ", "t"}], " ", "+", 
          " ", 
          RowBox[{"position", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"position", " ", "=", " ", "intersect"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"TODO", " ", "-", " ", 
        RowBox[{
        "also", " ", "output", " ", "the", " ", "shell", " ", "that", " ", 
         "it", " ", "is", " ", "currently", " ", "interacting", " ", 
         "with"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "position"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "get", " ", "the", " ", "n1", " ", "angle", " ", "needed", " ", "for", " ", 
    RowBox[{"Snell", "'"}], "s", " ", "Law", " ", "given", " ", "the", " ", 
    "ray", " ", "entry", " ", "and", " ", "the", " ", "shell"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Refract", "[", "angle_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Theta]1", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "hitting", " ", "shell", " ", "from", " ", "outside", " ", "in"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"position", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"TODO", " ", "-", " ", 
         RowBox[{
         "so", " ", "just", " ", "using", " ", "the", " ", "x", " ", "value", 
          " ", 
          RowBox[{"doesn", "'"}], "t", " ", "work", "\[IndentingNewLine]", 
          GraphicsBox[
           TagBox[RasterBox[CompressedData["
1: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
jWK/
             "], {{0, 86}, {151, 0}}, {0, 255},
             ColorFunction->RGBColor],
            BoxForm`ImageTag[
            "Byte", ColorSpace -> "RGB", Interleaving -> True],
            Selectable->False],
           BaseStyle->"ImageGraphics",
           ImageSize->{131.08333333333235`, Automatic},
           ImageSizeRaw->{151, 86},
           PlotRange->{{0, 151}, {0, 86}}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "use", " ", "a", " ", "lits", " ", "of", " ",
           "positions", " ", "instead"}]}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"TODO", " ", "-", " ", 
         RowBox[{"this", " ", "should", " ", "be", " ", "okay", " ", "now"}], 
         "-", " ", 
         RowBox[{
         "though", " ", "the", " ", "other", " ", "conditions", " ", "still", 
          " ", "need", " ", "to", " ", "be", " ", "tested"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"NormalAngle", "[", "position", "]"}], "-", "\[Pi]", "+", 
         RowBox[{"SnellsLaw", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", 
             RowBox[{"NormalAngle", "[", "position", "]"}], "+", "angle"}], 
            ")"}], ",", "1.", ",", "1.01"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "hitting", " ", "shell", " ", "from", " ", "inside", " ", "out"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"TODO", " ", "-", " ", 
         RowBox[{"figure", " ", "out", " ", "this", " ", "condition"}]}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"position", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"NormalAngle", "[", "position", "]"}], "-", 
         RowBox[{"SnellsLaw", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Pi]", "-", 
             RowBox[{"NormalAngle", "[", "position", "]"}], "-", "angle"}], 
            ")"}], ",", "1.", ",", "1.01"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "hitting", " ", "the", " ", "top", " ", "or", " ", "bottom", " ", 
          "of", " ", "a", " ", "shell"}], "-", " ", 
         RowBox[{"could", " ", "be", " ", "either", " ", "outside"}], "-", 
         RowBox[{"in", " ", "or", " ", "inside"}], "-", "out"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "TODO", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"position", " ", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"angle", "\[NotEqual]", " ", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<hit top of shell\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\[Theta]1", " ", "=", " ", 
              RowBox[{"Return", "[", 
               RowBox[{
                RowBox[{"\[Pi]", "/", "2"}], "-", 
                RowBox[{"Abs", "[", "angle", "]"}]}], "]"}]}], ","}], 
            "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
           RowBox[{"angle", " ", "\[Equal]", " ", "0"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<non-intersection case\>\"", "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"TODO", " ", "non"}], "-", 
           RowBox[{"intersecting", " ", "grazing", " ", "case"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"run", " ", "the", " ", "program", " ", "starting", " ", "here"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"origin", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.1"}], ",", "1.75"}], "}"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "origin", " ", "needs", " ", "to", " ", "be", " ", "specified", " ", "by", 
    " ", "doubles", " ", "rather", " ", "than", " ", "ints"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"angle", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lightRay", " ", "=", " ", 
    RowBox[{"Ray", "[", 
     RowBox[{"origin", ",", "angle"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intersectionPoints", " ", "=", " ", 
   RowBox[{"{", "origin", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"positions", " ", "=", " ", 
    RowBox[{"{", "origin", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeAtmosphere", "[", 
    RowBox[{"1", ",", "2", ",", "0.1"}], "]"}], ";"}], "\[IndentingNewLine]", 
  " ", 
  RowBox[{"(*", 
   RowBox[{"TODO", " ", "-", " ", "hack", " ", "-", " ", 
    RowBox[{
     RowBox[{"shouldn", "'"}], "t", " ", "need", " ", 
     RowBox[{"the", " ", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"intersectionPoints", ",", 
     RowBox[{"MoveLightRay", "[", 
      RowBox[{"lightRay", ",", "origin", ",", "angle", ",", "atmosphere"}], 
      "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"snell", "'"}], "s", " ", "law", " ", "stuff", " ", "starts", " ",
     "here"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"angle", "=", 
       RowBox[{"Refract", "[", "angle", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"intersectionPoints", ",", 
        RowBox[{"MoveLightRay", "[", 
         RowBox[{
          RowBox[{"Ray", "[", 
           RowBox[{"position", ",", "angle"}], "]"}], ",", "position", ",", 
          "angle", ",", "atmosphere"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"TODO", "-", " ", 
      RowBox[{
       RowBox[{"something", "'"}], "s", " ", "with", " ", "my", " ", 
       "angles"}]}], "..."}], " ", "probably", " ", "the", " ", "angle", " ", 
    "out", " ", "calculation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"graphics", " ", "stuff", " ", "starts", " ", "here"}], " ", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlutoGraphic", " ", "=", " ", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "0.5"}], "]"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"PlutoGraphic", ",", 
   RowBox[{"MakeAtmosphereGraphic", "[", "atmosphere", "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
      RowBox[{"Point", "[", "intersectionPoints", "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"ListLinePlot", "[", "intersectionPoints", "]"}], ",", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "2"}]}], "}"}]}], "}"}], "]"}], ",", 
   RowBox[{"Frame", "\[Rule]", " ", "True"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.621465705136365*^9, 3.6214657249554434`*^9}, {
   3.6214658420566463`*^9, 3.6214658727964706`*^9}, 3.621466069260022*^9, {
   3.6214661323088217`*^9, 3.6214663392007747`*^9}, {3.6214664463178654`*^9, 
   3.621466558006203*^9}, {3.6214666206396947`*^9, 3.6214667916181498`*^9}, {
   3.6214668246686306`*^9, 3.621466830005435*^9}, {3.621466863193994*^9, 
   3.621466920441659*^9}, {3.6214669540295177`*^9, 3.621466955369484*^9}, {
   3.6214670358836927`*^9, 3.6214670361358433`*^9}, {3.621467075978162*^9, 
   3.6214671016924095`*^9}, {3.621467137331743*^9, 3.6214672657759686`*^9}, {
   3.621467305261015*^9, 3.6214674324003305`*^9}, {3.621467512588292*^9, 
   3.6214675536975007`*^9}, {3.6214681769302216`*^9, 
   3.6214681984084654`*^9}, {3.6214683059999075`*^9, 
   3.6214684127066927`*^9}, {3.621468454676038*^9, 3.6214685962065744`*^9}, {
   3.621468682682975*^9, 3.621468848962097*^9}, {3.6214689287817907`*^9, 
   3.62146898576727*^9}, {3.621469021246474*^9, 3.621469126657359*^9}, {
   3.6214691926579494`*^9, 3.6214693258665752`*^9}, {3.621469403655833*^9, 
   3.621469427557841*^9}, {3.621469466039147*^9, 3.621469575423877*^9}, {
   3.6214696763125143`*^9, 3.6214697981940994`*^9}, {3.621469898985692*^9, 
   3.621469951670144*^9}, {3.6214700175619354`*^9, 3.621470022682587*^9}, {
   3.6214700539947996`*^9, 3.6214700907048826`*^9}, {3.621470134880267*^9, 
   3.6214701816134586`*^9}, {3.6214702117969017`*^9, 3.621470226332221*^9}, {
   3.6214702944946704`*^9, 3.621470328389725*^9}, {3.621470367213301*^9, 
   3.6214704164432983`*^9}, {3.62147053047427*^9, 3.6214706103770347`*^9}, {
   3.621470656634917*^9, 3.62147100383595*^9}, {3.6214710994338455`*^9, 
   3.6214712377941422`*^9}, {3.621471307162419*^9, 3.6214714114124727`*^9}, {
   3.621471487771714*^9, 3.6214715497687535`*^9}, {3.6214716742382946`*^9, 
   3.621471709725532*^9}, {3.6214721903762665`*^9, 3.621472190775549*^9}, {
   3.6214722498755026`*^9, 3.6214723798894606`*^9}, {3.6214724103140793`*^9, 
   3.62147248931822*^9}, {3.621472529249559*^9, 3.6214726310318823`*^9}, {
   3.6214727099379053`*^9, 3.6214727287973304`*^9}, {3.6214727888103514`*^9, 
   3.6214727955241203`*^9}, {3.62147286557491*^9, 3.621473019753431*^9}, {
   3.6214730608235297`*^9, 3.6214730884031134`*^9}, {3.6214733646033416`*^9, 
   3.6214734005218277`*^9}, {3.621473448460881*^9, 3.62147361402652*^9}, {
   3.621473676724045*^9, 3.621473683588934*^9}, {3.6214748615771494`*^9, 
   3.62147495482039*^9}, {3.6214750736673117`*^9, 3.621475231421372*^9}, {
   3.6214752915590916`*^9, 3.621475362291336*^9}, {3.6214753923146634`*^9, 
   3.621475396409574*^9}, {3.6214754526154985`*^9, 3.6214754888022056`*^9}, 
   3.6214757561771336`*^9, {3.6214758089946537`*^9, 3.62147582652612*^9}, {
   3.6214758903294287`*^9, 3.6214759277910395`*^9}, {3.6214763393970995`*^9, 
   3.621476532143015*^9}, {3.6214765653812237`*^9, 3.6214766174992323`*^9}, {
   3.621476748803506*^9, 3.6214767849471807`*^9}, {3.621541899905279*^9, 
   3.621541921007269*^9}, 3.621541953271216*^9, 3.62154250845358*^9, {
   3.6215425503623333`*^9, 3.6215427319703503`*^9}, {3.621542843424508*^9, 
   3.6215428708259735`*^9}, {3.62154290960452*^9, 3.621542934847481*^9}, {
   3.621542978544493*^9, 3.6215430962791257`*^9}, {3.621543135295869*^9, 
   3.6215432335386324`*^9}, {3.621543328014738*^9, 3.6215435691340237`*^9}, {
   3.6215436401975036`*^9, 3.621543690349152*^9}, {3.621543722376874*^9, 
   3.6215437582493563`*^9}, {3.621543874235762*^9, 3.6215439125719795`*^9}, {
   3.621543983076062*^9, 3.6215440130023193`*^9}, {3.621544054546832*^9, 
   3.6215440585176573`*^9}, {3.621544144540759*^9, 3.6215441477490387`*^9}, 
   3.621544223294731*^9, 3.6215443593003144`*^9, {3.6215443999942493`*^9, 
   3.621544572723919*^9}, {3.62154460582246*^9, 3.6215449683301163`*^9}, {
   3.6215450363464375`*^9, 3.621545128124631*^9}, {3.6215451586473265`*^9, 
   3.6215452291834126`*^9}, {3.621545268947689*^9, 3.6215452870625567`*^9}, {
   3.6215453789087715`*^9, 3.6215455039055624`*^9}, {3.621545587804221*^9, 
   3.621545675969879*^9}, {3.621545786956696*^9, 3.6215457932201395`*^9}, {
   3.6215459899198656`*^9, 3.621546178441811*^9}, {3.621546216232656*^9, 
   3.621546286227353*^9}, {3.6215463801801047`*^9, 3.6215463974944153`*^9}, {
   3.621546495122737*^9, 3.6215465107698517`*^9}, {3.621546809301914*^9, 
   3.621546829599333*^9}, {3.6215469189878473`*^9, 3.621547018806509*^9}, {
   3.621547082732912*^9, 3.62154708325228*^9}, {3.621547233773693*^9, 
   3.621547257622633*^9}, {3.6215472957556934`*^9, 3.6215473938904023`*^9}, {
   3.621547438143838*^9, 3.6215474567080307`*^9}, {3.6215474903499517`*^9, 
   3.6215475192774863`*^9}, {3.6215475743776107`*^9, 3.621547608941164*^9}, {
   3.621547655846484*^9, 3.621547701563959*^9}, {3.6215479275665293`*^9, 
   3.621548006959897*^9}, {3.6215480945170937`*^9, 3.621548150131605*^9}, {
   3.6215481988702497`*^9, 3.62154847291689*^9}, {3.621548664323855*^9, 
   3.621548712268898*^9}, {3.6215487490280085`*^9, 3.6215488027832055`*^9}, {
   3.6215488605982637`*^9, 3.6215489827580404`*^9}, {3.6215490853409157`*^9, 
   3.6215491104421825`*^9}, {3.621549208870102*^9, 3.621549237522484*^9}, {
   3.6215492871807346`*^9, 3.6215494256030583`*^9}, {3.6215494561827807`*^9, 
   3.6215495189723883`*^9}, {3.621549550923078*^9, 3.621549565244258*^9}, {
   3.621549856370059*^9, 3.6215498566672935`*^9}, {3.621549982467811*^9, 
   3.6215500418259993`*^9}, {3.621550078057708*^9, 3.6215500995549784`*^9}, {
   3.621550135151268*^9, 3.6215502310854397`*^9}, {3.62155030448555*^9, 
   3.6215503154823627`*^9}, {3.6215515402523966`*^9, 3.6215515630876*^9}, {
   3.6215521058729753`*^9, 3.6215523345614424`*^9}, {3.6215524221046104`*^9, 
   3.621552493346224*^9}, {3.6215525294558697`*^9, 3.621552748083172*^9}, {
   3.621552909943162*^9, 3.62155309674086*^9}, {3.6215532621173153`*^9, 
   3.621553504078193*^9}, {3.621553554540062*^9, 3.6215536256575613`*^9}, {
   3.6215537168303223`*^9, 3.6215537479824567`*^9}, {3.621553826237039*^9, 
   3.621553826749404*^9}, {3.621553856773733*^9, 3.621553857171014*^9}, {
   3.6215539054302945`*^9, 3.6215539426157103`*^9}, {3.621553980917918*^9, 
   3.6215540475082207`*^9}, {3.6215541032197948`*^9, 3.621554125276491*^9}, {
   3.621554156377555*^9, 3.621554181031068*^9}, {3.6215542155495872`*^9, 
   3.6215542281605525`*^9}, {3.6215542665738335`*^9, 3.621554314217677*^9}, {
   3.6215543823510747`*^9, 3.6215545853533077`*^9}, {3.621554641734329*^9, 
   3.621554659447941*^9}, {3.6215547067335014`*^9, 3.6215548000187664`*^9}, {
   3.6215548364656563`*^9, 3.6215549218192883`*^9}, {3.6215550404705715`*^9, 
   3.621555134135106*^9}, {3.621555265205948*^9, 3.6215552655472193`*^9}, {
   3.62155531449396*^9, 3.6215554152105083`*^9}, {3.621555457010195*^9, 
   3.6215555031943827`*^9}, {3.62162187828401*^9, 3.621621939849612*^9}, {
   3.621621978975405*^9, 3.6216220413226924`*^9}, {3.6216221565295343`*^9, 
   3.6216222845294843`*^9}, {3.621622324973186*^9, 3.6216223591714764`*^9}, {
   3.6216224008000484`*^9, 3.6216224233050356`*^9}, {3.6216224712601285`*^9, 
   3.6216225003087344`*^9}, {3.621622544586195*^9, 3.6216225831445847`*^9}, {
   3.6216226524188147`*^9, 3.621622851636329*^9}, {3.6216229059979153`*^9, 
   3.621623129834939*^9}, {3.621623162895404*^9, 3.621623173360838*^9}, {
   3.6216232169988346`*^9, 3.6216232248294277`*^9}, {3.6216381624770813`*^9, 
   3.621638234560315*^9}, {3.6216382886837616`*^9, 3.6216383376645555`*^9}, {
   3.6216385106404295`*^9, 3.621638538394628*^9}, {3.621638720318829*^9, 
   3.6216388087396383`*^9}, {3.6216389370487823`*^9, 3.621639095798581*^9}, {
   3.6216391272398863`*^9, 3.6216392648360853`*^9}, {3.621639314306198*^9, 
   3.6216394881236687`*^9}, {3.621639586859808*^9, 3.6216396491390767`*^9}, {
   3.6216397276078005`*^9, 3.621639737494812*^9}, {3.6216397729730415`*^9, 
   3.621639774423072*^9}, 3.6216398213634157`*^9, {3.6216398547000723`*^9, 
   3.6216398639716825`*^9}, {3.6216402530217276`*^9, 3.621640293730631*^9}, {
   3.6216403279689455`*^9, 3.6216403906504774`*^9}, {3.6216404228563633`*^9, 
   3.6216404388246956`*^9}, {3.621640545276311*^9, 3.621640648243454*^9}, {
   3.6216406795416865`*^9, 3.6216407359247437`*^9}, {3.6216407699449043`*^9, 
   3.621640855574732*^9}, {3.621640888845368*^9, 3.6216409971693134`*^9}, {
   3.6216411064349327`*^9, 3.621641257300127*^9}, {3.6216412946966686`*^9, 
   3.621641340194981*^9}, {3.6216414404792185`*^9, 3.6216414567998185`*^9}, {
   3.6216415220431647`*^9, 3.621641556578691*^9}, {3.6216416057236176`*^9, 
   3.6216417030507374`*^9}, {3.6216418367157154`*^9, 3.621642025085498*^9}, {
   3.6216420884585133`*^9, 3.6216421481319294`*^9}, {3.621642194893118*^9, 
   3.621642386839469*^9}, {3.621642474233554*^9, 3.6216425221625967`*^9}, {
   3.6216425626243362`*^9, 3.6216425852183867`*^9}, {3.6216428596575584`*^9, 
   3.6216429238531585`*^9}, {3.6216429588390126`*^9, 
   3.6216430249439697`*^9}, {3.6216430894858227`*^9, 
   3.6216434100425234`*^9}, {3.6216436275980663`*^9, 3.621643919926721*^9}, {
   3.621644145885231*^9, 3.6216441484120255`*^9}, {3.621644187611873*^9, 
   3.621644232801978*^9}, {3.6216442875348663`*^9, 3.6216443979643126`*^9}, {
   3.6216444320025043`*^9, 3.6216445648858986`*^9}, {3.6216446436328225`*^9, 
   3.621644660918084*^9}, {3.6216448677650185`*^9, 3.6216449876021748`*^9}, {
   3.6216451662430463`*^9, 3.6216452484144335`*^9}, {3.621645280729377*^9, 
   3.6216453429876013`*^9}, {3.621645526858206*^9, 3.621645743549139*^9}, {
   3.621645831935919*^9, 3.621645935859748*^9}, {3.621645982905175*^9, 
   3.621646048345646*^9}, {3.62164617616144*^9, 3.6216462637136526`*^9}, {
   3.6216463110372643`*^9, 3.6216463923770294`*^9}, {3.621646454323062*^9, 
   3.621646514894059*^9}, {3.621646561086879*^9, 3.6216466284617386`*^9}, {
   3.621646671605381*^9, 3.621646854658411*^9}, {3.6216468847197657`*^9, 
   3.6216469112286015`*^9}, {3.621646947240176*^9, 3.6216469526810627`*^9}, {
   3.621646989886489*^9, 3.6216470788166623`*^9}, {3.6216471268027472`*^9, 
   3.6216472557243385`*^9}, {3.621647375809615*^9, 3.621647386923524*^9}, {
   3.621647563394863*^9, 3.6216475669824123`*^9}, {3.62164762009416*^9, 
   3.6216476993534603`*^9}, {3.6216477336658306`*^9, 3.621647757093481*^9}, {
   3.621647813670656*^9, 3.6216478623322196`*^9}, {3.6216807446545887`*^9, 
   3.62168075545426*^9}, {3.6216807994315286`*^9, 3.62168081838196*^9}, {
   3.621680895065447*^9, 3.621681005463854*^9}, {3.6216814120848627`*^9, 
   3.6216815083702297`*^9}, {3.6216892252074256`*^9, 3.62168925311625*^9}, {
   3.6217012665969367`*^9, 3.621701280333716*^9}, {3.6217016055681124`*^9, 
   3.621701626354901*^9}, 3.6217026209615545`*^9, {3.6217030119847646`*^9, 
   3.621703109815372*^9}, {3.6217032301679983`*^9, 3.6217034959901495`*^9}, {
   3.6217035716399593`*^9, 3.6217036076455765`*^9}, {3.6217036571127667`*^9, 
   3.6217041471864557`*^9}, {3.6217042345446043`*^9, 
   3.6217042633500986`*^9}, {3.6217043519061227`*^9, 
   3.6217045178621817`*^9}, {3.621704550272241*^9, 3.6217045813823814`*^9}, {
   3.6217046607498446`*^9, 3.621704693691283*^9}, {3.6217047555473104`*^9, 
   3.6217047927940884`*^9}, {3.6217048647242665`*^9, 
   3.6217049956013837`*^9}, {3.621705033032029*^9, 3.6217050377784233`*^9}, {
   3.6217050864510527`*^9, 3.621705089829427*^9}, {3.6217051304032936`*^9, 
   3.621705135749127*^9}, {3.6217053352980757`*^9, 3.6217053754516497`*^9}, {
   3.621705454607993*^9, 3.62170570399743*^9}, {3.621705735127557*^9, 
   3.621705790579032*^9}, {3.621705821510738*^9, 3.6217058221532*^9}, {
   3.621706759131115*^9, 3.6217067785909557`*^9}, {3.6217074211844735`*^9, 
   3.6217075537432175`*^9}, {3.6217076716090727`*^9, 3.621707711488475*^9}, {
   3.6217077670480056`*^9, 3.621707792027749*^9}, {3.621708490014925*^9, 
   3.621708553910386*^9}, {3.621708605722274*^9, 3.6217086070231752`*^9}, {
   3.6217086406751423`*^9, 3.6217087875596256`*^9}, {3.6217088677887087`*^9, 
   3.6217089591406994`*^9}, {3.621709020758559*^9, 3.6217090396139603`*^9}, {
   3.6217090923595123`*^9, 3.6217091295219297`*^9}, {3.6217091605359893`*^9, 
   3.621709218182004*^9}, {3.621709258996043*^9, 3.621709264402889*^9}, {
   3.6217093126161995`*^9, 3.621709318399313*^9}, {3.6217093578113585`*^9, 
   3.6217095243328333`*^9}, {3.6217095751860156`*^9, 
   3.6217096325318155`*^9}, {3.6217097021833677`*^9, 
   3.6217097178945503`*^9}, {3.621709835433202*^9, 3.6217098355002193`*^9}, {
   3.6217099318807955`*^9, 3.6217100359808903`*^9}, {3.6217100669398937`*^9, 
   3.621710070771613*^9}, {3.621710103765089*^9, 3.6217101655650587`*^9}, {
   3.621710201704772*^9, 3.6217102751660676`*^9}, {3.621710305783823*^9, 
   3.621710368022112*^9}, {3.6217103993343887`*^9, 3.6217104514074326`*^9}, {
   3.621764962592225*^9, 3.621765042457078*^9}, {3.6217707870759816`*^9, 
   3.621770809403872*^9}, {3.621770843627199*^9, 3.621770846271103*^9}, {
   3.6217711624710484`*^9, 3.621771164140237*^9}, {3.6217711995194387`*^9, 
   3.6217712108724923`*^9}, {3.621771274428713*^9, 3.621771274678914*^9}, 
   3.621771617377702*^9, 3.6217777645450735`*^9, {3.621777873959615*^9, 
   3.621777957572092*^9}, {3.621778012727337*^9, 3.6217780842972383`*^9}, {
   3.6217781844846992`*^9, 3.6217781915007195`*^9}, {3.6217784156911993`*^9, 
   3.6217784475298576`*^9}, {3.6217784934645357`*^9, 
   3.6217785027131443`*^9}, {3.6217785856811457`*^9, 3.621778623678186*^9}, {
   3.621778807875264*^9, 3.6217788881133533`*^9}, {3.6217789200470743`*^9, 
   3.6217789889550714`*^9}, {3.621779025119832*^9, 3.621779025674197*^9}, 
   3.6217791026179714`*^9, {3.6217792186565313`*^9, 3.621779243023869*^9}, {
   3.621779309740337*^9, 3.6217793425966854`*^9}, {3.621779386471931*^9, 
   3.621779441256886*^9}, {3.6217794714844165`*^9, 3.6217794722289457`*^9}, {
   3.6217795135993814`*^9, 3.6217795943138084`*^9}, {3.6217796286512394`*^9, 
   3.6217796711884747`*^9}, {3.6217797307308674`*^9, 
   3.6217797691381645`*^9}, {3.621779801273029*^9, 3.621779882691987*^9}, {
   3.6217803243799458`*^9, 3.6217803634914074`*^9}, {3.6217804133398695`*^9, 
   3.621780418725704*^9}, {3.6217809021376505`*^9, 3.621780914829703*^9}, {
   3.621783347042152*^9, 3.6217833544234085`*^9}, {3.621783506008255*^9, 
   3.6217835834839487`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"atm between\"\>"], "Print",
 CellChangeTimes->{3.621783584745826*^9}],

Cell[BoxData["\<\"atm between\"\>"], "Print",
 CellChangeTimes->{3.621783584745826*^9}]
}, Open  ]],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0.4], DiskBox[{0, 0}, 0.5]}, CircleBox[{0, 0}], 
   CircleBox[{0, 0}, 1.1], CircleBox[{0, 0}, 1.2], CircleBox[{0, 0}, 1.3], 
   CircleBox[{0, 0}, 1.4], CircleBox[{0, 0}, 1.5], CircleBox[{0, 0}, 1.6], 
   CircleBox[{0, 0}, 1.7000000000000002`], CircleBox[{0, 0}, 1.8], 
   CircleBox[{0, 0}, 1.9], CircleBox[{0, 0}, 2.], 
   {RGBColor[1, 0, 0], PointSize[0.015], 
    PointBox[{{-2.1, 1.75}, {-0.9682458365518543, 1.75}, {-0.7490018554336263,
      1.7461375147899965`}, {-0.7490018554336262, 
     1.7461375147899965`}, {-0.7490018554336261, 
     1.7461375147899965`}, {-0.7490018554336259, 
     1.7461375147899965`}, {-0.5186979069973017, 
     1.7236451146557459`}, {-0.5186979069973016, 
     1.7236451146557459`}, {-0.5186979069973011, 
     1.7236451146557459`}, {-0.518697906997301, 
     1.7236451146557459`}, {-0.5186979069973008, 
     1.7236451146557459`}, {-0.28562507898706346`, 1.6758336177119835`}, {
     0.04550209211436024, 1.5993528565057857`}, {0.04550209211436086, 
     1.599352856505786}, {0.3243070072826456, 1.6687794836428733`}, {
     0.7136601295897268, 1.652479718312444}, {0.7136601295897272, 
     1.652479718312444}, {0.952478014275045, 
     1.6440150949193462`}}]}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.019444444444444445`], AbsoluteThickness[1.6], 
      LineBox[{{-2.1, 1.75}, {-0.9682458365518543, 
       1.75}, {-0.7490018554336263, 
       1.7461375147899965`}, {-0.7490018554336262, 
       1.7461375147899965`}, {-0.7490018554336261, 
       1.7461375147899965`}, {-0.7490018554336259, 
       1.7461375147899965`}, {-0.5186979069973017, 
       1.7236451146557459`}, {-0.5186979069973016, 
       1.7236451146557459`}, {-0.5186979069973011, 
       1.7236451146557459`}, {-0.518697906997301, 
       1.7236451146557459`}, {-0.5186979069973008, 
       1.7236451146557459`}, {-0.28562507898706346`, 1.6758336177119835`}, {
       0.04550209211436024, 1.5993528565057857`}, {0.04550209211436086, 
       1.599352856505786}, {0.3243070072826456, 1.6687794836428733`}, {
       0.7136601295897268, 1.652479718312444}, {0.7136601295897272, 
       1.652479718312444}, {0.952478014275045, 
       1.6440150949193462`}}]}}, {}}, {{}, {{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.019444444444444445`], AbsoluteThickness[1.6], 
      LineBox[{{0., 2.}, {0., -2.}}]}}, {}}},
  Frame->True]], "Output",
 CellChangeTimes->{3.6217835847788563`*^9}]
}, Open  ]]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 53745, 1117, 6695, "Input"],
Cell[CellGroupData[{
Cell[54350, 1143, 87, 1, 32, "Print"],
Cell[54440, 1146, 87, 1, 32, "Print"]
}, Open  ]],
Cell[54542, 1150, 2494, 45, 581, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
