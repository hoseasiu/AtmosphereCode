(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31456,        758]
NotebookOptionsPosition[     31048,        740]
NotebookOutlinePosition[     31393,        755]
CellTagsIndexPosition[     31350,        752]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"startTime", "=", 
    RowBox[{"SessionTime", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TOL", " ", "=", " ", 
   RowBox[{"10", "^", 
    RowBox[{"-", "8"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"plutoRadius", " ", "=", " ", "1195000`64"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"radius", " ", "in", " ", "meters"}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "physical", " ", "constants", " ", "with", " ", "increased", " ", 
    "arbitrary", " ", "precision", " ", "in", " ", "mks", " ", "units"}], 
   "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NAvagadro", " ", "=", " ", 
    RowBox[{"6.02214129`64", "*", 
     RowBox[{"10", "^", "23"}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Avagadro", "'"}], "s", " ", "number"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", "=", " ", "8.3144621`64"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"J", "/", "mol"}], " ", "K"}], ";", " ", 
    RowBox[{"universal", " ", "gas", " ", "constant"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"k", " ", "=", " ", 
    RowBox[{"1.3806488`64", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "23"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"m", "^", "2"}], 
     RowBox[{"kgs", "^", 
      RowBox[{"-", "2"}]}], 
     RowBox[{"K", "^", 
      RowBox[{"-", "1"}]}]}], ";", " ", 
    RowBox[{"Boltzmann", " ", "constant"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"G", " ", "=", " ", 
    RowBox[{"6.67384`64", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "11"}]}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"universal", " ", "gravitational", " ", "constant"}], " ", "*)"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]N2", " ", "=", "  ", 
    RowBox[{"1.71`64", "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "30"}]}]}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"m", "^", "3"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"mean", " ", "polarizability", " ", "of", " ", 
       SubscriptBox["N", "2"], " ", "gas", " ", 
       RowBox[{"http", ":"}]}], "//", 
      RowBox[{
       RowBox[{"cccbdb", ".", "nist", ".", "gov"}], "/", 
       RowBox[{"exp2", ".", 
        RowBox[{"asp", "?", "casno"}]}]}]}], "=", "7727379"}]}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]N2", " ", "=", " ", "0.0280134`64"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"kg", ";", " ", 
    RowBox[{"molar", " ", "mass", " ", "of", " ", 
     SubscriptBox["N", "2"]}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"assumed", " ", "properties", " ", "of", " ", "Pluto"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"p0", " ", "=", " ", "0.3`64"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"N", "/", 
     RowBox[{"m", "^", "2"}]}], ";", " ", 
    RowBox[{
     RowBox[{
     "assumed", " ", "surface", " ", "pressure", " ", "of", " ", "Pluto"}], 
     " ", "\[Equal]", " ", 
     RowBox[{"3", " ", "microbars"}]}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"T", " ", "=", " ", "50.`64"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"K", ";", " ", 
    RowBox[{
    "assumed", " ", "atmospheric", " ", "temperature", " ", "for", " ", 
     "isothermal", " ", "model"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MPluto", " ", "=", " ", 
    RowBox[{"1.29`64", "*", 
     RowBox[{"10", "^", "22"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"kg", ";", " ", 
    RowBox[{"mass", " ", "of", " ", "Pluto"}]}], " ", "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"distToObserver", " ", "=", " ", "\n", "  ", 
    RowBox[{"5`64", "*", 
     RowBox[{"10", "^", "12"}]}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"TODO", " ", "-", " ", 
     RowBox[{
     "average", " ", "Pluto", " ", "distance", " ", "from", " ", "Earth", " ",
       "in", " ", "m"}]}], " ", "=", " ", 
    RowBox[{"5", "*", 
     RowBox[{"10", "^", "12"}]}]}], " ", "*)"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "the", " ", "atmosphere"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"layers", " ", "=", " ", "100"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"atmMin", " ", "=", " ", "plutoRadius"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"atmMax", " ", "=", " ", "1500000`64"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"atmStep", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"atmMax", " ", "-", " ", "atmMin"}], ")"}], "/", "layers"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "local", " ", "gravity", " ", "as", " ", "a", " ", "function", " ", "of", 
    " ", "r"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gravity", "[", 
     RowBox[{"r_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"G", "*", 
     RowBox[{"M", "/", 
      RowBox[{"r", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"barometric", " ", "formula"}], "-", 
    RowBox[{
    "pressure", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
     "height"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Barometric", "[", 
     RowBox[{
     "p0_", ",", "M_", ",", "h_", ",", "T_", ",", "r0_", ",", "Mplanet_"}], 
     "]"}], ":=", 
    RowBox[{"p0", " ", 
     RowBox[{"E", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M"}], " ", 
          RowBox[{"Gravity", "[", 
           RowBox[{
            RowBox[{"h", "+", "r0"}], ",", "Mplanet"}], "]"}], " ", "h"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"R", " ", "T"}], ")"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetAtmProperty", "[", 
     RowBox[{"startValue_", ",", "stopValue_", ",", "numShells_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"startValue", "\[Equal]", "stopValue"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"no", " ", "variation"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"startValue", ",", "numShells"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"linear", " ", "variation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Range", "[", 
         RowBox[{"startValue", ",", "stopValue", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"stopValue", "-", "startValue"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"numShells", "-", "1"}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SlopeInterceptFrom2Pts", "[", 
    RowBox[{"x1_", ",", "y1_", ",", "x2_", ",", "y2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y1", "-", "y2"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"y1", "-", 
        RowBox[{"m", " ", "x1"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"m", ",", "b"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6287236628334637`*^9, 3.628723667698938*^9}, {
   3.6287237853814445`*^9, 3.6287238229042997`*^9}, {3.6287238745009127`*^9, 
   3.6287238936985054`*^9}, {3.6287240220336*^9, 3.6287240561668205`*^9}, {
   3.6287242933481236`*^9, 3.6287242939205065`*^9}, {3.628724334689458*^9, 
   3.628724340788787*^9}, {3.6287244743455567`*^9, 3.6287245557362833`*^9}, {
   3.6287246169737425`*^9, 3.6287246354638643`*^9}, {3.6287247558182573`*^9, 
   3.6287247665238843`*^9}, {3.6287255613704*^9, 3.6287255829377193`*^9}, {
   3.6287257325398664`*^9, 3.6287258347864213`*^9}, {3.6287260179767466`*^9, 
   3.6287260233685656`*^9}, {3.62872694143425*^9, 3.628726959020729*^9}, {
   3.628727037335637*^9, 3.628727045220256*^9}, {3.6294742627265*^9, 
   3.6294743286402936`*^9}, {3.6294743755315437`*^9, 3.629474384663025*^9}, {
   3.629474439798169*^9, 3.6294745719704027`*^9}, {3.6294746127714353`*^9, 
   3.6294746983521347`*^9}, {3.6294750037938733`*^9, 
   3.6294750273766265`*^9}, {3.629475295476877*^9, 3.629475312597025*^9}, {
   3.629476497606343*^9, 3.6294765203614926`*^9}, 3.6294765725125246`*^9, 
   3.629476606028306*^9, {3.62947667911814*^9, 3.6294767382481008`*^9}, {
   3.62947754386133*^9, 3.6294775542136765`*^9}, {3.6294777647680717`*^9, 
   3.629477779885798*^9}, {3.6294785038773737`*^9, 3.62947851500527*^9}, {
   3.6294788890166597`*^9, 3.6294789014084563`*^9}, {3.629555582982427*^9, 
   3.6295556076619606`*^9}, {3.6295559181966705`*^9, 3.629555924737318*^9}, 
   3.629569379626644*^9, 3.629679034940374*^9, {3.6297433672639637`*^9, 
   3.6297433683477635`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAtmosphereSection2", "[", 
     RowBox[{
     "r0_", ",", "r1_", ",", "MPlanet_", ",", "sectionShells_", ",", "T0_", 
      ",", "T1_", ",", "\[Mu]0_", ",", "\[Mu]1_", ",", "P0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "radii", ",", "temps", ",", "mmw", ",", "pressures", ",", "nDens", ",",
         "dP", ",", "m\[Mu]", ",", "b\[Mu]", ",", "mT", ",", "bT", ",", "P", 
        ",", "r", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "initial", " ", 
        RowBox[{"(", 
         RowBox[{"or", " ", "complete"}], ")"}], " ", "values"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m\[Mu]", ",", "b\[Mu]"}], "}"}], "=", 
        RowBox[{"SlopeInterceptFrom2Pts", "[", 
         RowBox[{"r0", ",", "\[Mu]0", ",", "r1", ",", "\[Mu]1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mT", ",", "bT"}], "}"}], "=", 
        RowBox[{"SlopeInterceptFrom2Pts", "[", 
         RowBox[{"r0", ",", "T0", ",", "r1", ",", "T1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"radii", " ", "=", " ", 
        RowBox[{"SetAtmProperty", "[", 
         RowBox[{"r0", ",", "r1", ",", "sectionShells"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mmw", " ", "=", " ", 
        RowBox[{"SetAtmProperty", "[", 
         RowBox[{"\[Mu]0", ",", "\[Mu]1", ",", "sectionShells"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"temps", " ", "=", " ", 
        RowBox[{"SetAtmProperty", "[", 
         RowBox[{"T0", ",", "T1", ",", "sectionShells"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pressures", " ", "=", " ", 
        RowBox[{"{", "P0", "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"calculate", " ", "initial", " ", "pressures"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"nDens", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"P0", "/", 
          RowBox[{"(", 
           RowBox[{"k", " ", 
            RowBox[{"temps", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"calculate", " ", "initial", " ", "number", " ", "density"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dP", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nDens", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", 
          RowBox[{"mmw", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"calculate", " ", "initial", " ", 
         RowBox[{"dP", "/", "dr"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"pressures", ",", 
            RowBox[{"Re", "[", 
             RowBox[{"DSolveValue", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"P", "'"}], "[", "r", "]"}], "\[Equal]", " ", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"m\[Mu]", " ", "r"}], " ", "+", "b\[Mu]"}], ")"}],
                     "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mT", " ", "r"}], " ", "+", "bT"}], ")"}]}], 
                    ")"}]}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"P", "[", "r", "]"}], "/", "R"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"G", " ", "MPlanet"}], ")"}], "/", 
                    SuperscriptBox["r", "2"]}], ")"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"P", "[", "r0", "]"}], "\[Equal]", "P0"}]}], "}"}], 
               ",", 
               RowBox[{"P", "[", 
                RowBox[{"radii", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "r"}], "]"}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"nDens", ",", 
            RowBox[{
             RowBox[{"pressures", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"k", " ", 
               RowBox[{"temps", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dP", ",", 
            RowBox[{
             RowBox[{"nDens", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", 
             RowBox[{"mmw", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "radii", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "radii", ",", "temps", ",", "mmw", ",", "pressures", ",", "nDens"}], 
         "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "joins", " ", "several", " ", "atmosphere", " ", "sections", " ", 
    "consecutively", " ", 
    RowBox[{"(", 
     RowBox[{
     "no", " ", "additional", " ", "ordering", " ", "or", " ", "continuity", 
      " ", "assumptions"}], " "}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "takes", " ", "a", " ", "list", " ", "of", " ", "atmosphere", " ", 
    "sections", " ", 
    RowBox[{"(", 
     RowBox[{"list", " ", "of", " ", "lists"}], ")"}], " ", "as", " ", "an", 
    " ", "argument"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JoinAtmosphereSections", "[", "sections_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "radii", ",", "temps", ",", "mmw", ",", "pressures", ",", "nDens"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"radii", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"temps", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mmw", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pressures", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nDens", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"radii", "=", " ", 
           RowBox[{"Join", "[", 
            RowBox[{"radii", ",", 
             RowBox[{"sections", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"temps", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"temps", ",", 
             RowBox[{"sections", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mmw", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"mmw", ",", 
             RowBox[{"sections", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"pressures", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"pressures", ",", 
             RowBox[{"sections", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"nDens", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"nDens", ",", 
             RowBox[{"sections", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "5"}], "]"}], "]"}]}], "]"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "sections", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "radii", ",", "temps", ",", "mmw", ",", "pressures", ",", "nDens"}], 
         "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0", "=", "plutoRadius"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"1.25`64", "*", "plutoRadius"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r2", " ", "=", " ", 
   RowBox[{"1.5`64", "*", "plutoRadius"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MPlanet", "=", "MPluto"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sectionShells", "=", "100"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"T0", "=", "50"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"T1", "=", "100"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"T2", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M0", "=", "\[Mu]N2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"M1", "=", "\[Mu]N2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"M2", "=", "\[Mu]N2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nDens0", "=", 
   RowBox[{"10", "^", "21"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]0", "=", "\[Mu]N2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]1", "=", "\[Mu]N2"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.629476612940181*^9, 3.629476685091386*^9}, {
   3.6294767503707304`*^9, 3.629476917532195*^9}, {3.629477033152238*^9, 
   3.6294771690166464`*^9}, {3.62947724512265*^9, 3.629477412992496*^9}, {
   3.629478159719409*^9, 3.629478288637635*^9}, {3.6294783203821607`*^9, 
   3.6294783343430758`*^9}, {3.629478380537846*^9, 3.6294784350435305`*^9}, {
   3.6294786428990173`*^9, 3.6294787408975625`*^9}, {3.629478797233529*^9, 
   3.629478827594082*^9}, {3.629478909117929*^9, 3.6294789471188955`*^9}, {
   3.6294789951179547`*^9, 3.629478998395274*^9}, {3.6294793018117733`*^9, 
   3.629479444451988*^9}, {3.6294794988936205`*^9, 3.629479650802414*^9}, {
   3.6294798199394474`*^9, 3.629480079109361*^9}, {3.629480143325903*^9, 
   3.6294803571236134`*^9}, {3.629480407548399*^9, 3.629480466066948*^9}, {
   3.629480506549674*^9, 3.629480512750043*^9}, {3.629481563171548*^9, 
   3.6294817856874714`*^9}, {3.629481817003662*^9, 3.629481873201572*^9}, {
   3.6294819073898015`*^9, 3.629481909641428*^9}, {3.6294819740280933`*^9, 
   3.629481988486376*^9}, {3.6294821295094166`*^9, 3.6294821313327293`*^9}, {
   3.6294821936419244`*^9, 3.6294822255295515`*^9}, {3.629482374858514*^9, 
   3.629482436626342*^9}, 3.629482538043338*^9, {3.6294825682087193`*^9, 
   3.6294826455506015`*^9}, 3.62950910042303*^9, {3.629509131210882*^9, 
   3.629509279363208*^9}, {3.6295103314836063`*^9, 3.6295103938729696`*^9}, {
   3.6295104489441104`*^9, 3.6295105037780933`*^9}, 3.6295107590605035`*^9, {
   3.6295108046559277`*^9, 3.629510858853432*^9}, {3.629510899977888*^9, 
   3.62951093563321*^9}, {3.62951097245638*^9, 3.629510989148245*^9}, 
   3.6295114778736305`*^9, {3.629511989183014*^9, 3.629512003023838*^9}, {
   3.629512062148859*^9, 3.6295120641372795`*^9}, {3.629512102904827*^9, 
   3.6295121245602255`*^9}, {3.6295124599826117`*^9, 3.629512508177887*^9}, {
   3.629512598345953*^9, 3.629512599064463*^9}, {3.6295127763886447`*^9, 
   3.6295128047087717`*^9}, {3.6295128671031466`*^9, 3.629512932709766*^9}, {
   3.62955473974199*^9, 3.6295548215981674`*^9}, {3.6295549190674367`*^9, 
   3.6295549420507994`*^9}, {3.629555011193918*^9, 3.6295550338380065`*^9}, {
   3.629563667386554*^9, 3.6295636716165457`*^9}, {3.6295637355149603`*^9, 
   3.6295637633307295`*^9}, {3.6295638297529373`*^9, 
   3.6295638532536397`*^9}, {3.6295639098779144`*^9, 3.629563944292345*^9}, {
   3.6295639782334967`*^9, 3.62956399156094*^9}, {3.6295640336759014`*^9, 
   3.6295640338580017`*^9}, {3.629569383646502*^9, 3.629569391666201*^9}, {
   3.629570992232835*^9, 3.6295709927191825`*^9}, {3.629571683998494*^9, 
   3.629571749192852*^9}, {3.6295717925836697`*^9, 3.629571808672126*^9}, {
   3.629571894790321*^9, 3.629572135326268*^9}, {3.6295723777435637`*^9, 
   3.6295724294623213`*^9}, {3.6295728254567947`*^9, 3.629572991670905*^9}, {
   3.6295730730797596`*^9, 3.629573323246565*^9}, {3.6295733586056957`*^9, 
   3.629573374475977*^9}, {3.6295734811738234`*^9, 3.6295735123589983`*^9}, {
   3.6295735756929817`*^9, 3.6295736147607484`*^9}, {3.6295737393713193`*^9, 
   3.6295737479464083`*^9}, {3.6295738488941555`*^9, 
   3.6295738567497673`*^9}, {3.6295739457029605`*^9, 3.629573982874379*^9}, {
   3.629574025504221*^9, 3.6295740825447693`*^9}, {3.629574114059189*^9, 
   3.629574116568947*^9}, {3.6295742866128283`*^9, 3.6295743044875093`*^9}, {
   3.6295744081561832`*^9, 3.629574501242359*^9}, {3.6295745318601074`*^9, 
   3.6295745992259865`*^9}, {3.6295747257790036`*^9, 
   3.6295747868013735`*^9}, {3.6297418505655203`*^9, 
   3.6297418795080914`*^9}, {3.629741910839365*^9, 3.6297419213518324`*^9}, {
   3.629742226709877*^9, 3.629742270648088*^9}, {3.6297423112499447`*^9, 
   3.6297423555884867`*^9}, {3.6297424081808367`*^9, 3.629742470493123*^9}, 
   3.629742622566207*^9, {3.629742656045031*^9, 3.6297428573310785`*^9}, {
   3.629742941719039*^9, 3.62974295662265*^9}, {3.629743047419163*^9, 
   3.6297430489612875`*^9}, {3.629743231682124*^9, 3.6297432324756885`*^9}, {
   3.629743445755892*^9, 3.629743487404357*^9}, {3.6297438171567173`*^9, 
   3.629743883426837*^9}, {3.629744004547902*^9, 3.62974403580712*^9}, {
   3.6297441764861045`*^9, 3.629744218489962*^9}, {3.629744256039674*^9, 
   3.6297443339460416`*^9}, {3.629744616807054*^9, 3.6297446264339137`*^9}, {
   3.6297447043683043`*^9, 3.6297447090135965`*^9}, {3.629744970739622*^9, 
   3.629744978333*^9}, {3.629745170696742*^9, 3.6297451750638485`*^9}, {
   3.6297452780760374`*^9, 3.629745329667708*^9}, {3.629756205319253*^9, 
   3.6297562286578403`*^9}, {3.629756264588377*^9, 3.629756266986088*^9}, {
   3.629756297409705*^9, 3.629756321073531*^9}, {3.6297571067489567`*^9, 
   3.629757126843209*^9}, {3.6297573017405195`*^9, 3.6297573112252607`*^9}, {
   3.6297574910450616`*^9, 3.629757524518879*^9}, {3.629757829081312*^9, 
   3.629757915767951*^9}, {3.62975796747569*^9, 3.6297579927726817`*^9}, {
   3.629758059245903*^9, 3.6297580639642553`*^9}, {3.6297583887240887`*^9, 
   3.6297583971970906`*^9}, {3.6297601357913446`*^9, 3.629760146005604*^9}, {
   3.629760198529934*^9, 3.6297602318966503`*^9}, {3.6297603187183495`*^9, 
   3.629760330692867*^9}, {3.629772451577587*^9, 3.6297725060032864`*^9}, {
   3.6297725631389065`*^9, 3.6297725665102787`*^9}, {3.6297727308911123`*^9, 
   3.629772847114711*^9}, {3.6297728772781506`*^9, 3.6297728793306046`*^9}, 
   3.629772950233026*^9, {3.629773093964151*^9, 3.629773098801619*^9}, {
   3.6297731395090046`*^9, 3.629773139949304*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"P0", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m\[Mu]", ",", "b\[Mu]"}], "}"}], "=", 
   RowBox[{"SlopeInterceptFrom2Pts", "[", 
    RowBox[{"r0", ",", "\[Mu]0", ",", "r1", ",", "\[Mu]1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mT", ",", "bT"}], "}"}], "=", 
   RowBox[{"SlopeInterceptFrom2Pts", "[", 
    RowBox[{"r0", ",", "T0", ",", "r1", ",", "T1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radii", " ", "=", " ", 
   RowBox[{"SetAtmProperty", "[", 
    RowBox[{"r0", ",", "r1", ",", "sectionShells"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mmw", " ", "=", " ", 
   RowBox[{"SetAtmProperty", "[", 
    RowBox[{"\[Mu]0", ",", "\[Mu]1", ",", "sectionShells"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temps", " ", "=", " ", 
   RowBox[{"SetAtmProperty", "[", 
    RowBox[{"T0", ",", "T1", ",", "sectionShells"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pressures", " ", "=", " ", 
    RowBox[{"{", "P0", "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"calculate", " ", "initial", " ", "pressures"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"nDens", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"P0", "/", 
      RowBox[{"(", 
       RowBox[{"k", " ", 
        RowBox[{"temps", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"calculate", " ", "initial", " ", "number", " ", "density"}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"dP", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nDens", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", 
      RowBox[{"mmw", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"calculate", " ", "initial", " ", 
    RowBox[{"dP", "/", "dr"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"MakeAtmosphereSection2", "[", 
    RowBox[{
    "r0", ",", "r1", ",", "MPluto", ",", "sectionShells", ",", "T0", ",", 
     "T1", ",", "\[Mu]N2", ",", "\[Mu]N2", ",", "0.2"}], "]"}], "[", 
   RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.629744379388313*^9, 3.629744413080263*^9}, {
   3.629744542776445*^9, 3.629744543353854*^9}, {3.6297449378952627`*^9, 
   3.6297449389890437`*^9}, {3.629744988134982*^9, 3.6297450095762224`*^9}, 
   3.6297451847296996`*^9, {3.6297580179115477`*^9, 3.6297580403324547`*^9}, 
   3.629758548704799*^9, {3.6297602722773438`*^9, 3.629760304262076*^9}, {
   3.6297603573818293`*^9, 3.6297603884519424`*^9}, {3.629772611271116*^9, 
   3.629772614525428*^9}, 3.629772884424226*^9, {3.6297729729621496`*^9, 
   3.6297729946966023`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJwtjgs0FXYcx28p67CNGY3FlUeUyitdDN0v93rlch/ce7m3yL0Y5TSW5cwr
c5yQPCrdcpXJq82OHSOPDp04Qlkyh9TcTbPObGttLI0hNh2/3zn/8z+f/+f/
OednofhIFLuRwWDErJ3X9/rMstXlr+cemx6wXUudNdLQT7wFpr9xWxXb7hDr
w+2BZYbJZA+xIab+Ga1PGb5NbAxGZoyP8nAXsSmcCmLHr4lvEm8Hb2TihH1D
G7ElKsOKZJv5N4itMTIzzB91bya2gd5L89wb0U3EO2Hrs7NvObOR2A4DWz30
mKoG4j1IYgq/lzC+ILYHa6nGvqW5jtgRopeGVcW1NcRO6G18zox5cI3YGRNj
08/qdlUR78PRxq9/ZUVfJXZB73tfZeV3qYn3Y4Nc3yjr0GViFgY0zzckuKuI
XTFaOPxvAa+M2A3y+J6mv0vOE7vDYUjrz9jVUuIPEDFxIafMpoTYA/mGgTrG
F88Se0LO3MGw9D5D7AWD6rZRgXU+8QG8rXQZW3Y7TcxGyPCxq6ZpucSAVWNp
qsfTnHXOBiRlu7wjkz4j742M5W8KFs2yyXvjlIOBxcBIJnkf7OYVDZ27kk7e
B69+HFzgXvqUPAefq3wHI26lkufAIyUusUfnJHkuxIuykkfpKeS5mMz467Lk
rRPkfaFIULgGdyWT90VudLKj0ekk8n4QMOryVN8dJ+8H5/j2lZKeRPL+kOVp
+p01R8n7QzqYXrpkkkA+AJ3FT9o70j4kH4DHC23HC5diyQdCZ7VT81AVQz4Q
QrNTJu7BSvIH8WrGfbFom4L8QQRq+j5+8t8R8kEYZ4vl385GkQ/C5r5IK603
Isnz8E7QcmUy+xB5HoL68q7HXJKRD0aA3pBT3JsR5INhfjGlnHVFSj4EL9gb
cwa4EvIhqI2a83TdJCbPx5fSM/X3H4eS50M8nJY41y0iL4By3KLFrVO4zhBg
awlbL6BfQP8FUFeVqUZ6+OvcLcD1W7/8NP9uCPVC6MbVGc9k86gX4q7hFtmo
dhD1Qvib2Zg+rQmkXgimdt3P2ZIA6kXwDucfcDDzp16E9xWthsXzvtSLIJ26
axs+xaVehOl660dHfuBQHwr9JZnR+Wkf6kMxxfM8+2zVm/pQjL0o+iPdmrg7
FHYz5pEJElAfho4KFue+LZv6MChqctLjO7yoD8PigKDJ77An9WGQn6vkmBt5
UC9Gr8C3o2fSnXoxTk2ppw1uulEvRlRgn1S3xpV6MSZk7DutFSzq1xZRKpv3
Vu+nXgLG70znylYX6iU4luPWgof7qJdA3TY8J2cQM6SYT1zYxGE5Uy9FqTRL
GXbSiXop5ipsrBZvO1IvhZTXbldrQMwIR6b2zGq1xp76cKwwC7x0q/dSv+Zn
d9wrT91DfTgyTAqXP5Hvpj4CwStdg2M8O/b/oZu52w==
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 100.}, {0, 0.07829950534061045}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.6297728855330133`*^9, {3.62977295355836*^9, 3.6297729962587256`*^9}, 
   3.6297731502746253`*^9}]
}, Open  ]]
},
WindowSize->{1584, 817},
WindowMargins->{{-2, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9603, 257, 1072, "Input"],
Cell[10164, 279, 15527, 327, 1105, "Input"],
Cell[CellGroupData[{
Cell[25716, 610, 2910, 74, 232, "Input"],
Cell[28629, 686, 2403, 51, 238, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
