(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51653,       1192]
NotebookOptionsPosition[     51331,       1177]
NotebookOutlinePosition[     51707,       1193]
CellTagsIndexPosition[     51664,       1190]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"startTime", "=", 
    RowBox[{"SessionTime", "[", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"import", " ", "constants"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "TOL", ",", "NAvagadro", ",", "R", ",", "k", ",", "G", ",", "\[Alpha]N2",
       ",", "MN2", ",", "MPluto", ",", "rPluto", ",", "distToObserver"}], 
     "}"}], "=", 
    RowBox[{"ToExpression", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
       "\"\</Users/Hosea/Dropbox \
(MIT)//Academic/12.ThG/AtmosphereCode/constants.xlsx\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Data\>\"", ",", "1"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "local", " ", "gravity", " ", "as", " ", "a", " ", "function", " ", "of", 
    " ", "r"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Gravity", "[", 
     RowBox[{"r_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"G", "*", 
     RowBox[{"M", "/", 
      RowBox[{"r", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"barometric", " ", "formula"}], "-", 
    RowBox[{
    "pressure", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
     "height"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Barometric", "[", 
     RowBox[{
     "p0_", ",", "M_", ",", "h_", ",", "T_", ",", "r0_", ",", "MPlanet_"}], 
     "]"}], ":=", 
    RowBox[{"p0", " ", 
     RowBox[{"E", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "M"}], " ", 
          RowBox[{"Gravity", "[", 
           RowBox[{
            RowBox[{"h", "+", "r0"}], ",", "MPlanet"}], "]"}], " ", "h"}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"R", " ", "T"}], ")"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetAtmProperty", "[", 
     RowBox[{"startValue_", ",", "stopValue_", ",", "numShells_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"startValue", "\[Equal]", "stopValue"}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"no", " ", "variation"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"startValue", ",", "numShells"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"linear", " ", "variation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Range", "[", 
         RowBox[{"startValue", ",", "stopValue", ",", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"stopValue", "-", "startValue"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"numShells", "-", "1"}], ")"}]}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SlopeInterceptFrom2Pts", "[", 
     RowBox[{"x1_", ",", "y1_", ",", "x2_", ",", "y2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y1", "-", "y2"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"y1", "-", 
         RowBox[{"m", " ", "x1"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "b"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAtmosphereSection", "[", 
     RowBox[{
     "r0_", ",", "r1_", ",", "MPlanet_", ",", "sectionShells_", ",", "T0_", 
      ",", "T1_", ",", "M0_", ",", "M1_", ",", "P0_", ",", "\[Alpha]1_", ",", 
      "\[Alpha]2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "radii", ",", "temps", ",", "M", ",", "pressures", ",", "\[Rho]n", ",",
         "dP", ",", "mM", ",", "bM", ",", "mT", ",", "bT", ",", "P", ",", "r",
         ",", "i", ",", "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mM", ",", "bM"}], "}"}], "=", 
        RowBox[{"SlopeInterceptFrom2Pts", "[", 
         RowBox[{"r0", ",", "M0", ",", "r1", ",", "M1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mT", ",", "bT"}], "}"}], "=", 
        RowBox[{"SlopeInterceptFrom2Pts", "[", 
         RowBox[{"r0", ",", "T0", ",", "r1", ",", "T1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"radii", "=", 
        RowBox[{"SetAtmProperty", "[", 
         RowBox[{"r0", ",", "r1", ",", 
          RowBox[{"Round", "[", "sectionShells", "]"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "rounding", " ", "in", " ", "case", " ", "sectionShells", " ", "is", 
         " ", "not", " ", "passed", " ", "in", " ", "as", " ", "an", " ", 
         "integer"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"SetAtmProperty", "[", 
         RowBox[{"M0", ",", "M1", ",", 
          RowBox[{"Round", "[", "sectionShells", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temps", "=", 
        RowBox[{"SetAtmProperty", "[", 
         RowBox[{"T0", ",", "T1", ",", 
          RowBox[{"Round", "[", "sectionShells", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"SetAtmProperty", "[", 
         RowBox[{"\[Alpha]1", ",", "\[Alpha]2", ",", 
          RowBox[{"Round", "[", "sectionShells", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pressures", "=", 
        RowBox[{"{", "P0", "}"}]}], ";", 
       RowBox[{"\[Rho]n", "=", 
        RowBox[{"{", 
         FractionBox["P0", 
          RowBox[{"k", " ", 
           RowBox[{
           "temps", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]],
          "}"}]}], ";", 
       RowBox[{"dP", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Rho]n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          " ", 
          RowBox[{
          "M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "}"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"pressures", ",", 
            RowBox[{"Re", "[", 
             RowBox[{"DSolveValue", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["P", "\[Prime]",
                    MultilineFunction->None], "[", "r", "]"}], "\[Equal]", 
                  RowBox[{"-", 
                   FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mM", " ", "r"}], "+", "bM"}], ")"}], " ", 
                    RowBox[{"P", "[", "r", "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"G", " ", "MPlanet"}], ")"}]}], 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"mT", " ", "r"}], "+", "bT"}], ")"}], " ", "R", 
                    " ", 
                    SuperscriptBox["r", "2"]}]]}]}], ",", 
                 RowBox[{
                  RowBox[{"P", "[", "r0", "]"}], "\[Equal]", "P0"}]}], "}"}], 
               ",", 
               RowBox[{"P", "[", 
                RowBox[{
                "radii", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "]"}], ",", "r"}], "]"}], "]"}]}],
            "]"}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"\[Rho]n", ",", 
            FractionBox[
             RowBox[{
             "pressures", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], 
             RowBox[{"k", " ", 
              RowBox[{
              "temps", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]]}], "]"}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dP", ",", 
            RowBox[{
             RowBox[{
             "\[Rho]n", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], " ", 
             RowBox[{
             "M", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "radii", "]"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "radii", ",", "temps", ",", "M", ",", "pressures", ",", "\[Rho]n", 
          ",", "\[Alpha]"}], "}"}], "]"}], ";"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"JoinAtmosphereSections", "[", "sections_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "radii", ",", "temps", ",", "M", ",", "pressures", ",", "\[Rho]n", ",",
         "\[Alpha]"}], "}"}], ",", 
      RowBox[{
       RowBox[{"radii", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"temps", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"M", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"pressures", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"\[Rho]n", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"radii", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"radii", ",", 
             RowBox[{"sections", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
          ";", 
          RowBox[{"temps", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"temps", ",", 
             RowBox[{"sections", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
          ";", 
          RowBox[{"M", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"M", ",", 
             RowBox[{"sections", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
          ";", 
          RowBox[{"pressures", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"pressures", ",", 
             RowBox[{"sections", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
          ";", 
          RowBox[{"\[Rho]n", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Rho]n", ",", 
             RowBox[{"sections", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "5"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"\[Alpha]", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Alpha]", ",", 
             RowBox[{"sections", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "6"}], "]"}], "]"}]}], "]"}]}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "sections", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
         "radii", ",", "temps", ",", "M", ",", "pressures", ",", "\[Rho]n", 
          ",", "\[Alpha]"}], "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAtmosphere", "[", 
     RowBox[{
     "boundaryR_", ",", "boundaryT_", ",", "boundaryM_", ",", 
      "sectionShells_", ",", "P0_", ",", "boundary\[Alpha]_", ",", "MPlanet_",
       ",", 
      RowBox[{"exportFolderPath_:", "Null"}], ",", 
      RowBox[{"atmosphereNumber_:", "Null"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numSections", ",", "atmSections", ",", "section", ",", "PRef", ",", 
        "atmosphere", ",", "fullPath"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numSections", "=", 
        RowBox[{"Length", "[", "sectionShells", "]"}]}], ";", 
       RowBox[{"atmSections", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"PRef", "=", "P0"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "boundaryR", "]"}], "\[NotEqual]", 
           RowBox[{"numSections", "+", "1"}]}], "||", 
          RowBox[{
           RowBox[{"Length", "[", "boundaryT", "]"}], "\[NotEqual]", 
           RowBox[{"numSections", "+", "1"}]}], "||", 
          RowBox[{
           RowBox[{"Length", "[", "boundaryM", "]"}], "\[NotEqual]", 
           RowBox[{"numSections", "+", "1"}]}]}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<invalid number of arguments in MakeAtmosphere\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"section", "=", 
           RowBox[{"MakeAtmosphereSection", "[", 
            RowBox[{
             RowBox[{
             "boundaryR", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"boundaryR", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
             "MPlanet", ",", 
             RowBox[{
             "sectionShells", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "boundaryT", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"boundaryT", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "boundaryM", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"boundaryM", "\[LeftDoubleBracket]", 
              RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", "PRef",
              ",", 
             RowBox[{"boundary\[Alpha]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"boundary\[Alpha]", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
          RowBox[{"PRef", "=", 
           RowBox[{"Last", "[", 
            RowBox[{
            "section", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}],
             "]"}]}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"atmSections", ",", "section"}], "]"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "numSections"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"atmosphere", " ", "=", " ", 
        RowBox[{"JoinAtmosphereSections", "[", "atmSections", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"StringQ", "[", "exportFolderPath", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "atmosphereNumber", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fullPath", "=", 
              RowBox[{
              "exportFolderPath", "<>", "\"\</constructedAtmosphere\>\"", "<>", 
               RowBox[{"IntegerString", "[", "atmosphereNumber", "]"}], "<>", 
               "\"\<.tsv\>\""}]}], ";"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"fullPath", "=", 
              RowBox[{
              "exportFolderPath", "<>", "\"\</constructedAtmosphere\>\"", 
               "<>", "\"\<.tsv\>\""}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"fullPath", ",", 
            RowBox[{"atmosphere", "\[Transpose]"}], ",", "\"\<Table\>\""}], 
           "]"}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<exported atmosphere to \>\"", "<>", "fullPath"}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "atmosphere", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"same", " ", "as", " ", "version", " ", "above"}], ",", " ", 
    RowBox[{
    "but", " ", "allows", " ", "all", " ", "parameters", " ", "to", " ", "be",
      " ", "passed", " ", "in", " ", "via", " ", "a", " ", "single", " ", 
     "list", " ", 
     RowBox[{"(", 
      RowBox[{"of", " ", "lists", " ", "and", " ", "numbers"}], ")"}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "allows", " ", "for", " ", "easier", " ", "editing", " ", "of", " ", 
    "parameters", " ", "when", " ", "making", " ", "a", " ", "range", " ", 
    "of", " ", "atmospheres"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAtmosphere", "[", 
     RowBox[{"params_", ",", 
      RowBox[{"exportFolderPath_:", " ", "Null"}], ",", 
      RowBox[{"atmosphereNumber_:", " ", "Null"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Return", " ", 
        RowBox[{"MakeAtmosphere", "[", 
         RowBox[{
          RowBox[{"params", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"params", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"params", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"params", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"params", "[", 
           RowBox[{"[", "5", "]"}], "]"}], ",", 
          RowBox[{"params", "[", 
           RowBox[{"[", "6", "]"}], "]"}], ",", 
          RowBox[{"params", "[", 
           RowBox[{"[", "7", "]"}], "]"}], ",", "exportFolderPath", ",", 
          "atmosphereNumber"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", 
    RowBox[{
    "only", " ", "dealing", " ", "with", " ", "one", " ", "variable", " ", 
     RowBox[{"{", 
      RowBox[{
      "varNum", ",", "arrayPosition", ",", "min", ",", "max", ",", "step"}], 
      "}"}], " ", "right", " ", "now"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeAtmosphereGrid", "[", 
     RowBox[{
     "baseAtm_", ",", "exportFolderPath_", ",", "variableProperty_", ",", 
      RowBox[{"initNum_:", "1"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "atmNum", ",", "varRange", ",", "currentAtm", ",", "arrayPosition", 
        ",", "propertyNum", ",", "prop", ",", "error"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"error", " ", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "for", " ", "specification", " ", "problems"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "variableProperty", "]"}], "\[NotEqual]", 
           " ", "5"}], " ", "||", " ", 
          RowBox[{"!", 
           RowBox[{"StringQ", "[", 
            RowBox[{"variableProperty", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<variableProperty specification length or property error\>\"", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"error", " ", "=", " ", "True"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"error", ",", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"variableProperty", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[LessEqual]", " ", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "Print", "[", 
             "\"\<zero or negative value in variableProperty \
specification\>\"", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"error", "=", "True"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "variableProperty", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"error", ",", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"atmNum", "=", "initNum"}], ";", "\[IndentingNewLine]", 
       RowBox[{"varRange", " ", "=", " ", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"variableProperty", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"variableProperty", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"variableProperty", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"arrayPosition", "=", 
        RowBox[{"variableProperty", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"prop", "=", 
        RowBox[{"ToLowerCase", "[", 
         RowBox[{"variableProperty", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prop", "\[Equal]", " ", "\"\<r\>\""}], ",", 
         RowBox[{"propertyNum", "=", "1"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"TODO", " ", "-", " ", 
           RowBox[{
           "need", " ", "to", " ", "check", " ", "constraints", " ", "on", 
            " ", "r"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"prop", "\[Equal]", "\"\<t\>\""}], ",", 
         RowBox[{"propertyNum", "=", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"prop", "\[Equal]", "\"\<m\>\""}], ",", 
         RowBox[{"propertyNum", "=", "3"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"prop", "\[Equal]", "\"\<s\>\""}], "||", 
          RowBox[{"prop", "\[Equal]", " ", "\"\<shells\>\""}], "||", 
          RowBox[{"prop", "\[Equal]", "\"\<sectionshells\>\""}]}], ",", 
         RowBox[{"propertyNum", "=", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"prop", "\[Equal]", "\"\<p0\>\""}], ",", 
         RowBox[{"propertyNum", "=", "5"}], ",", "\[IndentingNewLine]", 
         RowBox[{"prop", "\[Equal]", "\"\<\[Alpha]\>\""}], ",", 
         RowBox[{"propertyNum", "=", "6"}], ",", "\[IndentingNewLine]", 
         RowBox[{"prop", "\[Equal]", "\"\<mplanet\>\""}], ",", 
         RowBox[{"propertyNum", "=", "7"}], ",", "\[IndentingNewLine]", 
         "True", ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<property request error\>\"", "]"}], ";", 
          RowBox[{"Return", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "constraints", " ", "on", " ", "radius"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"propertyNum", "\[Equal]", "1"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"if", " ", "the", " ", "variable", " ", 
           RowBox[{"we", "'"}], "re", " ", "trying", " ", "the", " ", 
           "change", " ", "is", " ", "the", " ", "radius"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"arrayPosition", "\[NotEqual]", " ", "1"}], "&&", 
                RowBox[{"arrayPosition", "\[NotEqual]", " ", 
                 RowBox[{"Length", "[", 
                  RowBox[{"baseAtm", "[", 
                   RowBox[{"[", "propertyNum", "]"}], "]"}], "]"}]}]}], ",", 
               " ", 
               RowBox[{"(*", " ", 
                RowBox[{"if", " ", 
                 RowBox[{"it", "'"}], "s", " ", "not", " ", "the", " ", 
                 "first", " ", "or", " ", "the", " ", "last", " ", "radius", 
                 " ", "boundary"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"varRange", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<", 
                    RowBox[{"baseAtm", "[", 
                    RowBox[{"[", 
                    RowBox[{"propertyNum", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], "||", 
                   RowBox[{
                    RowBox[{"varRange", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ">", 
                    RowBox[{"baseAtm", "[", 
                    RowBox[{"[", 
                    RowBox[{"propertyNum", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", "\"\<radius range specification error\>\"", 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"error", "=", "True"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"arrayPosition", "\[Equal]", " ", "1"}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{"bottommost", " ", "boundary"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"varRange", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ">", 
                   RowBox[{"baseAtm", "[", 
                    RowBox[{"[", 
                    RowBox[{"propertyNum", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", "\"\<radius range specification error\>\"", 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"error", "=", "True"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"arrayPosition", "\[Equal]", 
                RowBox[{"Length", "[", 
                 RowBox[{"baseAtm", "[", 
                  RowBox[{"[", "propertyNum", "]"}], "]"}], "]"}]}], ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{"topmost", " ", "boundary"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"varRange", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "<", 
                   RowBox[{"baseAtm", "[", 
                    RowBox[{"[", 
                    RowBox[{"propertyNum", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", "\"\<radius range specification error\>\"", 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"error", "=", "True"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "True", ",", " ", 
               RowBox[{"(*", " ", 
                RowBox[{"boundary", " ", "spec", " ", "error"}], " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<radius boundary specification error\>\"", 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"error", "=", "True"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "varRange", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"error", ",", 
         RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"make", " ", "the", " ", "atmospheres"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"currentAtm", "=", "baseAtm"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"currentAtm", "[", 
            RowBox[{"[", 
             RowBox[{"propertyNum", ",", "arrayPosition"}], "]"}], "]"}], "=", 
           RowBox[{"varRange", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"MakeAtmosphere", "[", 
           RowBox[{"currentAtm", ",", "exportFolderPath", ",", "atmNum"}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"atmNum", "=", 
           RowBox[{"atmNum", "+", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "varRange", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotAtmosphereProperties", "[", "atmosphere_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "TPlot", ",", "PPlot", ",", "MPlot", ",", "\[Rho]nPlot", ",", 
       "\[Alpha]Plot", ",", "atm"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"StringQ", "[", "atmosphere", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"atm", "=", 
          RowBox[{
           RowBox[{"Import", "[", "atmosphere", "]"}], "\[Transpose]"}]}], 
         ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"atm", "=", "atmosphere"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"TODO", " ", "-", " ", 
        RowBox[{
        "make", " ", "this", " ", "also", " ", "take", " ", "in", " ", "a", 
         " ", "file", " ", "and", " ", "plot", " ", "it", " ", "out"}]}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"TPlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<temperature (K)\>\""}], ",", 
         RowBox[{"Filling", "\[Rule]", " ", "Axis"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"atm", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "All"}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MPlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<M (kg/mol)\>\""}], ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"atm", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "All"}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"PPlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<pressure (Pa)\>\""}], ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"atm", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "All"}], "}"}]}]}], 
        "]"}]}], ";", 
      RowBox[{"\[Rho]nPlot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "atm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<number density\>\""}], ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"atm", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "All"}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]Plot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"atm", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             RowBox[{"atm", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"atm", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "2"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", "\"\<\[Alpha]\>\""}], ",", 
         RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"atm", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "All"}], "}"}]}]}], 
        "]"}]}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"GraphicsGrid", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"TPlot", ",", "MPlot"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"PPlot", ",", "\[Rho]nPlot"}], "}"}], ",", 
          RowBox[{"{", "\[Alpha]Plot", "}"}]}], "}"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6287236628334637`*^9, 3.628723667698938*^9}, {
   3.6287237853814445`*^9, 3.6287238229042997`*^9}, {3.6287238745009127`*^9, 
   3.6287238936985054`*^9}, {3.6287240220336*^9, 3.6287240561668205`*^9}, {
   3.6287242933481236`*^9, 3.6287242939205065`*^9}, {3.628724334689458*^9, 
   3.628724340788787*^9}, {3.6287244743455567`*^9, 3.6287245557362833`*^9}, {
   3.6287246169737425`*^9, 3.6287246354638643`*^9}, {3.6287247558182573`*^9, 
   3.6287247665238843`*^9}, {3.6287255613704*^9, 3.6287255829377193`*^9}, {
   3.6287257325398664`*^9, 3.6287258347864213`*^9}, {3.6287260179767466`*^9, 
   3.6287260233685656`*^9}, {3.62872694143425*^9, 3.628726959020729*^9}, {
   3.628727037335637*^9, 3.628727045220256*^9}, {3.6294742627265*^9, 
   3.6294743286402936`*^9}, {3.6294743755315437`*^9, 3.629474384663025*^9}, {
   3.629474439798169*^9, 3.6294745719704027`*^9}, {3.6294746127714353`*^9, 
   3.6294746983521347`*^9}, {3.6294750037938733`*^9, 
   3.6294750273766265`*^9}, {3.629475295476877*^9, 3.629475312597025*^9}, {
   3.629476497606343*^9, 3.6294765203614926`*^9}, 3.6294765725125246`*^9, 
   3.629476606028306*^9, {3.62947667911814*^9, 3.6294767382481008`*^9}, {
   3.62947754386133*^9, 3.6294775542136765`*^9}, {3.6294777647680717`*^9, 
   3.629477779885798*^9}, {3.6294785038773737`*^9, 3.62947851500527*^9}, {
   3.6294788890166597`*^9, 3.6294789014084563`*^9}, {3.629555582982427*^9, 
   3.6295556076619606`*^9}, {3.6295559181966705`*^9, 3.629555924737318*^9}, 
   3.629569379626644*^9, 3.629679034940374*^9, {3.6297433672639637`*^9, 
   3.6297433683477635`*^9}, {3.629816948037473*^9, 3.6298169538896627`*^9}, {
   3.629817965892914*^9, 3.6298179803751945`*^9}, {3.629818130553925*^9, 
   3.629818130562933*^9}, {3.629820049753005*^9, 3.6298200625520725`*^9}, 
   3.629832144639868*^9, 3.6298324476734223`*^9, {3.629832641830642*^9, 
   3.629832672343326*^9}, {3.6298327058711553`*^9, 3.6298327521871023`*^9}, {
   3.6298328525321655`*^9, 3.6298328628414936`*^9}, {3.6298328951674747`*^9, 
   3.6298329330604043`*^9}, {3.629833000801545*^9, 3.629833024127123*^9}, {
   3.6298330624433565`*^9, 3.6298330824045496`*^9}, {3.629833513383853*^9, 
   3.6298335147528396`*^9}, {3.62983862420035*^9, 3.6298386681185474`*^9}, {
   3.629838722918865*^9, 3.629838732683809*^9}, 3.629838766720998*^9, {
   3.629838893926406*^9, 3.6298389068686037`*^9}, 3.630068294011115*^9, {
   3.6300683581426945`*^9, 3.6300684338905277`*^9}, {3.6300684660223646`*^9, 
   3.6300686521266327`*^9}, 3.630080793958895*^9, {3.6300811074299126`*^9, 
   3.6300811399650393`*^9}, {3.6300812279956026`*^9, 
   3.6300812581380253`*^9}, {3.6300819565033965`*^9, 3.630081996482791*^9}, {
   3.6300820344367657`*^9, 3.6300821585169544`*^9}, {3.6300822582098103`*^9, 
   3.6300822903117847`*^9}, 3.6300823591667194`*^9, {3.63008240827162*^9, 
   3.6300824772886734`*^9}, {3.6300827049424925`*^9, 3.630082713542587*^9}, {
   3.630082817450553*^9, 3.6300828339091344`*^9}, {3.6300834446251993`*^9, 
   3.6300834461632843`*^9}, {3.6300835536536965`*^9, 
   3.6300835789216547`*^9}, {3.630083612594593*^9, 3.630083704549943*^9}, {
   3.6300845258826933`*^9, 3.630084583492646*^9}, {3.6300846761735353`*^9, 
   3.6300847925231996`*^9}, {3.6300848987236814`*^9, 3.630085001786481*^9}, {
   3.630085069114338*^9, 3.6300851721977873`*^9}, 3.6300852023232017`*^9, {
   3.6300852409586434`*^9, 3.630085245024545*^9}, {3.630085290310749*^9, 
   3.630085325433713*^9}, {3.6300855931039248`*^9, 3.630085636566823*^9}, {
   3.6300859410262175`*^9, 3.630085959424279*^9}, {3.6300860284793663`*^9, 
   3.630086054015509*^9}, {3.6300862885321875`*^9, 3.630086301932711*^9}, 
   3.6300868962010765`*^9, {3.6300869284950285`*^9, 3.6300869527722836`*^9}, {
   3.630087325866459*^9, 3.6300873310931873`*^9}, {3.630089110138276*^9, 
   3.6300892282021885`*^9}, {3.6300893073184357`*^9, 3.630089657379217*^9}, {
   3.6300897597839994`*^9, 3.630089853665039*^9}, {3.630089897298067*^9, 
   3.6300899661509933`*^9}, {3.630090154770049*^9, 3.630090336153966*^9}, {
   3.630090420890189*^9, 3.630090458638024*^9}, {3.6300907249552975`*^9, 
   3.630090738428874*^9}, {3.6300910509119854`*^9, 3.6300910617446833`*^9}, {
   3.6300911247274284`*^9, 3.6300911431044893`*^9}, {3.6300912407508907`*^9, 
   3.6300912627075*^9}, {3.630091299073341*^9, 3.6300913252459726`*^9}, {
   3.6300916062116346`*^9, 3.6300916080479455`*^9}, {3.6300916396824245`*^9, 
   3.6300916581985846`*^9}, {3.6300917671009846`*^9, 
   3.6300920837380295`*^9}, {3.6300921407285347`*^9, 3.630092600762503*^9}, {
   3.630092658842772*^9, 3.630092660597029*^9}, 3.630092760835273*^9, {
   3.6300928347908525`*^9, 3.6300928752425737`*^9}, {3.630092914534501*^9, 
   3.630092942233188*^9}, {3.6300929724866877`*^9, 3.6300929990155444`*^9}, {
   3.6300930316577725`*^9, 3.630093111193289*^9}, {3.6300931458909616`*^9, 
   3.630093167249113*^9}, {3.630093277850887*^9, 3.6300932971894655`*^9}, {
   3.630093389862544*^9, 3.630093409721659*^9}, {3.630093544353348*^9, 
   3.630093550181513*^9}, {3.630093693174118*^9, 3.630093693478333*^9}, {
   3.630093882611758*^9, 3.63009390334396*^9}, {3.6300942475461564`*^9, 
   3.6300942621515064`*^9}, {3.630094293991166*^9, 3.6300944538267407`*^9}, {
   3.6300945029787006`*^9, 3.6300945908761425`*^9}, {3.6300946263723793`*^9, 
   3.630094884285678*^9}, {3.6300949530045176`*^9, 3.630094960397773*^9}, {
   3.630095000024938*^9, 3.6300950018202276`*^9}, {3.630095109311612*^9, 
   3.6300951677801666`*^9}, {3.6300952437001543`*^9, 
   3.6300952481062565`*^9}, {3.630095710975232*^9, 3.630095738982139*^9}, {
   3.6300958164732113`*^9, 3.6300958179873066`*^9}, {3.6300958529901686`*^9, 
   3.6300958643562446`*^9}, {3.6300959179103065`*^9, 3.630096075709365*^9}, {
   3.6300966577946167`*^9, 3.6300968148282547`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r0", "=", "rPluto"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"r0", "+", 
    RowBox[{"(", 
     RowBox[{"200", "*", "1000"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{"r1", "+", 
    RowBox[{"(", 
     RowBox[{"300", "*", "1000"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"r3", "=", 
   RowBox[{"r2", "+", 
    RowBox[{"(", 
     RowBox[{"500", "*", "1000"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r4", "=", 
   RowBox[{"r3", "+", 
    RowBox[{"(", 
     RowBox[{"500", "*", "1000"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radii", "=", 
   RowBox[{"{", 
    RowBox[{"r0", ",", "r1", ",", "r2", ",", "r3", ",", "r4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MPlanet", "=", "MPluto"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sectionShells", "=", 
   RowBox[{"{", 
    RowBox[{"200", ",", "100", ",", "50", ",", "50"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundaryT", "=", 
   RowBox[{"{", 
    RowBox[{"60", ",", "50", ",", "65", ",", "30", ",", "30"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"boundaryM", "=", 
    RowBox[{"{", 
     RowBox[{"MN2", ",", "MN2", ",", "MN2", ",", "MN2", ",", "MN2"}], "}"}]}],
    ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"constant", " ", "composition"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"P0", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boundary\[Alpha]", "=", 
    RowBox[{"{", 
     RowBox[{"0.0000001", ",", "0.0000001", ",", "0", ",", "0", ",", "0"}], 
     "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "only", " ", "haze", " ", "at", " ", "the", " ", "bottom", " ", "layer"}],
     " ", "-", " ", 
    RowBox[{
    "TODO", " ", "using", " ", "arbitrary", " ", "number", " ", "for", " ", 
     "now"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "exportFolderPath", "=", 
    "\"\</Users/Hosea/Dropbox (MIT)//Academic/12.ThG/TestAtmospheres\>\""}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"atmosphere", "=", 
     RowBox[{"MakeAtmosphere", "[", 
      RowBox[{
      "radii", ",", "boundaryT", ",", "boundaryM", ",", "sectionShells", ",", 
       "P0", ",", "boundary\[Alpha]", ",", "MPluto", ",", "exportFolderPath", 
       ",", "1"}], "]"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "radii", ",", "boundaryT", ",", "boundaryM", ",", "sectionShells", ",", 
      "P0", ",", "boundary\[Alpha]", ",", "MPluto"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"atmosphere2", "=", 
     RowBox[{"MakeAtmosphere", "[", 
      RowBox[{"params", ",", "exportFolderPath", ",", "2"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MakeAtmosphereGrid", "[", 
  RowBox[{"params", ",", "exportFolderPath", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<r\>\"", ",", "1", ",", "50", ",", "100", ",", "20"}], "}"}], 
   ",", "5"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PlotAtmosphereProperties", "[", "atmosphere", "]"}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.629744379388313*^9, 3.629744413080263*^9}, {
   3.629744542776445*^9, 3.629744543353854*^9}, {3.6297449378952627`*^9, 
   3.6297449389890437`*^9}, {3.629744988134982*^9, 3.6297450095762224`*^9}, 
   3.6297451847296996`*^9, {3.6297580179115477`*^9, 3.6297580403324547`*^9}, 
   3.629758548704799*^9, {3.6297602722773438`*^9, 3.629760304262076*^9}, {
   3.6297603573818293`*^9, 3.6297603884519424`*^9}, {3.629772611271116*^9, 
   3.629772614525428*^9}, 3.629772884424226*^9, {3.6297729729621496`*^9, 
   3.6297729946966023`*^9}, {3.6298134832485423`*^9, 3.629813521421664*^9}, {
   3.629813588046009*^9, 3.6298137147880955`*^9}, {3.629813763959036*^9, 
   3.6298137994993095`*^9}, {3.6298138524509277`*^9, 3.629813863990137*^9}, {
   3.6298142411095066`*^9, 3.6298144456138678`*^9}, 3.6298145274560366`*^9, {
   3.6298145622817593`*^9, 3.629814578980627*^9}, {3.629814770011427*^9, 
   3.629814778661564*^9}, {3.6298148758095927`*^9, 3.6298150066356044`*^9}, {
   3.6298150904831686`*^9, 3.6298151157331204`*^9}, {3.6298153146164618`*^9, 
   3.62981535261246*^9}, {3.6298153961324043`*^9, 3.6298154242213545`*^9}, {
   3.6298155613328323`*^9, 3.6298155846233854`*^9}, {3.629816119989956*^9, 
   3.62981619007977*^9}, {3.629817398781832*^9, 3.62981739879184*^9}, {
   3.629818092278722*^9, 3.629818092314747*^9}, {3.62981815157987*^9, 
   3.6298181685219116`*^9}, {3.6298303757907033`*^9, 3.62983037819339*^9}, {
   3.629830443522812*^9, 3.629830444269343*^9}, {3.629830491815135*^9, 
   3.629830543444914*^9}, {3.629830588010505*^9, 3.6298306818622103`*^9}, {
   3.629830840108699*^9, 3.629830854759094*^9}, {3.6298318218104095`*^9, 
   3.6298318549569626`*^9}, {3.6298324784092846`*^9, 3.629832598198406*^9}, {
   3.6298333964137273`*^9, 3.629833484189133*^9}, 3.6298387667390103`*^9, {
   3.630068667180335*^9, 3.630068673042529*^9}, {3.6300687078832912`*^9, 
   3.630068715603755*^9}, {3.6300805782936726`*^9, 3.630080628409291*^9}, {
   3.63008069068155*^9, 3.6300806937197084`*^9}, {3.6300819489179864`*^9, 
   3.630081950748287*^9}, {3.630082167333227*^9, 3.6300821675904036`*^9}, {
   3.630082331411994*^9, 3.6300823322646*^9}, {3.6300824832319117`*^9, 
   3.630082486814443*^9}, {3.6300837335105495`*^9, 3.6300837364215956`*^9}, {
   3.630084016770866*^9, 3.63008401836098*^9}, {3.63008431918279*^9, 
   3.630084334712819*^9}, 3.630084507302491*^9, {3.630084810224798*^9, 
   3.630084810582036*^9}, {3.630085035040119*^9, 3.6300850477751665`*^9}, 
   3.63008525434616*^9, {3.6300896676685314`*^9, 3.6300897022370987`*^9}, {
   3.630090346988671*^9, 3.6300904087515693`*^9}, {3.6300904711834216`*^9, 
   3.6300904897751727`*^9}, {3.630090692339119*^9, 3.630090695629455*^9}, {
   3.6300926735452228`*^9, 3.6300926738174157`*^9}, {3.6300927164577265`*^9, 
   3.6300927193167553`*^9}, {3.6300928919094343`*^9, 3.630092892639939*^9}, {
   3.630092963561345*^9, 3.6300929651514826`*^9}, {3.6300931209421997`*^9, 
   3.630093122546342*^9}, {3.6300932129356127`*^9, 3.63009323530048*^9}, {
   3.630093440609642*^9, 3.6300934501634316`*^9}, {3.6300934917599955`*^9, 
   3.6300934979593735`*^9}, {3.6300937096908855`*^9, 
   3.6300937168499737`*^9}, {3.6300951918823256`*^9, 3.6300952315675306`*^9}, 
   3.630095902081088*^9, {3.630096083524921*^9, 3.6300960905029087`*^9}, {
   3.6300961722469783`*^9, 3.6300961730355425`*^9}}]
},
WindowSize->{1600, 817},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.2 Inherited,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 44090, 1007, 4435, "Input"],
Cell[44651, 1029, 6676, 146, 451, "Input"]
}
]
*)

(* End of internal cache information *)
